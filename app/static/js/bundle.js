/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={78:t=>{t.exports=[{inputs:[{internalType:"uint256",name:"universityID",type:"uint256"},{internalType:"uint256",name:"electionID",type:"uint256"},{internalType:"uint256",name:"candidateID",type:"uint256"},{internalType:"string",name:"name",type:"string"}],name:"addCandidate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"universityID",type:"uint256"}],name:"addUniversity",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"universityID",type:"uint256"},{internalType:"uint256",name:"electionID",type:"uint256"}],name:"createElection",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"universityID",type:"uint256"},{internalType:"uint256",name:"electionID",type:"uint256"}],name:"endVoting",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"universityID",type:"uint256"},{internalType:"uint256",name:"electionID",type:"uint256"}],name:"startVoting",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_registrationVerifier",type:"address"},{internalType:"address",name:"_votingVerifier",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"universityID",type:"uint256"},{indexed:!1,internalType:"uint256",name:"electionID",type:"uint256"},{indexed:!1,internalType:"uint256",name:"candidateID",type:"uint256"},{indexed:!1,internalType:"string",name:"name",type:"string"}],name:"CandidateAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"universityID",type:"uint256"},{indexed:!1,internalType:"uint256",name:"electionID",type:"uint256"}],name:"ElectionCreated",type:"event"},{inputs:[{internalType:"uint256",name:"universityID",type:"uint256"},{internalType:"uint256",name:"electionID",type:"uint256"},{internalType:"bytes32",name:"nullifierHash",type:"bytes32"},{internalType:"uint256[8]",name:"proof",type:"uint256[8]"}],name:"registerVoter",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"universityID",type:"uint256"}],name:"UniversityAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"universityID",type:"uint256"},{indexed:!1,internalType:"uint256",name:"electionID",type:"uint256"},{indexed:!1,internalType:"bytes32",name:"nullifierHash",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"candidateID",type:"uint256"}],name:"VoteCast",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"universityID",type:"uint256"},{indexed:!1,internalType:"uint256",name:"electionID",type:"uint256"},{indexed:!1,internalType:"bytes32",name:"nullifierHash",type:"bytes32"}],name:"VoterRegistered",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"universityID",type:"uint256"},{indexed:!1,internalType:"uint256",name:"electionID",type:"uint256"}],name:"VotingEnded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"universityID",type:"uint256"},{indexed:!1,internalType:"uint256",name:"electionID",type:"uint256"}],name:"VotingStarted",type:"event"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],name:"elections",outputs:[{internalType:"uint256",name:"universityID",type:"uint256"},{internalType:"uint256",name:"electionID",type:"uint256"},{internalType:"bool",name:"isVotingOpen",type:"bool"},{internalType:"uint256",name:"candidateCount",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"universityID",type:"uint256"},{internalType:"uint256",name:"electionID",type:"uint256"}],name:"getCandidates",outputs:[{components:[{internalType:"uint256",name:"candidateID",type:"uint256"},{internalType:"string",name:"name",type:"string"},{internalType:"uint256",name:"voteCount",type:"uint256"}],internalType:"struct VoterVerse.Candidate[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"universityID",type:"uint256"},{internalType:"uint256",name:"electionID",type:"uint256"},{internalType:"uint256",name:"candidateID",type:"uint256"}],name:"getCandidateVoteCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"registrationVerifier",outputs:[{internalType:"contract Groth16Verifier",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"universities",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"votingVerifier",outputs:[{internalType:"contract VotingVerifier",name:"",type:"address"}],stateMutability:"view",type:"function"}]}},e={};function n(i){var a=e[i];if(void 0!==a)return a.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};n.r(t);const e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function i(t,e){return e&&10!=e?16==e?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}const a=i;function o(t){const n=t.toString(16);return 4*(n.length-1)+e[parseInt(n[0],16)]}function r(t){return BigInt(t)<BigInt(0)}function s(t){return!t}function c(t,e){return BigInt(t)<<BigInt(e)}function l(t,e){return BigInt(t)>>BigInt(e)}const d=c,u=l;function g(t){return(BigInt(t)&BigInt(1))==BigInt(1)}function f(t){let e=BigInt(t);const n=[];for(;e;)e&BigInt(1)?n.push(1):n.push(0),e>>=BigInt(1);return n}function h(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(t)}function _(t,e){return BigInt(t)+BigInt(e)}function p(t,e){return BigInt(t)-BigInt(e)}function m(t){return-BigInt(t)}function L(t,e){return BigInt(t)*BigInt(e)}function y(t,e){return BigInt(t)**BigInt(e)}function A(t,e){return BigInt(t)/BigInt(e)}function b(t,e){return BigInt(t)%BigInt(e)}function I(t,e){return BigInt(t)==BigInt(e)}function w(t,e){return BigInt(t)>BigInt(e)}function C(t,e){return BigInt(t)>=BigInt(e)}function x(t,e){return BigInt(t)&BigInt(e)}function E(t,e,n,i){const a="0000000"+n.toString(16),o=new Uint32Array(t.buffer,t.byteOffset+e,i/4),r=1+(4*(a.length-7)-1>>5);for(let t=0;t<r;t++)o[t]=parseInt(a.substring(a.length-8*t-8,a.length-8*t),16);for(let t=r;t<o.length;t++)o[t]=0;for(let e=4*o.length;e<i;e++)t[e]=h(x(l(n,8*e),255))}function B(t,e,n,i){const a="0000000"+n.toString(16),o=new DataView(t.buffer,t.byteOffset+e,i),r=1+(4*(a.length-7)-1>>5);for(let t=0;t<r;t++)o.setUint32(i-4*t-4,parseInt(a.substring(a.length-8*t-8,a.length-8*t),16),!1);for(let t=0;t<i/4-r;t++)o[t]=0}function F(t,e,n){n=n||t.byteLength,e=e||0;const a=new Uint32Array(t.buffer,t.byteOffset+e,n/4),o=new Array(n/4);return a.forEach(((t,e)=>o[o.length-e-1]=t.toString(16).padStart(8,"0"))),i(o.join(""),16)}function v(t,e,n){n=n||t.byteLength,e=e||0;const a=new DataView(t.buffer,t.byteOffset+e,n),o=new Array(n/4);for(let t=0;t<n/4;t++)o[t]=a.getUint32(4*t,!1).toString(16).padStart(8,"0");return i(o.join(""),16)}function P(t,e){return t.toString(e)}function O(t){const e=new Uint8Array(Math.floor((o(t)-1)/8)+1);return E(e,0,t,e.byteLength),e}const S=a(0),U=a(1);var Q=Object.freeze({__proto__:null,abs:function(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)},add:_,band:x,bitLength:o,bits:f,bor:function(t,e){return BigInt(t)|BigInt(e)},bxor:function(t,e){return BigInt(t)^BigInt(e)},div:A,e:a,eq:I,exp:function(t,e){return BigInt(t)**BigInt(e)},fromArray:function(t,e){let n=BigInt(0);e=BigInt(e);for(let i=0;i<t.length;i++)n=n*e+BigInt(t[i]);return n},fromRprBE:v,fromRprLE:F,fromString:i,geq:C,gt:w,isNegative:r,isOdd:g,isZero:s,land:function(t,e){return BigInt(t)&&BigInt(e)},leq:function(t,e){return BigInt(t)<=BigInt(e)},lnot:function(t){return!BigInt(t)},lor:function(t,e){return BigInt(t)||BigInt(e)},lt:function(t,e){return BigInt(t)<BigInt(e)},mod:b,mul:L,naf:function(t){let e=BigInt(t);const n=[];for(;e;){if(e&BigInt(1)){const t=2-Number(e%BigInt(4));n.push(t),e-=BigInt(t)}else n.push(0);e>>=BigInt(1)}return n},neg:m,neq:function(t,e){return BigInt(t)!=BigInt(e)},one:U,pow:y,shiftLeft:c,shiftRight:l,shl:d,shr:u,square:function(t){return BigInt(t)*BigInt(t)},sub:p,toArray:function(t,e){const n=[];let i=BigInt(t);for(e=BigInt(e);i;)n.unshift(Number(i%e)),i/=e;return n},toLEBuff:O,toNumber:h,toRprBE:B,toRprLE:E,toString:P,zero:S});const k=[];for(let t=0;t<256;t++)k[t]=T(t,8);function T(t,e){let n=0,i=t;for(let t=0;t<e;t++)n<<=1,n|=1&i,i>>=1;return n}function N(t,e,n){if(s(n))return t.one;const i=f(n);if(0==i.length)return t.one;let a=e;for(let n=i.length-2;n>=0;n--)a=t.square(a),i[n]&&(a=t.mul(a,e));return a}function q(t,e,n,i,a){t[e]=t[e]+t[n]>>>0,t[a]=(t[a]^t[e])>>>0,t[a]=(t[a]<<16|t[a]>>>16&65535)>>>0,t[i]=t[i]+t[a]>>>0,t[n]=(t[n]^t[i])>>>0,t[n]=(t[n]<<12|t[n]>>>20&4095)>>>0,t[e]=t[e]+t[n]>>>0,t[a]=(t[a]^t[e])>>>0,t[a]=(t[a]<<8|t[a]>>>24&255)>>>0,t[i]=t[i]+t[a]>>>0,t[n]=(t[n]^t[i])>>>0,t[n]=(t[n]<<7|t[n]>>>25&127)>>>0}class M{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return _(L(this.nextU32(),4294967296),this.nextU32())}nextBool(){return!(1&~this.nextU32())}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let e=0;e<10;e++)q(t=this.buff,0,4,8,12),q(t,1,5,9,13),q(t,2,6,10,14),q(t,3,7,11,15),q(t,0,5,10,15),q(t,1,6,11,12),q(t,2,7,8,13),q(t,3,4,9,14);var t;for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12]&&(this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}}function D(t){let e=new Uint8Array(t);if(void 0!==globalThis.crypto)globalThis.crypto.getRandomValues(e);else for(let n=0;n<t;n++)e[n]=4294967296*Math.random()>>>0;return e}let R=null;function z(){return R||(R=new M(function(){const t=D(32),e=new Uint32Array(t.buffer),n=[];for(let t=0;t<8;t++)n.push(e[t]);return n}()),R)}class G{constructor(t,e,n){this.F=e,this.G=t,this.opMulGF=n;let i=e.sqrt_t||e.t,a=e.sqrt_s||e.s,o=e.one;for(;e.eq(e.pow(o,e.half),e.one);)o=e.add(o,e.one);this.w=new Array(a+1),this.wi=new Array(a+1),this.w[a]=this.F.pow(o,i),this.wi[a]=this.F.inv(this.w[a]);let r=a-1;for(;r>=0;)this.w[r]=this.F.square(this.w[r+1]),this.wi[r]=this.F.square(this.wi[r+1]),r--;this.roots=[],this._setRoots(Math.min(a,15))}_setRoots(t){for(let e=t;e>=0&&!this.roots[e];e--){let t=this.F.one;const n=1<<e,i=new Array(n);for(let a=0;a<n;a++)i[a]=t,t=this.F.mul(t,this.w[e]);this.roots[e]=i}}fft(t){if(t.length<=1)return t;const e=j(t.length-1)+1;this._setRoots(e);const n=1<<e;if(t.length!=n)throw new Error("Size must be multiple of 2");return V(this,t,e,0,1)}ifft(t){if(t.length<=1)return t;const e=j(t.length-1)+1;this._setRoots(e);const n=1<<e;if(t.length!=n)throw new Error("Size must be multiple of 2");const i=V(this,t,e,0,1),a=this.F.inv(this.F.mulScalar(this.F.one,n)),o=new Array(n);for(let t=0;t<n;t++)o[t]=this.opMulGF(i[(n-t)%n],a);return o}}function j(t){return(4294901760&t?(t&=4294901760,16):0)|(4278255360&t?(t&=4278255360,8):0)|(4042322160&t?(t&=4042322160,4):0)|(3435973836&t?(t&=3435973836,2):0)|!!(2863311530&t)}function V(t,e,n,i,a){const o=1<<n;if(1==o)return[e[i]];if(2==o)return[t.G.add(e[i],e[i+a]),t.G.sub(e[i],e[i+a])];const r=o>>1,s=V(t,e,n-1,i,2*a),c=V(t,e,n-1,i+a,2*a),l=new Array(o);for(let e=0;e<r;e++)l[e]=t.G.add(s[e],t.opMulGF(c[e],t.roots[n][e])),l[e+r]=t.G.sub(s[e],t.opMulGF(c[e],t.roots[n][e]));return l}class K{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=o(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);const e=this.negone>>this.one;this.nqr=this.two;let n=this.pow(this.nqr,e);for(;!this.eq(n,this.negone);)this.nqr=this.nqr+this.one,n=this.pow(this.nqr,e);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),function(t){if(t.m%2==1)if(I(b(t.p,4),1))if(I(b(t.p,8),1))if(I(b(t.p,16),1))!function(t){for(t.sqrt_q=y(t.p,t.m),t.sqrt_s=0,t.sqrt_t=p(t.sqrt_q,1);!g(t.sqrt_t);)t.sqrt_s=t.sqrt_s+1,t.sqrt_t=A(t.sqrt_t,2);let e=t.one;for(;t.eq(e,t.one);){const n=t.random();t.sqrt_z=t.pow(n,t.sqrt_t),e=t.pow(t.sqrt_z,2**(t.sqrt_s-1))}t.sqrt_tm1d2=A(p(t.sqrt_t,1),2),t.sqrt=function(t){const e=this;if(e.isZero(t))return e.zero;let n=e.pow(t,e.sqrt_tm1d2);const i=e.pow(e.mul(e.square(n),t),2**(e.sqrt_s-1));if(e.eq(i,e.negone))return null;let a=e.sqrt_s,o=e.mul(t,n),r=e.mul(o,n),s=e.sqrt_z;for(;!e.eq(r,e.one);){let t=e.square(r),i=1;for(;!e.eq(t,e.one);)t=e.square(t),i++;n=s;for(let t=0;t<a-i-1;t++)n=e.square(n);s=e.square(n),r=e.mul(r,s),o=e.mul(o,n),a=i}return e.geq(o,e.zero)?o:e.neg(o)}}(t);else{if(!I(b(t.p,16),9))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}(t)}else{if(!I(b(t.p,8),5))throw new Error("Field withot sqrt");!function(t){t.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}(t)}else I(b(t.p,4),3)&&function(t){t.sqrt_q=y(t.p,t.m),t.sqrt_e1=A(p(t.sqrt_q,3),4),t.sqrt=function(e){if(this.isZero(e))return this.zero;const n=this.pow(e,this.sqrt_e1),i=this.mul(this.square(n),e);if(this.eq(i,this.negone))return null;const a=this.mul(n,e);return t.geq(a,t.zero)?a:t.neg(a)}}(t);else{const e=b(y(t.p,t.m/2),4);1==e?function(t){t.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}(t):3==e?function(t){t.sqrt_q=y(t.p,t.m/2),t.sqrt_e34=A(p(t.sqrt_q,3),4),t.sqrt_e12=A(p(t.sqrt_q,1),2),t.frobenius=function(e,n){return e%2==1?t.conjugate(n):n},t.sqrt=function(t){const e=this,n=e.pow(t,e.sqrt_e34),i=e.mul(e.square(n),t),a=e.mul(e.frobenius(1,i),i);if(e.eq(a,e.negone))return null;const o=e.mul(n,t);let r;if(e.eq(i,e.negone))r=e.mul(o,[e.F.zero,e.F.one]);else{const t=e.pow(e.add(e.one,i),e.sqrt_e12);r=e.mul(t,o)}return e.geq(r,e.zero)?r:e.neg(r)}}(t):function(t){t.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}(t)}}(this),this.FFT=new G(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,e){let n;if(e?16==e&&(n=BigInt("0x"+t)):n=BigInt(t),n<0){let t=-n;return t>=this.p&&(t%=this.p),this.p-t}return n>=this.p?n%this.p:n}add(t,e){const n=t+e;return n>=this.p?n-this.p:n}sub(t,e){return t>=e?t-e:this.p-e+t}neg(t){return t?this.p-t:t}mul(t,e){return t*e%this.p}mulScalar(t,e){return t*this.e(e)%this.p}square(t){return t*t%this.p}eq(t,e){return t==e}neq(t,e){return t!=e}lt(t,e){return(t>this.half?t-this.p:t)<(e>this.half?e-this.p:e)}gt(t,e){return(t>this.half?t-this.p:t)>(e>this.half?e-this.p:e)}leq(t,e){return(t>this.half?t-this.p:t)<=(e>this.half?e-this.p:e)}geq(t,e){return(t>this.half?t-this.p:t)>=(e>this.half?e-this.p:e)}div(t,e){return this.mul(t,this.inv(e))}idiv(t,e){if(!e)throw new Error("Division by zero");return t/e}inv(t){if(!t)throw new Error("Division by zero");let e=this.zero,n=this.p,i=this.one,a=t%this.p;for(;a;){let t=n/a;[e,i]=[i,e-t*i],[n,a]=[a,n-t*a]}return e<this.zero&&(e+=this.p),e}mod(t,e){return t%e}pow(t,e){return N(this,t,e)}exp(t,e){return N(this,t,e)}band(t,e){const n=t&e&this.mask;return n>=this.p?n-this.p:n}bor(t,e){const n=(t|e)&this.mask;return n>=this.p?n-this.p:n}bxor(t,e){const n=(t^e)&this.mask;return n>=this.p?n-this.p:n}bnot(t){const e=t^this.mask;return e>=this.p?e-this.p:e}shl(t,e){if(Number(e)<this.bitLength){const n=t<<e&this.mask;return n>=this.p?n-this.p:n}{const n=this.p-e;return Number(n)<this.bitLength?t>>n:this.zero}}shr(t,e){if(Number(e)<this.bitLength)return t>>e;{const n=this.p-e;if(Number(n)<this.bitLength){const e=t<<n&this.mask;return e>=this.p?e-this.p:e}return 0}}land(t,e){return t&&e?this.one:this.zero}lor(t,e){return t||e?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let e=this.s,n=this.nqr_to_t,i=this.pow(t,this.t),a=this.pow(t,this.add(this.t,this.one)>>this.one);for(;i!=this.one;){let t=this.square(i),o=1;for(;t!=this.one;)o++,t=this.square(t);let r=n;for(let t=0;t<e-o-1;t++)r=this.square(r);e=o,n=this.square(r),i=this.mul(i,n),a=this.mul(a,r)}return a>this.p>>this.one&&(a=this.neg(a)),a}normalize(t,e){if((t=BigInt(t,e))<0){let e=-t;return e>=this.p&&(e%=this.p),this.p-e}return t>=this.p?t%this.p:t}random(){const t=2*this.bitLength/8;let e=this.zero;for(let n=0;n<t;n++)e=(e<<BigInt(8))+BigInt(D(1)[0]);return e%this.p}toString(t,e){let n;return e=e||10,n=t>this.half&&10==e?"-"+(this.p-t).toString(e):t.toString(e),n}isZero(t){return t==this.zero}fromRng(t){let e;do{e=this.zero;for(let n=0;n<this.n64;n++)e+=t.nextU64()<<BigInt(64*n);e&=this.mask}while(e>=this.p);return e=e*this.Ri%this.p,e}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,e,n){E(t,e,n,8*this.n64)}toRprBE(t,e,n){B(t,e,n,8*this.n64)}toRprBEM(t,e,n){return this.toRprBE(t,e,this.mul(this.R,n))}toRprLEM(t,e,n){return this.toRprLE(t,e,this.mul(this.R,n))}fromRprLE(t,e){return F(t,e,this.n8)}fromRprBE(t,e){return v(t,e,this.n8)}fromRprLEM(t,e){return this.mul(this.fromRprLE(t,e),this.Ri)}fromRprBEM(t,e){return this.mul(this.fromRprBE(t,e),this.Ri)}toObject(t){return t}}var H={bigInt2BytesLE:function(t,e){const n=Array(e);let i=BigInt(t);for(let t=0;t<e;t++)n[t]=Number(0xFFn&i),i>>=8n;return n},bigInt2U32LE:function(t,e){const n=Array(e);let i=BigInt(t);for(let t=0;t<e;t++)n[t]=Number(0xFFFFFFFFn&i),i>>=32n;return n},isOcamNum:function(t){return!!Array.isArray(t)&&3==t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&!!Array.isArray(t[2])}},$=function(t,e,n,i,a,o,r){const s=t.addFunction(e);s.addParam("base","i32"),s.addParam("scalar","i32"),s.addParam("scalarLength","i32"),s.addParam("r","i32"),s.addLocal("i","i32"),s.addLocal("b","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(n));s.addCode(c.if(c.i32_eqz(c.getLocal("scalarLength")),[...c.call(r,c.getLocal("r")),...c.ret([])])),s.addCode(c.call(o,c.getLocal("base"),l)),s.addCode(c.call(r,c.getLocal("r"))),s.addCode(c.setLocal("i",c.getLocal("scalarLength"))),s.addCode(c.block(c.loop(c.setLocal("i",c.i32_sub(c.getLocal("i"),c.i32_const(1))),c.setLocal("b",c.i32_load8_u(c.i32_add(c.getLocal("scalar"),c.getLocal("i")))),...function(){const t=[];for(let e=0;e<8;e++)t.push(...c.call(a,c.getLocal("r"),c.getLocal("r")),...c.if(c.i32_ge_u(c.getLocal("b"),c.i32_const(128>>e)),[...c.setLocal("b",c.i32_sub(c.getLocal("b"),c.i32_const(128>>e))),...c.call(i,c.getLocal("r"),l,c.getLocal("r"))]));return t}(),c.br_if(1,c.i32_eqz(c.getLocal("i"))),c.br(0))))},Y=function(t,e){const n=8*t.modules[e].n64,i=t.addFunction(e+"_batchInverse");i.addParam("pIn","i32"),i.addParam("inStep","i32"),i.addParam("n","i32"),i.addParam("pOut","i32"),i.addParam("outStep","i32"),i.addLocal("itAux","i32"),i.addLocal("itIn","i32"),i.addLocal("itOut","i32"),i.addLocal("i","i32");const a=i.getCodeBuilder(),o=a.i32_const(t.alloc(n));i.addCode(a.setLocal("itAux",a.i32_load(a.i32_const(0))),a.i32_store(a.i32_const(0),a.i32_add(a.getLocal("itAux"),a.i32_mul(a.i32_add(a.getLocal("n"),a.i32_const(1)),a.i32_const(n))))),i.addCode(a.call(e+"_one",a.getLocal("itAux")),a.setLocal("itIn",a.getLocal("pIn")),a.setLocal("itAux",a.i32_add(a.getLocal("itAux"),a.i32_const(n))),a.setLocal("i",a.i32_const(0)),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("i"),a.getLocal("n"))),a.if(a.call(e+"_isZero",a.getLocal("itIn")),a.call(e+"_copy",a.i32_sub(a.getLocal("itAux"),a.i32_const(n)),a.getLocal("itAux")),a.call(e+"_mul",a.getLocal("itIn"),a.i32_sub(a.getLocal("itAux"),a.i32_const(n)),a.getLocal("itAux"))),a.setLocal("itIn",a.i32_add(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itAux",a.i32_add(a.getLocal("itAux"),a.i32_const(n))),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(1))),a.br(0))),a.setLocal("itIn",a.i32_sub(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itAux",a.i32_sub(a.getLocal("itAux"),a.i32_const(n))),a.setLocal("itOut",a.i32_add(a.getLocal("pOut"),a.i32_mul(a.i32_sub(a.getLocal("n"),a.i32_const(1)),a.getLocal("outStep")))),a.call(e+"_inverse",a.getLocal("itAux"),a.getLocal("itAux")),a.block(a.loop(a.br_if(1,a.i32_eqz(a.getLocal("i"))),a.if(a.call(e+"_isZero",a.getLocal("itIn")),[...a.call(e+"_copy",a.getLocal("itAux"),a.i32_sub(a.getLocal("itAux"),a.i32_const(n))),...a.call(e+"_zero",a.getLocal("itOut"))],[...a.call(e+"_copy",a.i32_sub(a.getLocal("itAux"),a.i32_const(n)),o),...a.call(e+"_mul",a.getLocal("itAux"),a.getLocal("itIn"),a.i32_sub(a.getLocal("itAux"),a.i32_const(n))),...a.call(e+"_mul",a.getLocal("itAux"),o,a.getLocal("itOut"))]),a.setLocal("itIn",a.i32_sub(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itOut",a.i32_sub(a.getLocal("itOut"),a.getLocal("outStep"))),a.setLocal("itAux",a.i32_sub(a.getLocal("itAux"),a.i32_const(n))),a.setLocal("i",a.i32_sub(a.getLocal("i"),a.i32_const(1))),a.br(0)))),i.addCode(a.i32_store(a.i32_const(0),a.getLocal("itAux")))},J=function(t,e,n,i,a,o){void 0===o&&(o=i<a);const r=t.addFunction(e);r.addParam("pIn","i32"),r.addParam("n","i32"),r.addParam("pOut","i32"),r.addLocal("i","i32"),r.addLocal("itIn","i32"),r.addLocal("itOut","i32");const s=r.getCodeBuilder();o?r.addCode(s.setLocal("itIn",s.i32_add(s.getLocal("pIn"),s.i32_mul(s.i32_sub(s.getLocal("n"),s.i32_const(1)),s.i32_const(i)))),s.setLocal("itOut",s.i32_add(s.getLocal("pOut"),s.i32_mul(s.i32_sub(s.getLocal("n"),s.i32_const(1)),s.i32_const(a)))),s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(n,s.getLocal("itIn"),s.getLocal("itOut")),s.setLocal("itIn",s.i32_sub(s.getLocal("itIn"),s.i32_const(i))),s.setLocal("itOut",s.i32_sub(s.getLocal("itOut"),s.i32_const(a))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0)))):r.addCode(s.setLocal("itIn",s.getLocal("pIn")),s.setLocal("itOut",s.getLocal("pOut")),s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(n,s.getLocal("itIn"),s.getLocal("itOut")),s.setLocal("itIn",s.i32_add(s.getLocal("itIn"),s.i32_const(i))),s.setLocal("itOut",s.i32_add(s.getLocal("itOut"),s.i32_const(a))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))))},W={};function Z(t,e){return t===e?0:t>e?1:-1}function X(t){return t*t}function tt(t){return t%2n!==0n}function et(t){return t%2n===0n}function nt(t){return t<0n}function it(t){return t>0n}function at(t){return nt(t)?t.toString(2).length-1:t.toString(2).length}function ot(t){return t<0n?-t:t}function rt(t){return 1n===ot(t)}function st(t,e){for(var n,i,a,o=0n,r=1n,s=e,c=ot(t);0n!==c;)n=s/c,i=o,a=s,o=r,s=c,r=i-n*r,c=a-n*c;if(!rt(s))throw new Error(t.toString()+" and "+e.toString()+" are not co-prime");return-1===Z(o,0n)&&(o+=e),nt(t)?-o:o}function ct(t,e,n){if(0n===n)throw new Error("Cannot take modPow with modulus 0");var i=1n,a=t%n;for(nt(e)&&(e*=-1n,a=st(a,n));it(e);){if(0n===a)return 0n;tt(e)&&(i=i*a%n),e/=2n,a=X(a)%n}return i}function lt(t,e){return 0n!==e&&(!!rt(e)||(0===function(t,e){return(t=t>=0n?t:-t)===(e=e>=0n?e:-e)?0:t>e?1:-1}(e,2n)?et(t):t%e===0n))}function dt(t,e){for(var n,i,a,o=function(t){return t-1n}(t),r=o,s=0;et(r);)r/=2n,s++;t:for(i=0;i<e.length;i++)if(!(t<e[i]||rt(a=ct(BigInt(e[i]),r,t))||a===o)){for(n=s-1;0!=n;n--){if(rt(a=X(a)%t))return!1;if(a===o)continue t}return!1}return!0}W.bitLength=at,W.isOdd=tt,W.isNegative=nt,W.abs=ot,W.isUnit=rt,W.compare=Z,W.modInv=st,W.modPow=ct,W.isPrime=function(t){var e=function(t){var e=ot(t);return!rt(e)&&(2n===e||3n===e||5n===e||!(et(e)||lt(e,3n)||lt(e,5n))&&(e<49n||void 0))}(t);if(void 0!==e)return e;var n=ot(t),i=at(n);if(i<=64)return dt(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var a=Math.log(2)*Number(i),o=Math.ceil(a),r=[],s=0;s<o;s++)r.push(BigInt(s+2));return dt(n,r)},W.square=X;const ut=H,gt=$,ft=Y,ht=J,_t=function(t,e,n,i,a,o){void 0===o&&(o=i<a);const r=t.addFunction(e);r.addParam("pIn1","i32"),r.addParam("pIn2","i32"),r.addParam("n","i32"),r.addParam("pOut","i32"),r.addLocal("i","i32"),r.addLocal("itIn1","i32"),r.addLocal("itIn2","i32"),r.addLocal("itOut","i32");const s=r.getCodeBuilder();o?r.addCode(s.setLocal("itIn1",s.i32_add(s.getLocal("pIn1"),s.i32_mul(s.i32_sub(s.getLocal("n"),s.i32_const(1)),s.i32_const(i)))),s.setLocal("itIn2",s.i32_add(s.getLocal("pIn2"),s.i32_mul(s.i32_sub(s.getLocal("n"),s.i32_const(1)),s.i32_const(i)))),s.setLocal("itOut",s.i32_add(s.getLocal("pOut"),s.i32_mul(s.i32_sub(s.getLocal("n"),s.i32_const(1)),s.i32_const(a)))),s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(n,s.getLocal("itIn1"),s.getLocal("itIn2"),s.getLocal("itOut")),s.setLocal("itIn1",s.i32_sub(s.getLocal("itIn1"),s.i32_const(i))),s.setLocal("itIn2",s.i32_sub(s.getLocal("itIn2"),s.i32_const(i))),s.setLocal("itOut",s.i32_sub(s.getLocal("itOut"),s.i32_const(a))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0)))):r.addCode(s.setLocal("itIn1",s.getLocal("pIn1")),s.setLocal("itIn2",s.getLocal("pIn2")),s.setLocal("itOut",s.getLocal("pOut")),s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(n,s.getLocal("itIn1"),s.getLocal("itIn2"),s.getLocal("itOut")),s.setLocal("itIn1",s.i32_add(s.getLocal("itIn1"),s.i32_const(i))),s.setLocal("itIn2",s.i32_add(s.getLocal("itIn2"),s.i32_const(i))),s.setLocal("itOut",s.i32_add(s.getLocal("itOut"),s.i32_const(a))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))))},{bitLength:pt,modInv:mt,modPow:Lt,isPrime:yt,isOdd:At,square:bt}=W;var It=function(t,e,n,i){const a=BigInt(e),o=Math.floor((pt(a-1n)-1)/64)+1,r=2*o,s=8*o,c=n||"f1m";if(t.modules[c])return c;const l=function(t,e,n){const i=n||"int";if(t.modules[i])return i;t.modules[i]={};const a=2*e,o=8*e;return function(){const n=t.addFunction(i+"_copy");n.addParam("px","i32"),n.addParam("pr","i32");const a=n.getCodeBuilder();for(let t=0;t<e;t++)n.addCode(a.i64_store(a.getLocal("pr"),8*t,a.i64_load(a.getLocal("px"),8*t)))}(),function(){const n=t.addFunction(i+"_zero");n.addParam("pr","i32");const a=n.getCodeBuilder();for(let t=0;t<e;t++)n.addCode(a.i64_store(a.getLocal("pr"),8*t,a.i64_const(0)))}(),function(){const n=t.addFunction(i+"_isZero");n.addParam("px","i32"),n.setReturnType("i32");const a=n.getCodeBuilder();n.addCode(function t(e){return 0==e?a.ret(a.i64_eqz(a.i64_load(a.getLocal("px")))):a.if(a.i64_eqz(a.i64_load(a.getLocal("px"),8*e)),t(e-1),a.ret(a.i32_const(0)))}(e-1)),n.addCode(a.ret(a.i32_const(0)))}(),function(){const n=t.addFunction(i+"_one");n.addParam("pr","i32");const a=n.getCodeBuilder();n.addCode(a.i64_store(a.getLocal("pr"),0,a.i64_const(1)));for(let t=1;t<e;t++)n.addCode(a.i64_store(a.getLocal("pr"),8*t,a.i64_const(0)))}(),function(){const n=t.addFunction(i+"_eq");n.addParam("px","i32"),n.addParam("py","i32"),n.setReturnType("i32");const a=n.getCodeBuilder();n.addCode(function t(e){return 0==e?a.ret(a.i64_eq(a.i64_load(a.getLocal("px")),a.i64_load(a.getLocal("py")))):a.if(a.i64_eq(a.i64_load(a.getLocal("px"),8*e),a.i64_load(a.getLocal("py"),8*e)),t(e-1),a.ret(a.i32_const(0)))}(e-1)),n.addCode(a.ret(a.i32_const(0)))}(),function(){const n=t.addFunction(i+"_gte");n.addParam("px","i32"),n.addParam("py","i32"),n.setReturnType("i32");const a=n.getCodeBuilder();n.addCode(function t(e){return 0==e?a.ret(a.i64_ge_u(a.i64_load(a.getLocal("px")),a.i64_load(a.getLocal("py")))):a.if(a.i64_lt_u(a.i64_load(a.getLocal("px"),8*e),a.i64_load(a.getLocal("py"),8*e)),a.ret(a.i32_const(0)),a.if(a.i64_gt_u(a.i64_load(a.getLocal("px"),8*e),a.i64_load(a.getLocal("py"),8*e)),a.ret(a.i32_const(1)),t(e-1)))}(e-1)),n.addCode(a.ret(a.i32_const(0)))}(),function(){const e=t.addFunction(i+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.setReturnType("i32"),e.addLocal("c","i64");const n=e.getCodeBuilder();e.addCode(n.setLocal("c",n.i64_add(n.i64_load32_u(n.getLocal("x")),n.i64_load32_u(n.getLocal("y"))))),e.addCode(n.i64_store32(n.getLocal("r"),n.getLocal("c")));for(let t=1;t<a;t++)e.addCode(n.setLocal("c",n.i64_add(n.i64_add(n.i64_load32_u(n.getLocal("x"),4*t),n.i64_load32_u(n.getLocal("y"),4*t)),n.i64_shr_u(n.getLocal("c"),n.i64_const(32))))),e.addCode(n.i64_store32(n.getLocal("r"),4*t,n.getLocal("c")));e.addCode(n.i32_wrap_i64(n.i64_shr_u(n.getLocal("c"),n.i64_const(32))))}(),function(){const e=t.addFunction(i+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.setReturnType("i32"),e.addLocal("c","i64");const n=e.getCodeBuilder();e.addCode(n.setLocal("c",n.i64_sub(n.i64_load32_u(n.getLocal("x")),n.i64_load32_u(n.getLocal("y"))))),e.addCode(n.i64_store32(n.getLocal("r"),n.i64_and(n.getLocal("c"),n.i64_const("0xFFFFFFFF"))));for(let t=1;t<a;t++)e.addCode(n.setLocal("c",n.i64_add(n.i64_sub(n.i64_load32_u(n.getLocal("x"),4*t),n.i64_load32_u(n.getLocal("y"),4*t)),n.i64_shr_s(n.getLocal("c"),n.i64_const(32))))),e.addCode(n.i64_store32(n.getLocal("r"),4*t,n.i64_and(n.getLocal("c"),n.i64_const("0xFFFFFFFF"))));e.addCode(n.i32_wrap_i64(n.i64_shr_s(n.getLocal("c"),n.i64_const(32))))}(),function(){const e=t.addFunction(i+"_mul");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64");for(let t=0;t<a;t++)e.addLocal("x"+t,"i64"),e.addLocal("y"+t,"i64");const n=e.getCodeBuilder(),o=[],r=[];function s(t,e){let i,a;return o[t]?i=n.getLocal("x"+t):(i=n.teeLocal("x"+t,n.i64_load32_u(n.getLocal("x"),4*t)),o[t]=!0),r[e]?a=n.getLocal("y"+e):(a=n.teeLocal("y"+e,n.i64_load32_u(n.getLocal("y"),4*e)),r[e]=!0),n.i64_mul(i,a)}let c="c0",l="c1";for(let t=0;t<2*a-1;t++){for(let i=Math.max(0,t-a+1);i<=t&&i<a;i++){const a=t-i;e.addCode(n.setLocal(c,n.i64_add(n.i64_and(n.getLocal(c),n.i64_const(4294967295)),s(i,a)))),e.addCode(n.setLocal(l,n.i64_add(n.getLocal(l),n.i64_shr_u(n.getLocal(c),n.i64_const(32)))))}e.addCode(n.i64_store32(n.getLocal("r"),4*t,n.getLocal(c))),[c,l]=[l,c],e.addCode(n.setLocal(l,n.i64_shr_u(n.getLocal(c),n.i64_const(32))))}e.addCode(n.i64_store32(n.getLocal("r"),4*a*2-4,n.getLocal(c)))}(),function(){const e=t.addFunction(i+"_square");e.addParam("x","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("c0_old","i64"),e.addLocal("c1_old","i64");for(let t=0;t<a;t++)e.addLocal("x"+t,"i64");const n=e.getCodeBuilder(),o=[];function r(t,e){let i,a;return o[t]?i=n.getLocal("x"+t):(i=n.teeLocal("x"+t,n.i64_load32_u(n.getLocal("x"),4*t)),o[t]=!0),o[e]?a=n.getLocal("x"+e):(a=n.teeLocal("x"+e,n.i64_load32_u(n.getLocal("x"),4*e)),o[e]=!0),n.i64_mul(i,a)}let s="c0",c="c1",l="c0_old",d="c1_old";for(let t=0;t<2*a-1;t++){e.addCode(n.setLocal(s,n.i64_const(0)),n.setLocal(c,n.i64_const(0)));for(let i=Math.max(0,t-a+1);i<t+1>>1&&i<a;i++){const a=t-i;e.addCode(n.setLocal(s,n.i64_add(n.i64_and(n.getLocal(s),n.i64_const(4294967295)),r(i,a)))),e.addCode(n.setLocal(c,n.i64_add(n.getLocal(c),n.i64_shr_u(n.getLocal(s),n.i64_const(32)))))}e.addCode(n.setLocal(s,n.i64_shl(n.i64_and(n.getLocal(s),n.i64_const(4294967295)),n.i64_const(1)))),e.addCode(n.setLocal(c,n.i64_add(n.i64_shl(n.getLocal(c),n.i64_const(1)),n.i64_shr_u(n.getLocal(s),n.i64_const(32))))),t%2==0&&(e.addCode(n.setLocal(s,n.i64_add(n.i64_and(n.getLocal(s),n.i64_const(4294967295)),r(t>>1,t>>1)))),e.addCode(n.setLocal(c,n.i64_add(n.getLocal(c),n.i64_shr_u(n.getLocal(s),n.i64_const(32)))))),t>0&&(e.addCode(n.setLocal(s,n.i64_add(n.i64_and(n.getLocal(s),n.i64_const(4294967295)),n.i64_and(n.getLocal(l),n.i64_const(4294967295))))),e.addCode(n.setLocal(c,n.i64_add(n.i64_add(n.getLocal(c),n.i64_shr_u(n.getLocal(s),n.i64_const(32))),n.getLocal(d))))),e.addCode(n.i64_store32(n.getLocal("r"),4*t,n.getLocal(s))),e.addCode(n.setLocal(l,n.getLocal(c)),n.setLocal(d,n.i64_shr_u(n.getLocal(l),n.i64_const(32))))}e.addCode(n.i64_store32(n.getLocal("r"),4*a*2-4,n.getLocal(l)))}(),function(){const e=t.addFunction(i+"_squareOld");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder();e.addCode(n.call(i+"_mul",n.getLocal("x"),n.getLocal("x"),n.getLocal("r")))}(),function(){!function(){const e=t.addFunction(i+"__mul1");e.addParam("px","i32"),e.addParam("y","i64"),e.addParam("pr","i32"),e.addLocal("c","i64");const n=e.getCodeBuilder();e.addCode(n.setLocal("c",n.i64_mul(n.i64_load32_u(n.getLocal("px"),0,0),n.getLocal("y")))),e.addCode(n.i64_store32(n.getLocal("pr"),0,0,n.getLocal("c")));for(let t=1;t<a;t++)e.addCode(n.setLocal("c",n.i64_add(n.i64_mul(n.i64_load32_u(n.getLocal("px"),4*t,0),n.getLocal("y")),n.i64_shr_u(n.getLocal("c"),n.i64_const(32))))),e.addCode(n.i64_store32(n.getLocal("pr"),4*t,0,n.getLocal("c")))}(),function(){const e=t.addFunction(i+"__add1");e.addParam("x","i32"),e.addParam("y","i64"),e.addLocal("c","i64"),e.addLocal("px","i32");const n=e.getCodeBuilder();e.addCode(n.setLocal("px",n.getLocal("x"))),e.addCode(n.setLocal("c",n.i64_add(n.i64_load32_u(n.getLocal("px"),0,0),n.getLocal("y")))),e.addCode(n.i64_store32(n.getLocal("px"),0,0,n.getLocal("c"))),e.addCode(n.setLocal("c",n.i64_shr_u(n.getLocal("c"),n.i64_const(32)))),e.addCode(n.block(n.loop(n.br_if(1,n.i64_eqz(n.getLocal("c"))),n.setLocal("px",n.i32_add(n.getLocal("px"),n.i32_const(4))),n.setLocal("c",n.i64_add(n.i64_load32_u(n.getLocal("px"),0,0),n.getLocal("c"))),n.i64_store32(n.getLocal("px"),0,0,n.getLocal("c")),n.setLocal("c",n.i64_shr_u(n.getLocal("c"),n.i64_const(32))),n.br(0))))}();const e=t.addFunction(i+"_div");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("c","i32"),e.addParam("r","i32"),e.addLocal("rr","i32"),e.addLocal("cc","i32"),e.addLocal("eX","i32"),e.addLocal("eY","i32"),e.addLocal("sy","i64"),e.addLocal("sx","i64"),e.addLocal("ec","i32");const n=e.getCodeBuilder(),r=n.i32_const(t.alloc(o)),s=n.i32_const(t.alloc(o)),c=n.i32_const(t.alloc(o)),l=n.getLocal("cc"),d=n.getLocal("rr"),u=t.alloc(2*o),g=n.i32_const(u),f=n.i32_const(u+o);e.addCode(n.if(n.getLocal("c"),n.setLocal("cc",n.getLocal("c")),n.setLocal("cc",s))),e.addCode(n.if(n.getLocal("r"),n.setLocal("rr",n.getLocal("r")),n.setLocal("rr",c))),e.addCode(n.call(i+"_copy",n.getLocal("x"),d)),e.addCode(n.call(i+"_copy",n.getLocal("y"),r)),e.addCode(n.call(i+"_zero",l)),e.addCode(n.call(i+"_zero",g)),e.addCode(n.setLocal("eX",n.i32_const(o-1))),e.addCode(n.setLocal("eY",n.i32_const(o-1))),e.addCode(n.block(n.loop(n.br_if(1,n.i32_or(n.i32_load8_u(n.i32_add(r,n.getLocal("eY")),0,0),n.i32_eq(n.getLocal("eY"),n.i32_const(3)))),n.setLocal("eY",n.i32_sub(n.getLocal("eY"),n.i32_const(1))),n.br(0)))),e.addCode(n.setLocal("sy",n.i64_add(n.i64_load32_u(n.i32_sub(n.i32_add(r,n.getLocal("eY")),n.i32_const(3)),0,0),n.i64_const(1)))),e.addCode(n.if(n.i64_eq(n.getLocal("sy"),n.i64_const(1)),n.drop(n.i64_div_u(n.i64_const(0),n.i64_const(0))))),e.addCode(n.block(n.loop(n.block(n.loop(n.br_if(1,n.i32_or(n.i32_load8_u(n.i32_add(d,n.getLocal("eX")),0,0),n.i32_eq(n.getLocal("eX"),n.i32_const(7)))),n.setLocal("eX",n.i32_sub(n.getLocal("eX"),n.i32_const(1))),n.br(0))),n.setLocal("sx",n.i64_load(n.i32_sub(n.i32_add(d,n.getLocal("eX")),n.i32_const(7)),0,0)),n.setLocal("sx",n.i64_div_u(n.getLocal("sx"),n.getLocal("sy"))),n.setLocal("ec",n.i32_sub(n.i32_sub(n.getLocal("eX"),n.getLocal("eY")),n.i32_const(4))),n.block(n.loop(n.br_if(1,n.i32_and(n.i64_eqz(n.i64_and(n.getLocal("sx"),n.i64_const("0xFFFFFFFF00000000"))),n.i32_ge_s(n.getLocal("ec"),n.i32_const(0)))),n.setLocal("sx",n.i64_shr_u(n.getLocal("sx"),n.i64_const(8))),n.setLocal("ec",n.i32_add(n.getLocal("ec"),n.i32_const(1))),n.br(0))),n.if(n.i64_eqz(n.getLocal("sx")),[...n.br_if(2,n.i32_eqz(n.call(i+"_gte",d,r))),...n.setLocal("sx",n.i64_const(1)),...n.setLocal("ec",n.i32_const(0))]),n.call(i+"__mul1",r,n.getLocal("sx"),f),n.drop(n.call(i+"_sub",d,n.i32_sub(f,n.getLocal("ec")),d)),n.call(i+"__add1",n.i32_add(l,n.getLocal("ec")),n.getLocal("sx")),n.br(0))))}(),function(){const e=t.addFunction(i+"_inverseMod");e.addParam("px","i32"),e.addParam("pm","i32"),e.addParam("pr","i32"),e.addLocal("t","i32"),e.addLocal("newt","i32"),e.addLocal("r","i32"),e.addLocal("qq","i32"),e.addLocal("qr","i32"),e.addLocal("newr","i32"),e.addLocal("swp","i32"),e.addLocal("x","i32"),e.addLocal("signt","i32"),e.addLocal("signnewt","i32"),e.addLocal("signx","i32");const n=e.getCodeBuilder(),a=n.i32_const(t.alloc(o)),r=n.i32_const(t.alloc(o)),s=n.i32_const(t.alloc(o)),c=n.i32_const(t.alloc(o)),l=n.i32_const(t.alloc(o)),d=n.i32_const(t.alloc(o)),u=n.i32_const(t.alloc(2*o)),g=n.i32_const(t.alloc(o));e.addCode(n.setLocal("t",a),n.call(i+"_zero",a),n.setLocal("signt",n.i32_const(0))),e.addCode(n.setLocal("r",r),n.call(i+"_copy",n.getLocal("pm"),r)),e.addCode(n.setLocal("newt",s),n.call(i+"_one",s),n.setLocal("signnewt",n.i32_const(0))),e.addCode(n.setLocal("newr",c),n.call(i+"_copy",n.getLocal("px"),c)),e.addCode(n.setLocal("qq",l)),e.addCode(n.setLocal("qr",d)),e.addCode(n.setLocal("x",g)),e.addCode(n.block(n.loop(n.br_if(1,n.call(i+"_isZero",n.getLocal("newr"))),n.call(i+"_div",n.getLocal("r"),n.getLocal("newr"),n.getLocal("qq"),n.getLocal("qr")),n.call(i+"_mul",n.getLocal("qq"),n.getLocal("newt"),u),n.if(n.getLocal("signt"),n.if(n.getLocal("signnewt"),n.if(n.call(i+"_gte",u,n.getLocal("t")),[...n.drop(n.call(i+"_sub",u,n.getLocal("t"),n.getLocal("x"))),...n.setLocal("signx",n.i32_const(0))],[...n.drop(n.call(i+"_sub",n.getLocal("t"),u,n.getLocal("x"))),...n.setLocal("signx",n.i32_const(1))]),[...n.drop(n.call(i+"_add",u,n.getLocal("t"),n.getLocal("x"))),...n.setLocal("signx",n.i32_const(1))]),n.if(n.getLocal("signnewt"),[...n.drop(n.call(i+"_add",u,n.getLocal("t"),n.getLocal("x"))),...n.setLocal("signx",n.i32_const(0))],n.if(n.call(i+"_gte",n.getLocal("t"),u),[...n.drop(n.call(i+"_sub",n.getLocal("t"),u,n.getLocal("x"))),...n.setLocal("signx",n.i32_const(0))],[...n.drop(n.call(i+"_sub",u,n.getLocal("t"),n.getLocal("x"))),...n.setLocal("signx",n.i32_const(1))]))),n.setLocal("swp",n.getLocal("t")),n.setLocal("t",n.getLocal("newt")),n.setLocal("newt",n.getLocal("x")),n.setLocal("x",n.getLocal("swp")),n.setLocal("signt",n.getLocal("signnewt")),n.setLocal("signnewt",n.getLocal("signx")),n.setLocal("swp",n.getLocal("r")),n.setLocal("r",n.getLocal("newr")),n.setLocal("newr",n.getLocal("qr")),n.setLocal("qr",n.getLocal("swp")),n.br(0)))),e.addCode(n.if(n.getLocal("signt"),n.drop(n.call(i+"_sub",n.getLocal("pm"),n.getLocal("t"),n.getLocal("pr"))),n.call(i+"_copy",n.getLocal("t"),n.getLocal("pr"))))}(),t.exportFunction(i+"_copy"),t.exportFunction(i+"_zero"),t.exportFunction(i+"_one"),t.exportFunction(i+"_isZero"),t.exportFunction(i+"_eq"),t.exportFunction(i+"_gte"),t.exportFunction(i+"_add"),t.exportFunction(i+"_sub"),t.exportFunction(i+"_mul"),t.exportFunction(i+"_square"),t.exportFunction(i+"_squareOld"),t.exportFunction(i+"_div"),t.exportFunction(i+"_inverseMod"),i}(t,o,i),d=t.alloc(s,ut.bigInt2BytesLE(a,s)),u=t.alloc(ut.bigInt2BytesLE(bt(1n<<BigInt(64*o))%a,s)),g=t.alloc(ut.bigInt2BytesLE((1n<<BigInt(64*o))%a,s)),f=t.alloc(ut.bigInt2BytesLE(0n,s)),h=a-1n,_=h>>1n,p=t.alloc(s,ut.bigInt2BytesLE(_,s)),m=_+1n,L=t.alloc(s,ut.bigInt2BytesLE(m,s));t.modules[c]={pq:d,pR2:u,n64:o,q:a,pOne:g,pZero:f,pePlusOne:L};let y=2n;if(yt(a))for(;Lt(y,_,a)!==h;)y+=1n;let A=0,b=h;for(;!At(b)&&0n!==b;)A++,b>>=1n;const I=t.alloc(s,ut.bigInt2BytesLE(b,s)),w=Lt(y,b,a),C=t.alloc(ut.bigInt2BytesLE((w<<BigInt(64*o))%a,s)),x=b+1n>>1n,E=t.alloc(s,ut.bigInt2BytesLE(x,s));return t.exportFunction(l+"_copy",c+"_copy"),t.exportFunction(l+"_zero",c+"_zero"),t.exportFunction(l+"_isZero",c+"_isZero"),t.exportFunction(l+"_eq",c+"_eq"),function(){const e=t.addFunction(c+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder();e.addCode(n.ret(n.call(l+"_eq",n.getLocal("x"),n.i32_const(g))))}(),function(){const e=t.addFunction(c+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const n=e.getCodeBuilder();e.addCode(n.if(n.call(l+"_add",n.getLocal("x"),n.getLocal("y"),n.getLocal("r")),n.drop(n.call(l+"_sub",n.getLocal("r"),n.i32_const(d),n.getLocal("r"))),n.if(n.call(l+"_gte",n.getLocal("r"),n.i32_const(d)),n.drop(n.call(l+"_sub",n.getLocal("r"),n.i32_const(d),n.getLocal("r"))))))}(),function(){const e=t.addFunction(c+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const n=e.getCodeBuilder();e.addCode(n.if(n.call(l+"_sub",n.getLocal("x"),n.getLocal("y"),n.getLocal("r")),n.drop(n.call(l+"_add",n.getLocal("r"),n.i32_const(d),n.getLocal("r")))))}(),function(){const e=t.addFunction(c+"_neg");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder();e.addCode(n.call(c+"_sub",n.i32_const(f),n.getLocal("x"),n.getLocal("r")))}(),function(){const e=t.alloc(r*r*8),n=t.addFunction(c+"_mReduct");n.addParam("t","i32"),n.addParam("r","i32"),n.addLocal("np32","i64"),n.addLocal("c","i64"),n.addLocal("m","i64");const i=n.getCodeBuilder(),o=Number(0x100000000n-mt(a,0x100000000n));n.addCode(i.setLocal("np32",i.i64_const(o)));for(let t=0;t<r;t++){n.addCode(i.setLocal("c",i.i64_const(0))),n.addCode(i.setLocal("m",i.i64_and(i.i64_mul(i.i64_load32_u(i.getLocal("t"),4*t),i.getLocal("np32")),i.i64_const("0xFFFFFFFF"))));for(let e=0;e<r;e++)n.addCode(i.setLocal("c",i.i64_add(i.i64_add(i.i64_load32_u(i.getLocal("t"),4*(t+e)),i.i64_shr_u(i.getLocal("c"),i.i64_const(32))),i.i64_mul(i.i64_load32_u(i.i32_const(d),4*e),i.getLocal("m"))))),n.addCode(i.i64_store32(i.getLocal("t"),4*(t+e),i.getLocal("c")));n.addCode(i.i64_store32(i.i32_const(e),4*t,i.i64_shr_u(i.getLocal("c"),i.i64_const(32))))}n.addCode(i.call(c+"_add",i.i32_const(e),i.i32_add(i.getLocal("t"),i.i32_const(4*r)),i.getLocal("r")))}(),function(){const e=t.addFunction(c+"_mul");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("np32","i64");for(let t=0;t<r;t++)e.addLocal("x"+t,"i64"),e.addLocal("y"+t,"i64"),e.addLocal("m"+t,"i64"),e.addLocal("q"+t,"i64");const n=e.getCodeBuilder(),i=Number(0x100000000n-mt(a,0x100000000n));e.addCode(n.setLocal("np32",n.i64_const(i)));const o=[],s=[],u=[];function g(t,e){let i,a;return o[t]?i=n.getLocal("x"+t):(i=n.teeLocal("x"+t,n.i64_load32_u(n.getLocal("x"),4*t)),o[t]=!0),s[e]?a=n.getLocal("y"+e):(a=n.teeLocal("y"+e,n.i64_load32_u(n.getLocal("y"),4*e)),s[e]=!0),n.i64_mul(i,a)}function f(t,e){let i,a;return u[t]?i=n.getLocal("q"+t):(i=n.teeLocal("q"+t,n.i64_load32_u(n.i32_const(0),d+4*t)),u[t]=!0),a=n.getLocal("m"+e),n.i64_mul(i,a)}let h="c0",_="c1";for(let t=0;t<2*r-1;t++){for(let i=Math.max(0,t-r+1);i<=t&&i<r;i++){const a=t-i;e.addCode(n.setLocal(h,n.i64_add(n.i64_and(n.getLocal(h),n.i64_const(4294967295)),g(i,a)))),e.addCode(n.setLocal(_,n.i64_add(n.getLocal(_),n.i64_shr_u(n.getLocal(h),n.i64_const(32)))))}for(let i=Math.max(1,t-r+1);i<=t&&i<r;i++){const a=t-i;e.addCode(n.setLocal(h,n.i64_add(n.i64_and(n.getLocal(h),n.i64_const(4294967295)),f(i,a)))),e.addCode(n.setLocal(_,n.i64_add(n.getLocal(_),n.i64_shr_u(n.getLocal(h),n.i64_const(32)))))}t<r&&(e.addCode(n.setLocal("m"+t,n.i64_and(n.i64_mul(n.i64_and(n.getLocal(h),n.i64_const(4294967295)),n.getLocal("np32")),n.i64_const("0xFFFFFFFF")))),e.addCode(n.setLocal(h,n.i64_add(n.i64_and(n.getLocal(h),n.i64_const(4294967295)),f(0,t)))),e.addCode(n.setLocal(_,n.i64_add(n.getLocal(_),n.i64_shr_u(n.getLocal(h),n.i64_const(32)))))),t>=r&&e.addCode(n.i64_store32(n.getLocal("r"),4*(t-r),n.getLocal(h))),[h,_]=[_,h],e.addCode(n.setLocal(_,n.i64_shr_u(n.getLocal(h),n.i64_const(32))))}e.addCode(n.i64_store32(n.getLocal("r"),4*r-4,n.getLocal(h))),e.addCode(n.if(n.i32_wrap_i64(n.getLocal(_)),n.drop(n.call(l+"_sub",n.getLocal("r"),n.i32_const(d),n.getLocal("r"))),n.if(n.call(l+"_gte",n.getLocal("r"),n.i32_const(d)),n.drop(n.call(l+"_sub",n.getLocal("r"),n.i32_const(d),n.getLocal("r"))))))}(),function(){const e=t.addFunction(c+"_square");e.addParam("x","i32"),e.addParam("r","i32"),e.addLocal("c0","i64"),e.addLocal("c1","i64"),e.addLocal("c0_old","i64"),e.addLocal("c1_old","i64"),e.addLocal("np32","i64");for(let t=0;t<r;t++)e.addLocal("x"+t,"i64"),e.addLocal("m"+t,"i64"),e.addLocal("q"+t,"i64");const n=e.getCodeBuilder(),i=Number(0x100000000n-mt(a,0x100000000n));e.addCode(n.setLocal("np32",n.i64_const(i)));const o=[],s=[];function u(t,e){let i,a;return o[t]?i=n.getLocal("x"+t):(i=n.teeLocal("x"+t,n.i64_load32_u(n.getLocal("x"),4*t)),o[t]=!0),o[e]?a=n.getLocal("x"+e):(a=n.teeLocal("x"+e,n.i64_load32_u(n.getLocal("x"),4*e)),o[e]=!0),n.i64_mul(i,a)}function g(t,e){let i,a;return s[t]?i=n.getLocal("q"+t):(i=n.teeLocal("q"+t,n.i64_load32_u(n.i32_const(0),d+4*t)),s[t]=!0),a=n.getLocal("m"+e),n.i64_mul(i,a)}let f="c0",h="c1",_="c0_old",p="c1_old";for(let t=0;t<2*r-1;t++){e.addCode(n.setLocal(f,n.i64_const(0)),n.setLocal(h,n.i64_const(0)));for(let i=Math.max(0,t-r+1);i<t+1>>1&&i<r;i++){const a=t-i;e.addCode(n.setLocal(f,n.i64_add(n.i64_and(n.getLocal(f),n.i64_const(4294967295)),u(i,a)))),e.addCode(n.setLocal(h,n.i64_add(n.getLocal(h),n.i64_shr_u(n.getLocal(f),n.i64_const(32)))))}e.addCode(n.setLocal(f,n.i64_shl(n.i64_and(n.getLocal(f),n.i64_const(4294967295)),n.i64_const(1)))),e.addCode(n.setLocal(h,n.i64_add(n.i64_shl(n.getLocal(h),n.i64_const(1)),n.i64_shr_u(n.getLocal(f),n.i64_const(32))))),t%2==0&&(e.addCode(n.setLocal(f,n.i64_add(n.i64_and(n.getLocal(f),n.i64_const(4294967295)),u(t>>1,t>>1)))),e.addCode(n.setLocal(h,n.i64_add(n.getLocal(h),n.i64_shr_u(n.getLocal(f),n.i64_const(32)))))),t>0&&(e.addCode(n.setLocal(f,n.i64_add(n.i64_and(n.getLocal(f),n.i64_const(4294967295)),n.i64_and(n.getLocal(_),n.i64_const(4294967295))))),e.addCode(n.setLocal(h,n.i64_add(n.i64_add(n.getLocal(h),n.i64_shr_u(n.getLocal(f),n.i64_const(32))),n.getLocal(p)))));for(let i=Math.max(1,t-r+1);i<=t&&i<r;i++){const a=t-i;e.addCode(n.setLocal(f,n.i64_add(n.i64_and(n.getLocal(f),n.i64_const(4294967295)),g(i,a)))),e.addCode(n.setLocal(h,n.i64_add(n.getLocal(h),n.i64_shr_u(n.getLocal(f),n.i64_const(32)))))}t<r&&(e.addCode(n.setLocal("m"+t,n.i64_and(n.i64_mul(n.i64_and(n.getLocal(f),n.i64_const(4294967295)),n.getLocal("np32")),n.i64_const("0xFFFFFFFF")))),e.addCode(n.setLocal(f,n.i64_add(n.i64_and(n.getLocal(f),n.i64_const(4294967295)),g(0,t)))),e.addCode(n.setLocal(h,n.i64_add(n.getLocal(h),n.i64_shr_u(n.getLocal(f),n.i64_const(32)))))),t>=r&&e.addCode(n.i64_store32(n.getLocal("r"),4*(t-r),n.getLocal(f))),e.addCode(n.setLocal(_,n.getLocal(h)),n.setLocal(p,n.i64_shr_u(n.getLocal(_),n.i64_const(32))))}e.addCode(n.i64_store32(n.getLocal("r"),4*r-4,n.getLocal(_))),e.addCode(n.if(n.i32_wrap_i64(n.getLocal(p)),n.drop(n.call(l+"_sub",n.getLocal("r"),n.i32_const(d),n.getLocal("r"))),n.if(n.call(l+"_gte",n.getLocal("r"),n.i32_const(d)),n.drop(n.call(l+"_sub",n.getLocal("r"),n.i32_const(d),n.getLocal("r"))))))}(),function(){const e=t.addFunction(c+"_squareOld");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder();e.addCode(n.call(c+"_mul",n.getLocal("x"),n.getLocal("x"),n.getLocal("r")))}(),function(){const e=t.addFunction(c+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder();e.addCode(n.call(c+"_mul",n.getLocal("x"),n.i32_const(u),n.getLocal("r")))}(),function(){const e=t.alloc(2*s),n=t.addFunction(c+"_fromMontgomery");n.addParam("x","i32"),n.addParam("r","i32");const i=n.getCodeBuilder();n.addCode(i.call(l+"_copy",i.getLocal("x"),i.i32_const(e))),n.addCode(i.call(l+"_zero",i.i32_const(e+s))),n.addCode(i.call(c+"_mReduct",i.i32_const(e),i.getLocal("r")))}(),function(){const e=t.addFunction(c+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),i=n.i32_const(t.alloc(s));e.addCode(n.call(c+"_fromMontgomery",n.getLocal("x"),i),n.call(l+"_gte",i,n.i32_const(L)))}(),function(){const e=t.addFunction(c+"_sign");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),i=n.i32_const(t.alloc(s));e.addCode(n.if(n.call(l+"_isZero",n.getLocal("x")),n.ret(n.i32_const(0))),n.call(c+"_fromMontgomery",n.getLocal("x"),i),n.if(n.call(l+"_gte",i,n.i32_const(L)),n.ret(n.i32_const(-1))),n.ret(n.i32_const(1)))}(),function(){const e=t.addFunction(c+"_inverse");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder();e.addCode(n.call(c+"_fromMontgomery",n.getLocal("x"),n.getLocal("r"))),e.addCode(n.call(l+"_inverseMod",n.getLocal("r"),n.i32_const(d),n.getLocal("r"))),e.addCode(n.call(c+"_toMontgomery",n.getLocal("r"),n.getLocal("r")))}(),function(){const e=t.addFunction(c+"_one");e.addParam("pr","i32");const n=e.getCodeBuilder();e.addCode(n.call(l+"_copy",n.i32_const(g),n.getLocal("pr")))}(),function(){const e=t.addFunction(c+"_load");e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32"),e.addLocal("p","i32"),e.addLocal("l","i32"),e.addLocal("i","i32"),e.addLocal("j","i32");const n=e.getCodeBuilder(),i=n.i32_const(t.alloc(s)),a=t.alloc(s),o=n.i32_const(a);e.addCode(n.call(l+"_zero",n.getLocal("r")),n.setLocal("i",n.i32_const(s)),n.setLocal("p",n.getLocal("scalar")),n.block(n.loop(n.br_if(1,n.i32_gt_u(n.getLocal("i"),n.getLocal("scalarLen"))),n.if(n.i32_eq(n.getLocal("i"),n.i32_const(s)),n.call(c+"_one",i),n.call(c+"_mul",i,n.i32_const(u),i)),n.call(c+"_mul",n.getLocal("p"),i,o),n.call(c+"_add",n.getLocal("r"),o,n.getLocal("r")),n.setLocal("p",n.i32_add(n.getLocal("p"),n.i32_const(s))),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(s))),n.br(0))),n.setLocal("l",n.i32_rem_u(n.getLocal("scalarLen"),n.i32_const(s))),n.if(n.i32_eqz(n.getLocal("l")),n.ret([])),n.call(l+"_zero",o),n.setLocal("j",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("j"),n.getLocal("l"))),n.i32_store8(n.getLocal("j"),a,n.i32_load8_u(n.getLocal("p"))),n.setLocal("p",n.i32_add(n.getLocal("p"),n.i32_const(1))),n.setLocal("j",n.i32_add(n.getLocal("j"),n.i32_const(1))),n.br(0))),n.if(n.i32_eq(n.getLocal("i"),n.i32_const(s)),n.call(c+"_one",i),n.call(c+"_mul",i,n.i32_const(u),i)),n.call(c+"_mul",o,i,o),n.call(c+"_add",n.getLocal("r"),o,n.getLocal("r")))}(),function(){const e=t.addFunction(c+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");const n=e.getCodeBuilder(),i=n.i32_const(t.alloc(s));e.addCode(n.call(c+"_load",n.getLocal("scalar"),n.getLocal("scalarLen"),i),n.call(c+"_toMontgomery",i,i),n.call(c+"_mul",n.getLocal("x"),i,n.getLocal("r")))}(),ft(t,c),ht(t,c+"_batchToMontgomery",c+"_toMontgomery",s,s),ht(t,c+"_batchFromMontgomery",c+"_fromMontgomery",s,s),ht(t,c+"_batchNeg",c+"_neg",s,s),_t(t,c+"_batchAdd",c+"_add",s,s),_t(t,c+"_batchSub",c+"_sub",s,s),_t(t,c+"_batchMul",c+"_mul",s,s),t.exportFunction(c+"_add"),t.exportFunction(c+"_sub"),t.exportFunction(c+"_neg"),t.exportFunction(c+"_isNegative"),t.exportFunction(c+"_isOne"),t.exportFunction(c+"_sign"),t.exportFunction(c+"_mReduct"),t.exportFunction(c+"_mul"),t.exportFunction(c+"_square"),t.exportFunction(c+"_squareOld"),t.exportFunction(c+"_fromMontgomery"),t.exportFunction(c+"_toMontgomery"),t.exportFunction(c+"_inverse"),t.exportFunction(c+"_one"),t.exportFunction(c+"_load"),t.exportFunction(c+"_timesScalar"),gt(t,c+"_exp",s,c+"_mul",c+"_square",l+"_copy",c+"_one"),t.exportFunction(c+"_exp"),t.exportFunction(c+"_batchInverse"),yt(a)&&(function(){const e=t.addFunction(c+"_sqrt");e.addParam("n","i32"),e.addParam("r","i32"),e.addLocal("m","i32"),e.addLocal("i","i32"),e.addLocal("j","i32");const n=e.getCodeBuilder(),i=n.i32_const(g),a=n.i32_const(t.alloc(s)),o=n.i32_const(t.alloc(s)),r=n.i32_const(t.alloc(s)),l=n.i32_const(t.alloc(s)),d=n.i32_const(t.alloc(s));e.addCode(n.if(n.call(c+"_isZero",n.getLocal("n")),n.ret(n.call(c+"_zero",n.getLocal("r")))),n.setLocal("m",n.i32_const(A)),n.call(c+"_copy",n.i32_const(C),a),n.call(c+"_exp",n.getLocal("n"),n.i32_const(I),n.i32_const(s),o),n.call(c+"_exp",n.getLocal("n"),n.i32_const(E),n.i32_const(s),r),n.block(n.loop(n.br_if(1,n.call(c+"_eq",o,i)),n.call(c+"_square",o,l),n.setLocal("i",n.i32_const(1)),n.block(n.loop(n.br_if(1,n.call(c+"_eq",l,i)),n.call(c+"_square",l,l),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))),n.call(c+"_copy",a,d),n.setLocal("j",n.i32_sub(n.i32_sub(n.getLocal("m"),n.getLocal("i")),n.i32_const(1))),n.block(n.loop(n.br_if(1,n.i32_eqz(n.getLocal("j"))),n.call(c+"_square",d,d),n.setLocal("j",n.i32_sub(n.getLocal("j"),n.i32_const(1))),n.br(0))),n.setLocal("m",n.getLocal("i")),n.call(c+"_square",d,a),n.call(c+"_mul",o,a,o),n.call(c+"_mul",r,d,r),n.br(0))),n.if(n.call(c+"_isNegative",r),n.call(c+"_neg",r,n.getLocal("r")),n.call(c+"_copy",r,n.getLocal("r"))))}(),function(){const e=t.addFunction(c+"_isSquare");e.addParam("n","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),i=n.i32_const(g),a=n.i32_const(t.alloc(s));e.addCode(n.if(n.call(c+"_isZero",n.getLocal("n")),n.ret(n.i32_const(1))),n.call(c+"_exp",n.getLocal("n"),n.i32_const(p),n.i32_const(s),a),n.call(c+"_eq",a,i))}(),t.exportFunction(c+"_sqrt"),t.exportFunction(c+"_isSquare")),t.exportFunction(c+"_batchToMontgomery"),t.exportFunction(c+"_batchFromMontgomery"),c};const wt=It,{bitLength:Ct}=W;var xt=function(t,e,n,i,a){const o=BigInt(e),r=Math.floor((Ct(o-1n)-1)/64)+1,s=8*r,c=n||"f1";if(t.modules[c])return c;t.modules[c]={n64:r};const l=a||"int",d=wt(t,o,i,l),u=t.modules[d].pR2,g=t.modules[d].pq,f=t.modules[d].pePlusOne;return function(){const e=t.alloc(s),n=t.addFunction(c+"_mul");n.addParam("x","i32"),n.addParam("y","i32"),n.addParam("r","i32");const i=n.getCodeBuilder();n.addCode(i.call(d+"_mul",i.getLocal("x"),i.getLocal("y"),i.i32_const(e))),n.addCode(i.call(d+"_mul",i.i32_const(e),i.i32_const(u),i.getLocal("r")))}(),function(){const e=t.addFunction(c+"_square");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder();e.addCode(n.call(c+"_mul",n.getLocal("x"),n.getLocal("x"),n.getLocal("r")))}(),function(){const e=t.addFunction(c+"_inverse");e.addParam("x","i32"),e.addParam("r","i32");const n=e.getCodeBuilder();e.addCode(n.call(l+"_inverseMod",n.getLocal("x"),n.i32_const(g),n.getLocal("r")))}(),function(){const e=t.addFunction(c+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const n=e.getCodeBuilder();e.addCode(n.call(l+"_gte",n.getLocal("x"),n.i32_const(f)))}(),t.exportFunction(d+"_add",c+"_add"),t.exportFunction(d+"_sub",c+"_sub"),t.exportFunction(d+"_neg",c+"_neg"),t.exportFunction(c+"_mul"),t.exportFunction(c+"_square"),t.exportFunction(c+"_inverse"),t.exportFunction(c+"_isNegative"),t.exportFunction(d+"_copy",c+"_copy"),t.exportFunction(d+"_zero",c+"_zero"),t.exportFunction(d+"_one",c+"_one"),t.exportFunction(d+"_isZero",c+"_isZero"),t.exportFunction(d+"_eq",c+"_eq"),c};const Et=$,Bt=Y,Ft=H;var vt=function(t,e,n,i){if(t.modules[n])return n;const a=8*t.modules[i].n64,o=t.modules[i].q;return t.modules[n]={n64:2*t.modules[i].n64},function(){const e=t.addFunction(n+"_isZero");e.addParam("x","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a));e.addCode(o.i32_and(o.call(i+"_isZero",r),o.call(i+"_isZero",s)))}(),function(){const e=t.addFunction(n+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a));e.addCode(o.ret(o.i32_and(o.call(i+"_isOne",r),o.call(i+"_isZero",s))))}(),function(){const e=t.addFunction(n+"_zero");e.addParam("x","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a));e.addCode(o.call(i+"_zero",r),o.call(i+"_zero",s))}(),function(){const e=t.addFunction(n+"_one");e.addParam("x","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a));e.addCode(o.call(i+"_one",r),o.call(i+"_zero",s))}(),function(){const e=t.addFunction(n+"_copy");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("r"),l=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(i+"_copy",r,c),o.call(i+"_copy",s,l))}(),function(){const o=t.addFunction(n+"_mul");o.addParam("x","i32"),o.addParam("y","i32"),o.addParam("r","i32");const r=o.getCodeBuilder(),s=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(a)),l=r.getLocal("y"),d=r.i32_add(r.getLocal("y"),r.i32_const(a)),u=r.getLocal("r"),g=r.i32_add(r.getLocal("r"),r.i32_const(a)),f=r.i32_const(t.alloc(a)),h=r.i32_const(t.alloc(a)),_=r.i32_const(t.alloc(a)),p=r.i32_const(t.alloc(a));o.addCode(r.call(i+"_mul",s,l,f),r.call(i+"_mul",c,d,h),r.call(i+"_add",s,c,_),r.call(i+"_add",l,d,p),r.call(i+"_mul",_,p,_),r.call(e,h,u),r.call(i+"_add",f,u,u),r.call(i+"_add",f,h,g),r.call(i+"_sub",_,g,g))}(),function(){const e=t.addFunction(n+"_mul1");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("y"),l=o.getLocal("r"),d=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(i+"_mul",r,c,l),o.call(i+"_mul",s,c,d))}(),function(){const o=t.addFunction(n+"_square");o.addParam("x","i32"),o.addParam("r","i32");const r=o.getCodeBuilder(),s=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(a)),l=r.getLocal("r"),d=r.i32_add(r.getLocal("r"),r.i32_const(a)),u=r.i32_const(t.alloc(a)),g=r.i32_const(t.alloc(a)),f=r.i32_const(t.alloc(a)),h=r.i32_const(t.alloc(a));o.addCode(r.call(i+"_mul",s,c,u),r.call(i+"_add",s,c,g),r.call(e,c,f),r.call(i+"_add",s,f,f),r.call(e,u,h),r.call(i+"_add",h,u,h),r.call(i+"_mul",g,f,l),r.call(i+"_sub",l,h,l),r.call(i+"_add",u,u,d))}(),function(){const e=t.addFunction(n+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("y"),l=o.i32_add(o.getLocal("y"),o.i32_const(a)),d=o.getLocal("r"),u=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(i+"_add",r,c,d),o.call(i+"_add",s,l,u))}(),function(){const e=t.addFunction(n+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("y"),l=o.i32_add(o.getLocal("y"),o.i32_const(a)),d=o.getLocal("r"),u=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(i+"_sub",r,c,d),o.call(i+"_sub",s,l,u))}(),function(){const e=t.addFunction(n+"_neg");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("r"),l=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(i+"_neg",r,c),o.call(i+"_neg",s,l))}(),function(){const e=t.addFunction(n+"_conjugate");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("r"),l=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(i+"_copy",r,c),o.call(i+"_neg",s,l))}(),function(){const e=t.addFunction(n+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("r"),l=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(i+"_toMontgomery",r,c),o.call(i+"_toMontgomery",s,l))}(),function(){const e=t.addFunction(n+"_fromMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("r"),l=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(i+"_fromMontgomery",r,c),o.call(i+"_fromMontgomery",s,l))}(),function(){const e=t.addFunction(n+"_eq");e.addParam("x","i32"),e.addParam("y","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("y"),l=o.i32_add(o.getLocal("y"),o.i32_const(a));e.addCode(o.i32_and(o.call(i+"_eq",r,c),o.call(i+"_eq",s,l)))}(),function(){const o=t.addFunction(n+"_inverse");o.addParam("x","i32"),o.addParam("r","i32");const r=o.getCodeBuilder(),s=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(a)),l=r.getLocal("r"),d=r.i32_add(r.getLocal("r"),r.i32_const(a)),u=r.i32_const(t.alloc(a)),g=r.i32_const(t.alloc(a)),f=r.i32_const(t.alloc(a)),h=r.i32_const(t.alloc(a));o.addCode(r.call(i+"_square",s,u),r.call(i+"_square",c,g),r.call(e,g,f),r.call(i+"_sub",u,f,f),r.call(i+"_inverse",f,h),r.call(i+"_mul",s,h,l),r.call(i+"_mul",c,h,d),r.call(i+"_neg",d,d))}(),function(){const e=t.addFunction(n+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.getLocal("r"),l=o.i32_add(o.getLocal("r"),o.i32_const(a));e.addCode(o.call(i+"_timesScalar",r,o.getLocal("scalar"),o.getLocal("scalarLen"),c),o.call(i+"_timesScalar",s,o.getLocal("scalar"),o.getLocal("scalarLen"),l))}(),function(){const e=t.addFunction(n+"_sign");e.addParam("x","i32"),e.addLocal("s","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a));e.addCode(o.setLocal("s",o.call(i+"_sign",s)),o.if(o.getLocal("s"),o.ret(o.getLocal("s"))),o.ret(o.call(i+"_sign",r)))}(),function(){const e=t.addFunction(n+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a));e.addCode(o.if(o.call(i+"_isZero",s),o.ret(o.call(i+"_isNegative",r))),o.ret(o.call(i+"_isNegative",s)))}(),t.exportFunction(n+"_isZero"),t.exportFunction(n+"_isOne"),t.exportFunction(n+"_zero"),t.exportFunction(n+"_one"),t.exportFunction(n+"_copy"),t.exportFunction(n+"_mul"),t.exportFunction(n+"_mul1"),t.exportFunction(n+"_square"),t.exportFunction(n+"_add"),t.exportFunction(n+"_sub"),t.exportFunction(n+"_neg"),t.exportFunction(n+"_sign"),t.exportFunction(n+"_conjugate"),t.exportFunction(n+"_fromMontgomery"),t.exportFunction(n+"_toMontgomery"),t.exportFunction(n+"_eq"),t.exportFunction(n+"_inverse"),Bt(t,n),Et(t,n+"_exp",2*a,n+"_mul",n+"_square",n+"_copy",n+"_one"),function(){const e=t.addFunction(n+"_sqrt");e.addParam("a","i32"),e.addParam("pr","i32");const r=e.getCodeBuilder(),s=r.i32_const(t.alloc(Ft.bigInt2BytesLE((BigInt(o||0)-3n)/4n,a))),c=r.i32_const(t.alloc(Ft.bigInt2BytesLE((BigInt(o||0)-1n)/2n,a))),l=r.getLocal("a"),d=r.i32_const(t.alloc(2*a)),u=r.i32_const(t.alloc(2*a)),g=r.i32_const(t.alloc(2*a)),f=t.alloc(2*a),h=r.i32_const(f),_=r.i32_const(f),p=r.i32_const(f+a),m=r.i32_const(t.alloc(2*a)),L=r.i32_const(t.alloc(2*a));e.addCode(r.call(n+"_one",h),r.call(n+"_neg",h,h),r.call(n+"_exp",l,s,r.i32_const(a),d),r.call(n+"_square",d,u),r.call(n+"_mul",l,u,u),r.call(n+"_conjugate",u,g),r.call(n+"_mul",g,u,g),r.if(r.call(n+"_eq",g,h),r.unreachable()),r.call(n+"_mul",d,l,m),r.if(r.call(n+"_eq",u,h),[...r.call(i+"_zero",_),...r.call(i+"_one",p),...r.call(n+"_mul",h,m,r.getLocal("pr"))],[...r.call(n+"_one",L),...r.call(n+"_add",L,u,L),...r.call(n+"_exp",L,c,r.i32_const(a),L),...r.call(n+"_mul",L,m,r.getLocal("pr"))]))}(),function(){const e=t.addFunction(n+"_isSquare");e.addParam("a","i32"),e.setReturnType("i32");const i=e.getCodeBuilder(),r=i.i32_const(t.alloc(Ft.bigInt2BytesLE((BigInt(o||0)-3n)/4n,a))),s=i.getLocal("a"),c=i.i32_const(t.alloc(2*a)),l=i.i32_const(t.alloc(2*a)),d=i.i32_const(t.alloc(2*a)),u=t.alloc(2*a),g=i.i32_const(u);e.addCode(i.call(n+"_one",g),i.call(n+"_neg",g,g),i.call(n+"_exp",s,r,i.i32_const(a),c),i.call(n+"_square",c,l),i.call(n+"_mul",s,l,l),i.call(n+"_conjugate",l,d),i.call(n+"_mul",d,l,d),i.if(i.call(n+"_eq",d,g),i.ret(i.i32_const(0))),i.ret(i.i32_const(1)))}(),t.exportFunction(n+"_exp"),t.exportFunction(n+"_timesScalar"),t.exportFunction(n+"_batchInverse"),t.exportFunction(n+"_sqrt"),t.exportFunction(n+"_isSquare"),t.exportFunction(n+"_isNegative"),n};const Pt=$,Ot=Y;var St=function(t,e,n,i){if(t.modules[n])return n;const a=8*t.modules[i].n64;return t.modules[n]={n64:3*t.modules[i].n64},function(){const e=t.addFunction(n+"_isZero");e.addParam("x","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a));e.addCode(o.i32_and(o.i32_and(o.call(i+"_isZero",r),o.call(i+"_isZero",s)),o.call(i+"_isZero",c)))}(),function(){const e=t.addFunction(n+"_isOne");e.addParam("x","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a));e.addCode(o.ret(o.i32_and(o.i32_and(o.call(i+"_isOne",r),o.call(i+"_isZero",s)),o.call(i+"_isZero",c))))}(),function(){const e=t.addFunction(n+"_zero");e.addParam("x","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a));e.addCode(o.call(i+"_zero",r),o.call(i+"_zero",s),o.call(i+"_zero",c))}(),function(){const e=t.addFunction(n+"_one");e.addParam("x","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a));e.addCode(o.call(i+"_one",r),o.call(i+"_zero",s),o.call(i+"_zero",c))}(),function(){const e=t.addFunction(n+"_copy");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("r"),d=o.i32_add(o.getLocal("r"),o.i32_const(a)),u=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(i+"_copy",r,l),o.call(i+"_copy",s,d),o.call(i+"_copy",c,u))}(),function(){const o=t.addFunction(n+"_mul");o.addParam("x","i32"),o.addParam("y","i32"),o.addParam("r","i32");const r=o.getCodeBuilder(),s=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(a)),l=r.i32_add(r.getLocal("x"),r.i32_const(2*a)),d=r.getLocal("y"),u=r.i32_add(r.getLocal("y"),r.i32_const(a)),g=r.i32_add(r.getLocal("y"),r.i32_const(2*a)),f=r.getLocal("r"),h=r.i32_add(r.getLocal("r"),r.i32_const(a)),_=r.i32_add(r.getLocal("r"),r.i32_const(2*a)),p=r.i32_const(t.alloc(a)),m=r.i32_const(t.alloc(a)),L=r.i32_const(t.alloc(a)),y=r.i32_const(t.alloc(a)),A=r.i32_const(t.alloc(a)),b=r.i32_const(t.alloc(a)),I=r.i32_const(t.alloc(a)),w=r.i32_const(t.alloc(a)),C=r.i32_const(t.alloc(a)),x=r.i32_const(t.alloc(a)),E=r.i32_const(t.alloc(a)),B=r.i32_const(t.alloc(a)),F=r.i32_const(t.alloc(a));o.addCode(r.call(i+"_mul",s,d,p),r.call(i+"_mul",c,u,m),r.call(i+"_mul",l,g,L),r.call(i+"_add",s,c,y),r.call(i+"_add",d,u,A),r.call(i+"_add",s,l,b),r.call(i+"_add",d,g,I),r.call(i+"_add",c,l,w),r.call(i+"_add",u,g,C),r.call(i+"_add",p,m,x),r.call(i+"_add",p,L,E),r.call(i+"_add",m,L,B),r.call(i+"_mul",w,C,f),r.call(i+"_sub",f,B,f),r.call(e,f,f),r.call(i+"_add",p,f,f),r.call(i+"_mul",y,A,h),r.call(i+"_sub",h,x,h),r.call(e,L,F),r.call(i+"_add",h,F,h),r.call(i+"_mul",b,I,_),r.call(i+"_sub",_,E,_),r.call(i+"_add",_,m,_))}(),function(){const o=t.addFunction(n+"_square");o.addParam("x","i32"),o.addParam("r","i32");const r=o.getCodeBuilder(),s=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(a)),l=r.i32_add(r.getLocal("x"),r.i32_const(2*a)),d=r.getLocal("r"),u=r.i32_add(r.getLocal("r"),r.i32_const(a)),g=r.i32_add(r.getLocal("r"),r.i32_const(2*a)),f=r.i32_const(t.alloc(a)),h=r.i32_const(t.alloc(a)),_=r.i32_const(t.alloc(a)),p=r.i32_const(t.alloc(a)),m=r.i32_const(t.alloc(a)),L=r.i32_const(t.alloc(a)),y=r.i32_const(t.alloc(a));o.addCode(r.call(i+"_square",s,f),r.call(i+"_mul",s,c,h),r.call(i+"_add",h,h,_),r.call(i+"_sub",s,c,p),r.call(i+"_add",p,l,p),r.call(i+"_square",p,p),r.call(i+"_mul",c,l,m),r.call(i+"_add",m,m,L),r.call(i+"_square",l,y),r.call(e,L,d),r.call(i+"_add",f,d,d),r.call(e,y,u),r.call(i+"_add",_,u,u),r.call(i+"_add",f,y,g),r.call(i+"_sub",L,g,g),r.call(i+"_add",p,g,g),r.call(i+"_add",_,g,g))}(),function(){const e=t.addFunction(n+"_add");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("y"),d=o.i32_add(o.getLocal("y"),o.i32_const(a)),u=o.i32_add(o.getLocal("y"),o.i32_const(2*a)),g=o.getLocal("r"),f=o.i32_add(o.getLocal("r"),o.i32_const(a)),h=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(i+"_add",r,l,g),o.call(i+"_add",s,d,f),o.call(i+"_add",c,u,h))}(),function(){const e=t.addFunction(n+"_sub");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("y"),d=o.i32_add(o.getLocal("y"),o.i32_const(a)),u=o.i32_add(o.getLocal("y"),o.i32_const(2*a)),g=o.getLocal("r"),f=o.i32_add(o.getLocal("r"),o.i32_const(a)),h=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(i+"_sub",r,l,g),o.call(i+"_sub",s,d,f),o.call(i+"_sub",c,u,h))}(),function(){const e=t.addFunction(n+"_neg");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("r"),d=o.i32_add(o.getLocal("r"),o.i32_const(a)),u=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(i+"_neg",r,l),o.call(i+"_neg",s,d),o.call(i+"_neg",c,u))}(),function(){const e=t.addFunction(n+"_sign");e.addParam("x","i32"),e.addLocal("s","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a));e.addCode(o.setLocal("s",o.call(i+"_sign",c)),o.if(o.getLocal("s"),o.ret(o.getLocal("s"))),o.setLocal("s",o.call(i+"_sign",s)),o.if(o.getLocal("s"),o.ret(o.getLocal("s"))),o.ret(o.call(i+"_sign",r)))}(),function(){const e=t.addFunction(n+"_toMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("r"),d=o.i32_add(o.getLocal("r"),o.i32_const(a)),u=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(i+"_toMontgomery",r,l),o.call(i+"_toMontgomery",s,d),o.call(i+"_toMontgomery",c,u))}(),function(){const e=t.addFunction(n+"_fromMontgomery");e.addParam("x","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("r"),d=o.i32_add(o.getLocal("r"),o.i32_const(a)),u=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(i+"_fromMontgomery",r,l),o.call(i+"_fromMontgomery",s,d),o.call(i+"_fromMontgomery",c,u))}(),function(){const e=t.addFunction(n+"_eq");e.addParam("x","i32"),e.addParam("y","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("y"),d=o.i32_add(o.getLocal("y"),o.i32_const(a)),u=o.i32_add(o.getLocal("y"),o.i32_const(2*a));e.addCode(o.i32_and(o.i32_and(o.call(i+"_eq",r,l),o.call(i+"_eq",s,d)),o.call(i+"_eq",c,u)))}(),function(){const o=t.addFunction(n+"_inverse");o.addParam("x","i32"),o.addParam("r","i32");const r=o.getCodeBuilder(),s=r.getLocal("x"),c=r.i32_add(r.getLocal("x"),r.i32_const(a)),l=r.i32_add(r.getLocal("x"),r.i32_const(2*a)),d=r.getLocal("r"),u=r.i32_add(r.getLocal("r"),r.i32_const(a)),g=r.i32_add(r.getLocal("r"),r.i32_const(2*a)),f=r.i32_const(t.alloc(a)),h=r.i32_const(t.alloc(a)),_=r.i32_const(t.alloc(a)),p=r.i32_const(t.alloc(a)),m=r.i32_const(t.alloc(a)),L=r.i32_const(t.alloc(a)),y=r.i32_const(t.alloc(a)),A=r.i32_const(t.alloc(a)),b=r.i32_const(t.alloc(a)),I=r.i32_const(t.alloc(a)),w=r.i32_const(t.alloc(a));o.addCode(r.call(i+"_square",s,f),r.call(i+"_square",c,h),r.call(i+"_square",l,_),r.call(i+"_mul",s,c,p),r.call(i+"_mul",s,l,m),r.call(i+"_mul",c,l,L),r.call(e,L,y),r.call(i+"_sub",f,y,y),r.call(e,_,A),r.call(i+"_sub",A,p,A),r.call(i+"_sub",h,m,b),r.call(i+"_mul",l,A,I),r.call(i+"_mul",c,b,w),r.call(i+"_add",I,w,I),r.call(e,I,I),r.call(i+"_mul",s,y,w),r.call(i+"_add",w,I,I),r.call(i+"_inverse",I,I),r.call(i+"_mul",I,y,d),r.call(i+"_mul",I,A,u),r.call(i+"_mul",I,b,g))}(),function(){const e=t.addFunction(n+"_timesScalar");e.addParam("x","i32"),e.addParam("scalar","i32"),e.addParam("scalarLen","i32"),e.addParam("r","i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a)),l=o.getLocal("r"),d=o.i32_add(o.getLocal("r"),o.i32_const(a)),u=o.i32_add(o.getLocal("r"),o.i32_const(2*a));e.addCode(o.call(i+"_timesScalar",r,o.getLocal("scalar"),o.getLocal("scalarLen"),l),o.call(i+"_timesScalar",s,o.getLocal("scalar"),o.getLocal("scalarLen"),d),o.call(i+"_timesScalar",c,o.getLocal("scalar"),o.getLocal("scalarLen"),u))}(),function(){const e=t.addFunction(n+"_isNegative");e.addParam("x","i32"),e.setReturnType("i32");const o=e.getCodeBuilder(),r=o.getLocal("x"),s=o.i32_add(o.getLocal("x"),o.i32_const(a)),c=o.i32_add(o.getLocal("x"),o.i32_const(2*a));e.addCode(o.if(o.call(i+"_isZero",c),o.if(o.call(i+"_isZero",s),o.ret(o.call(i+"_isNegative",r)),o.ret(o.call(i+"_isNegative",s)))),o.ret(o.call(i+"_isNegative",c)))}(),t.exportFunction(n+"_isZero"),t.exportFunction(n+"_isOne"),t.exportFunction(n+"_zero"),t.exportFunction(n+"_one"),t.exportFunction(n+"_copy"),t.exportFunction(n+"_mul"),t.exportFunction(n+"_square"),t.exportFunction(n+"_add"),t.exportFunction(n+"_sub"),t.exportFunction(n+"_neg"),t.exportFunction(n+"_sign"),t.exportFunction(n+"_fromMontgomery"),t.exportFunction(n+"_toMontgomery"),t.exportFunction(n+"_eq"),t.exportFunction(n+"_inverse"),Ot(t,n),Pt(t,n+"_exp",3*a,n+"_mul",n+"_square",n+"_copy",n+"_one"),t.exportFunction(n+"_exp"),t.exportFunction(n+"_timesScalar"),t.exportFunction(n+"_batchInverse"),t.exportFunction(n+"_isNegative"),n};const Ut=function(t,e,n,i,a,o,r,s){const c=t.addFunction(e);c.addParam("base","i32"),c.addParam("scalar","i32"),c.addParam("scalarLength","i32"),c.addParam("r","i32"),c.addLocal("old0","i32"),c.addLocal("nbits","i32"),c.addLocal("i","i32"),c.addLocal("last","i32"),c.addLocal("cur","i32"),c.addLocal("carry","i32"),c.addLocal("p","i32");const l=c.getCodeBuilder(),d=l.i32_const(t.alloc(n));function u(t){return l.i32_and(l.i32_shr_u(l.i32_load(l.i32_add(l.getLocal("scalar"),l.i32_and(l.i32_shr_u(t,l.i32_const(3)),l.i32_const(4294967292)))),l.i32_and(t,l.i32_const(31))),l.i32_const(1))}function g(t){return[...l.i32_store8(l.getLocal("p"),l.i32_const(t)),...l.setLocal("p",l.i32_add(l.getLocal("p"),l.i32_const(1)))]}c.addCode(l.if(l.i32_eqz(l.getLocal("scalarLength")),[...l.call(s,l.getLocal("r")),...l.ret([])]),l.setLocal("nbits",l.i32_shl(l.getLocal("scalarLength"),l.i32_const(3))),l.setLocal("old0",l.i32_load(l.i32_const(0))),l.setLocal("p",l.getLocal("old0")),l.i32_store(l.i32_const(0),l.i32_and(l.i32_add(l.i32_add(l.getLocal("old0"),l.i32_const(32)),l.getLocal("nbits")),l.i32_const(4294967288))),l.setLocal("i",l.i32_const(1)),l.setLocal("last",u(l.i32_const(0))),l.setLocal("carry",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("nbits"))),l.setLocal("cur",u(l.getLocal("i"))),l.if(l.getLocal("last"),l.if(l.getLocal("cur"),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...g(1)],[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...g(255)]),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...g(255)],[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(0)),...g(1)])),l.if(l.getLocal("cur"),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...g(0)],[...l.setLocal("last",l.i32_const(1)),...l.setLocal("carry",l.i32_const(0)),...g(0)]),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(1)),...l.setLocal("carry",l.i32_const(0)),...g(0)],[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(0)),...g(0)]))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))),l.if(l.getLocal("last"),l.if(l.getLocal("carry"),[...g(255),...g(0),...g(1)],[...g(1)]),l.if(l.getLocal("carry"),[...g(0),...g(1)])),l.setLocal("p",l.i32_sub(l.getLocal("p"),l.i32_const(1))),l.call(r,l.getLocal("base"),d),l.call(s,l.getLocal("r")),l.block(l.loop(l.call(a,l.getLocal("r"),l.getLocal("r")),l.setLocal("cur",l.i32_load8_u(l.getLocal("p"))),l.if(l.getLocal("cur"),l.if(l.i32_eq(l.getLocal("cur"),l.i32_const(1)),l.call(i,l.getLocal("r"),d,l.getLocal("r")),l.call(o,l.getLocal("r"),d,l.getLocal("r")))),l.br_if(1,l.i32_eq(l.getLocal("old0"),l.getLocal("p"))),l.setLocal("p",l.i32_sub(l.getLocal("p"),l.i32_const(1))),l.br(0))),l.i32_store(l.i32_const(0),l.getLocal("old0")))},Qt=J,kt=function(t,e,n,i,a){const o=8*t.modules[e].n64;!function(){const e=t.addFunction(n+"_getChunk");e.addParam("pScalar","i32"),e.addParam("scalarSize","i32"),e.addParam("startBit","i32"),e.addParam("chunkSize","i32"),e.addLocal("bitsToEnd","i32"),e.addLocal("mask","i32"),e.setReturnType("i32");const i=e.getCodeBuilder();e.addCode(i.setLocal("bitsToEnd",i.i32_sub(i.i32_mul(i.getLocal("scalarSize"),i.i32_const(8)),i.getLocal("startBit"))),i.if(i.i32_gt_s(i.getLocal("chunkSize"),i.getLocal("bitsToEnd")),i.setLocal("mask",i.i32_sub(i.i32_shl(i.i32_const(1),i.getLocal("bitsToEnd")),i.i32_const(1))),i.setLocal("mask",i.i32_sub(i.i32_shl(i.i32_const(1),i.getLocal("chunkSize")),i.i32_const(1)))),i.i32_and(i.i32_shr_u(i.i32_load(i.i32_add(i.getLocal("pScalar"),i.i32_shr_u(i.getLocal("startBit"),i.i32_const(3))),0,0),i.i32_and(i.getLocal("startBit"),i.i32_const(7))),i.getLocal("mask")))}(),function(){const i=t.addFunction(n+"_reduceTable");i.addParam("pTable","i32"),i.addParam("p","i32"),i.addLocal("half","i32"),i.addLocal("it1","i32"),i.addLocal("it2","i32"),i.addLocal("pAcc","i32");const a=i.getCodeBuilder();i.addCode(a.if(a.i32_eq(a.getLocal("p"),a.i32_const(1)),a.ret([])),a.setLocal("half",a.i32_shl(a.i32_const(1),a.i32_sub(a.getLocal("p"),a.i32_const(1)))),a.setLocal("it1",a.getLocal("pTable")),a.setLocal("it2",a.i32_add(a.getLocal("pTable"),a.i32_mul(a.getLocal("half"),a.i32_const(o)))),a.setLocal("pAcc",a.i32_sub(a.getLocal("it2"),a.i32_const(o))),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("it1"),a.getLocal("pAcc"))),a.call(e+"_add",a.getLocal("it1"),a.getLocal("it2"),a.getLocal("it1")),a.call(e+"_add",a.getLocal("pAcc"),a.getLocal("it2"),a.getLocal("pAcc")),a.setLocal("it1",a.i32_add(a.getLocal("it1"),a.i32_const(o))),a.setLocal("it2",a.i32_add(a.getLocal("it2"),a.i32_const(o))),a.br(0))),a.call(n+"_reduceTable",a.getLocal("pTable"),a.i32_sub(a.getLocal("p"),a.i32_const(1))),a.setLocal("p",a.i32_sub(a.getLocal("p"),a.i32_const(1))),a.block(a.loop(a.br_if(1,a.i32_eqz(a.getLocal("p"))),a.call(e+"_double",a.getLocal("pAcc"),a.getLocal("pAcc")),a.setLocal("p",a.i32_sub(a.getLocal("p"),a.i32_const(1))),a.br(0))),a.call(e+"_add",a.getLocal("pTable"),a.getLocal("pAcc"),a.getLocal("pTable")))}(),function(){const r=t.addFunction(n+"_chunk");r.addParam("pBases","i32"),r.addParam("pScalars","i32"),r.addParam("scalarSize","i32"),r.addParam("n","i32"),r.addParam("startBit","i32"),r.addParam("chunkSize","i32"),r.addParam("pr","i32"),r.addLocal("nChunks","i32"),r.addLocal("itScalar","i32"),r.addLocal("endScalar","i32"),r.addLocal("itBase","i32"),r.addLocal("i","i32"),r.addLocal("j","i32"),r.addLocal("nTable","i32"),r.addLocal("pTable","i32"),r.addLocal("idx","i32"),r.addLocal("pIdxTable","i32");const s=r.getCodeBuilder();r.addCode(s.if(s.i32_eqz(s.getLocal("n")),[...s.call(e+"_zero",s.getLocal("pr")),...s.ret([])]),s.setLocal("nTable",s.i32_shl(s.i32_const(1),s.getLocal("chunkSize"))),s.setLocal("pTable",s.i32_load(s.i32_const(0))),s.i32_store(s.i32_const(0),s.i32_add(s.getLocal("pTable"),s.i32_mul(s.getLocal("nTable"),s.i32_const(o)))),s.setLocal("j",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("j"),s.getLocal("nTable"))),s.call(e+"_zero",s.i32_add(s.getLocal("pTable"),s.i32_mul(s.getLocal("j"),s.i32_const(o)))),s.setLocal("j",s.i32_add(s.getLocal("j"),s.i32_const(1))),s.br(0))),s.setLocal("itBase",s.getLocal("pBases")),s.setLocal("itScalar",s.getLocal("pScalars")),s.setLocal("endScalar",s.i32_add(s.getLocal("pScalars"),s.i32_mul(s.getLocal("n"),s.getLocal("scalarSize")))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("itScalar"),s.getLocal("endScalar"))),s.setLocal("idx",s.call(n+"_getChunk",s.getLocal("itScalar"),s.getLocal("scalarSize"),s.getLocal("startBit"),s.getLocal("chunkSize"))),s.if(s.getLocal("idx"),[...s.setLocal("pIdxTable",s.i32_add(s.getLocal("pTable"),s.i32_mul(s.i32_sub(s.getLocal("idx"),s.i32_const(1)),s.i32_const(o)))),...s.call(i,s.getLocal("pIdxTable"),s.getLocal("itBase"),s.getLocal("pIdxTable"))]),s.setLocal("itScalar",s.i32_add(s.getLocal("itScalar"),s.getLocal("scalarSize"))),s.setLocal("itBase",s.i32_add(s.getLocal("itBase"),s.i32_const(a))),s.br(0))),s.call(n+"_reduceTable",s.getLocal("pTable"),s.getLocal("chunkSize")),s.call(e+"_copy",s.getLocal("pTable"),s.getLocal("pr")),s.i32_store(s.i32_const(0),s.getLocal("pTable")))}(),function(){const i=t.addFunction(n);i.addParam("pBases","i32"),i.addParam("pScalars","i32"),i.addParam("scalarSize","i32"),i.addParam("n","i32"),i.addParam("pr","i32"),i.addLocal("chunkSize","i32"),i.addLocal("nChunks","i32"),i.addLocal("itScalar","i32"),i.addLocal("endScalar","i32"),i.addLocal("itBase","i32"),i.addLocal("itBit","i32"),i.addLocal("i","i32"),i.addLocal("j","i32"),i.addLocal("nTable","i32"),i.addLocal("pTable","i32"),i.addLocal("idx","i32"),i.addLocal("pIdxTable","i32");const a=i.getCodeBuilder(),r=a.i32_const(t.alloc(o)),s=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);i.addCode(a.call(e+"_zero",a.getLocal("pr")),a.if(a.i32_eqz(a.getLocal("n")),a.ret([])),a.setLocal("chunkSize",a.i32_load8_u(a.i32_clz(a.getLocal("n")),s)),a.setLocal("nChunks",a.i32_add(a.i32_div_u(a.i32_sub(a.i32_shl(a.getLocal("scalarSize"),a.i32_const(3)),a.i32_const(1)),a.getLocal("chunkSize")),a.i32_const(1))),a.setLocal("itBit",a.i32_mul(a.i32_sub(a.getLocal("nChunks"),a.i32_const(1)),a.getLocal("chunkSize"))),a.block(a.loop(a.br_if(1,a.i32_lt_s(a.getLocal("itBit"),a.i32_const(0))),a.if(a.i32_eqz(a.call(e+"_isZero",a.getLocal("pr"))),[...a.setLocal("j",a.i32_const(0)),...a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("j"),a.getLocal("chunkSize"))),a.call(e+"_double",a.getLocal("pr"),a.getLocal("pr")),a.setLocal("j",a.i32_add(a.getLocal("j"),a.i32_const(1))),a.br(0)))]),a.call(n+"_chunk",a.getLocal("pBases"),a.getLocal("pScalars"),a.getLocal("scalarSize"),a.getLocal("n"),a.getLocal("itBit"),a.getLocal("chunkSize"),r),a.call(e+"_add",a.getLocal("pr"),r,a.getLocal("pr")),a.setLocal("itBit",a.i32_sub(a.getLocal("itBit"),a.getLocal("chunkSize"))),a.br(0))))}(),t.exportFunction(n),t.exportFunction(n+"_chunk")};var Tt=function(t,e,n,i){const a=t.modules[n].n64,o=8*a;return t.modules[e]||(t.modules[e]={n64:3*a},function(){const i=t.addFunction(e+"_isZeroAffine");i.addParam("p1","i32"),i.setReturnType("i32");const a=i.getCodeBuilder();i.addCode(a.i32_and(a.call(n+"_isZero",a.getLocal("p1")),a.call(n+"_isZero",a.i32_add(a.getLocal("p1"),a.i32_const(o)))))}(),function(){const i=t.addFunction(e+"_isZero");i.addParam("p1","i32"),i.setReturnType("i32");const a=i.getCodeBuilder();i.addCode(a.call(n+"_isZero",a.i32_add(a.getLocal("p1"),a.i32_const(2*o))))}(),function(){const i=t.addFunction(e+"_zeroAffine");i.addParam("pr","i32");const a=i.getCodeBuilder();i.addCode(a.call(n+"_zero",a.getLocal("pr"))),i.addCode(a.call(n+"_zero",a.i32_add(a.getLocal("pr"),a.i32_const(o))))}(),function(){const i=t.addFunction(e+"_zero");i.addParam("pr","i32");const a=i.getCodeBuilder();i.addCode(a.call(n+"_zero",a.getLocal("pr"))),i.addCode(a.call(n+"_one",a.i32_add(a.getLocal("pr"),a.i32_const(o)))),i.addCode(a.call(n+"_zero",a.i32_add(a.getLocal("pr"),a.i32_const(2*o))))}(),function(){const n=t.addFunction(e+"_copyAffine");n.addParam("ps","i32"),n.addParam("pd","i32");const i=n.getCodeBuilder();for(let t=0;t<2*a;t++)n.addCode(i.i64_store(i.getLocal("pd"),8*t,i.i64_load(i.getLocal("ps"),8*t)))}(),function(){const n=t.addFunction(e+"_copy");n.addParam("ps","i32"),n.addParam("pd","i32");const i=n.getCodeBuilder();for(let t=0;t<3*a;t++)n.addCode(i.i64_store(i.getLocal("pd"),8*t,i.i64_load(i.getLocal("ps"),8*t)))}(),function(){const i=t.addFunction(e+"_toJacobian");i.addParam("p1","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.getLocal("pr"),l=a.i32_add(a.getLocal("pr"),a.i32_const(o)),d=a.i32_add(a.getLocal("pr"),a.i32_const(2*o));i.addCode(a.if(a.call(e+"_isZeroAffine",a.getLocal("p1")),a.call(e+"_zero",a.getLocal("pr")),[...a.call(n+"_one",d),...a.call(n+"_copy",s,l),...a.call(n+"_copy",r,c)]))}(),function(){const i=t.addFunction(e+"_eqAffine");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32");const a=i.getCodeBuilder();i.addCode(a.ret(a.i32_and(a.call(n+"_eq",a.getLocal("p1"),a.getLocal("p2")),a.call(n+"_eq",a.i32_add(a.getLocal("p1"),a.i32_const(o)),a.i32_add(a.getLocal("p2"),a.i32_const(o))))))}(),function(){const i=t.addFunction(e+"_eqMixed");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32");const a=i.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o));i.addCode(a.setLocal("z1",a.i32_add(a.getLocal("p1"),a.i32_const(2*o))));const c=a.getLocal("z1"),l=a.getLocal("p2"),d=a.i32_add(a.getLocal("p2"),a.i32_const(o)),u=a.i32_const(t.alloc(o)),g=a.i32_const(t.alloc(o)),f=a.i32_const(t.alloc(o)),h=a.i32_const(t.alloc(o));i.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),a.ret(a.call(e+"_isZeroAffine",a.getLocal("p2")))),a.if(a.call(e+"_isZeroAffine",a.getLocal("p2")),a.ret(a.i32_const(0))),a.if(a.call(n+"_isOne",c),a.ret(a.call(e+"_eqAffine",a.getLocal("p1"),a.getLocal("p2")))),a.call(n+"_square",c,u),a.call(n+"_mul",l,u,g),a.call(n+"_mul",c,u,f),a.call(n+"_mul",d,f,h),a.if(a.call(n+"_eq",r,g),a.if(a.call(n+"_eq",s,h),a.ret(a.i32_const(1)))),a.ret(a.i32_const(0)))}(),function(){const i=t.addFunction(e+"_eq");i.addParam("p1","i32"),i.addParam("p2","i32"),i.setReturnType("i32"),i.addLocal("z1","i32"),i.addLocal("z2","i32");const a=i.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o));i.addCode(a.setLocal("z1",a.i32_add(a.getLocal("p1"),a.i32_const(2*o))));const c=a.getLocal("z1"),l=a.getLocal("p2"),d=a.i32_add(a.getLocal("p2"),a.i32_const(o));i.addCode(a.setLocal("z2",a.i32_add(a.getLocal("p2"),a.i32_const(2*o))));const u=a.getLocal("z2"),g=a.i32_const(t.alloc(o)),f=a.i32_const(t.alloc(o)),h=a.i32_const(t.alloc(o)),_=a.i32_const(t.alloc(o)),p=a.i32_const(t.alloc(o)),m=a.i32_const(t.alloc(o)),L=a.i32_const(t.alloc(o)),y=a.i32_const(t.alloc(o));i.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),a.ret(a.call(e+"_isZero",a.getLocal("p2")))),a.if(a.call(e+"_isZero",a.getLocal("p2")),a.ret(a.i32_const(0))),a.if(a.call(n+"_isOne",c),a.ret(a.call(e+"_eqMixed",a.getLocal("p2"),a.getLocal("p1")))),a.if(a.call(n+"_isOne",u),a.ret(a.call(e+"_eqMixed",a.getLocal("p1"),a.getLocal("p2")))),a.call(n+"_square",c,g),a.call(n+"_square",u,f),a.call(n+"_mul",r,f,h),a.call(n+"_mul",l,g,_),a.call(n+"_mul",c,g,p),a.call(n+"_mul",u,f,m),a.call(n+"_mul",s,m,L),a.call(n+"_mul",d,p,y),a.if(a.call(n+"_eq",h,_),a.if(a.call(n+"_eq",L,y),a.ret(a.i32_const(1)))),a.ret(a.i32_const(0)))}(),function(){const i=t.addFunction(e+"_doubleAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.getLocal("pr"),l=a.i32_add(a.getLocal("pr"),a.i32_const(o)),d=a.i32_add(a.getLocal("pr"),a.i32_const(2*o)),u=a.i32_const(t.alloc(o)),g=a.i32_const(t.alloc(o)),f=a.i32_const(t.alloc(o)),h=a.i32_const(t.alloc(o)),_=a.i32_const(t.alloc(o)),p=a.i32_const(t.alloc(o));i.addCode(a.if(a.call(e+"_isZeroAffine",a.getLocal("p1")),[...a.call(e+"_toJacobian",a.getLocal("p1"),a.getLocal("pr")),...a.ret([])]),a.call(n+"_square",r,u),a.call(n+"_square",s,g),a.call(n+"_square",g,f),a.call(n+"_add",r,g,h),a.call(n+"_square",h,h),a.call(n+"_sub",h,u,h),a.call(n+"_sub",h,f,h),a.call(n+"_add",h,h,h),a.call(n+"_add",u,u,_),a.call(n+"_add",_,u,_),a.call(n+"_add",s,s,d),a.call(n+"_square",_,c),a.call(n+"_sub",c,h,c),a.call(n+"_sub",c,h,c),a.call(n+"_add",f,f,p),a.call(n+"_add",p,p,p),a.call(n+"_add",p,p,p),a.call(n+"_sub",h,c,l),a.call(n+"_mul",l,_,l),a.call(n+"_sub",l,p,l))}(),function(){const i=t.addFunction(e+"_double");i.addParam("p1","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.i32_add(a.getLocal("p1"),a.i32_const(2*o)),l=a.getLocal("pr"),d=a.i32_add(a.getLocal("pr"),a.i32_const(o)),u=a.i32_add(a.getLocal("pr"),a.i32_const(2*o)),g=a.i32_const(t.alloc(o)),f=a.i32_const(t.alloc(o)),h=a.i32_const(t.alloc(o)),_=a.i32_const(t.alloc(o)),p=a.i32_const(t.alloc(o)),m=a.i32_const(t.alloc(o)),L=a.i32_const(t.alloc(o)),y=a.i32_const(t.alloc(o));i.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),[...a.call(e+"_copy",a.getLocal("p1"),a.getLocal("pr")),...a.ret([])]),a.if(a.call(n+"_isOne",c),[...a.ret(a.call(e+"_doubleAffine",a.getLocal("p1"),a.getLocal("pr"))),...a.ret([])]),a.call(n+"_square",r,g),a.call(n+"_square",s,f),a.call(n+"_square",f,h),a.call(n+"_add",r,f,_),a.call(n+"_square",_,_),a.call(n+"_sub",_,g,_),a.call(n+"_sub",_,h,_),a.call(n+"_add",_,_,_),a.call(n+"_add",g,g,p),a.call(n+"_add",p,g,p),a.call(n+"_square",p,m),a.call(n+"_mul",s,c,L),a.call(n+"_add",_,_,l),a.call(n+"_sub",m,l,l),a.call(n+"_add",h,h,y),a.call(n+"_add",y,y,y),a.call(n+"_add",y,y,y),a.call(n+"_sub",_,l,d),a.call(n+"_mul",d,p,d),a.call(n+"_sub",d,y,d),a.call(n+"_add",L,L,u))}(),function(){const i=t.addFunction(e+"_addAffine");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32");const a=i.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o));i.addCode(a.setLocal("z1",a.i32_add(a.getLocal("p1"),a.i32_const(2*o))));const c=a.getLocal("p2"),l=a.i32_add(a.getLocal("p2"),a.i32_const(o)),d=a.getLocal("pr"),u=a.i32_add(a.getLocal("pr"),a.i32_const(o)),g=a.i32_add(a.getLocal("pr"),a.i32_const(2*o)),f=a.i32_const(t.alloc(o)),h=a.i32_const(t.alloc(o)),_=a.i32_const(t.alloc(o)),p=a.i32_const(t.alloc(o)),m=a.i32_const(t.alloc(o)),L=a.i32_const(t.alloc(o)),y=a.i32_const(t.alloc(o)),A=a.i32_const(t.alloc(o)),b=a.i32_const(t.alloc(o)),I=a.i32_const(t.alloc(o));i.addCode(a.if(a.call(e+"_isZeroAffine",a.getLocal("p1")),[...a.call(e+"_copyAffine",a.getLocal("p2"),a.getLocal("pr")),...a.call(n+"_one",a.i32_add(a.getLocal("pr"),a.i32_const(2*o))),...a.ret([])]),a.if(a.call(e+"_isZeroAffine",a.getLocal("p2")),[...a.call(e+"_copyAffine",a.getLocal("p1"),a.getLocal("pr")),...a.call(n+"_one",a.i32_add(a.getLocal("pr"),a.i32_const(2*o))),...a.ret([])]),a.if(a.call(n+"_eq",r,c),a.if(a.call(n+"_eq",s,l),[...a.call(e+"_doubleAffine",a.getLocal("p2"),a.getLocal("pr")),...a.ret([])])),a.call(n+"_sub",c,r,f),a.call(n+"_sub",l,s,_),a.call(n+"_square",f,h),a.call(n+"_add",h,h,p),a.call(n+"_add",p,p,p),a.call(n+"_mul",f,p,m),a.call(n+"_add",_,_,L),a.call(n+"_mul",r,p,A),a.call(n+"_square",L,y),a.call(n+"_add",A,A,b),a.call(n+"_sub",y,m,d),a.call(n+"_sub",d,b,d),a.call(n+"_mul",s,m,I),a.call(n+"_add",I,I,I),a.call(n+"_sub",A,d,u),a.call(n+"_mul",u,L,u),a.call(n+"_sub",u,I,u),a.call(n+"_add",f,f,g))}(),function(){const i=t.addFunction(e+"_addMixed");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32");const a=i.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o));i.addCode(a.setLocal("z1",a.i32_add(a.getLocal("p1"),a.i32_const(2*o))));const c=a.getLocal("z1"),l=a.getLocal("p2"),d=a.i32_add(a.getLocal("p2"),a.i32_const(o)),u=a.getLocal("pr"),g=a.i32_add(a.getLocal("pr"),a.i32_const(o)),f=a.i32_add(a.getLocal("pr"),a.i32_const(2*o)),h=a.i32_const(t.alloc(o)),_=a.i32_const(t.alloc(o)),p=a.i32_const(t.alloc(o)),m=a.i32_const(t.alloc(o)),L=a.i32_const(t.alloc(o)),y=a.i32_const(t.alloc(o)),A=a.i32_const(t.alloc(o)),b=a.i32_const(t.alloc(o)),I=a.i32_const(t.alloc(o)),w=a.i32_const(t.alloc(o)),C=a.i32_const(t.alloc(o)),x=a.i32_const(t.alloc(o)),E=a.i32_const(t.alloc(o)),B=a.i32_const(t.alloc(o));i.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),[...a.call(e+"_copyAffine",a.getLocal("p2"),a.getLocal("pr")),...a.call(n+"_one",a.i32_add(a.getLocal("pr"),a.i32_const(2*o))),...a.ret([])]),a.if(a.call(e+"_isZeroAffine",a.getLocal("p2")),[...a.call(e+"_copy",a.getLocal("p1"),a.getLocal("pr")),...a.ret([])]),a.if(a.call(n+"_isOne",c),[...a.call(e+"_addAffine",r,l,u),...a.ret([])]),a.call(n+"_square",c,h),a.call(n+"_mul",l,h,_),a.call(n+"_mul",c,h,p),a.call(n+"_mul",d,p,m),a.if(a.call(n+"_eq",r,_),a.if(a.call(n+"_eq",s,m),[...a.call(e+"_doubleAffine",a.getLocal("p2"),a.getLocal("pr")),...a.ret([])])),a.call(n+"_sub",_,r,L),a.call(n+"_sub",m,s,A),a.call(n+"_square",L,y),a.call(n+"_add",y,y,b),a.call(n+"_add",b,b,b),a.call(n+"_mul",L,b,I),a.call(n+"_add",A,A,w),a.call(n+"_mul",r,b,x),a.call(n+"_square",w,C),a.call(n+"_add",x,x,E),a.call(n+"_sub",C,I,u),a.call(n+"_sub",u,E,u),a.call(n+"_mul",s,I,B),a.call(n+"_add",B,B,B),a.call(n+"_sub",x,u,g),a.call(n+"_mul",g,w,g),a.call(n+"_sub",g,B,g),a.call(n+"_add",c,L,f),a.call(n+"_square",f,f),a.call(n+"_sub",f,h,f),a.call(n+"_sub",f,y,f))}(),function(){const i=t.addFunction(e+"_add");i.addParam("p1","i32"),i.addParam("p2","i32"),i.addParam("pr","i32"),i.addLocal("z1","i32"),i.addLocal("z2","i32");const a=i.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o));i.addCode(a.setLocal("z1",a.i32_add(a.getLocal("p1"),a.i32_const(2*o))));const c=a.getLocal("z1"),l=a.getLocal("p2"),d=a.i32_add(a.getLocal("p2"),a.i32_const(o));i.addCode(a.setLocal("z2",a.i32_add(a.getLocal("p2"),a.i32_const(2*o))));const u=a.getLocal("z2"),g=a.getLocal("pr"),f=a.i32_add(a.getLocal("pr"),a.i32_const(o)),h=a.i32_add(a.getLocal("pr"),a.i32_const(2*o)),_=a.i32_const(t.alloc(o)),p=a.i32_const(t.alloc(o)),m=a.i32_const(t.alloc(o)),L=a.i32_const(t.alloc(o)),y=a.i32_const(t.alloc(o)),A=a.i32_const(t.alloc(o)),b=a.i32_const(t.alloc(o)),I=a.i32_const(t.alloc(o)),w=a.i32_const(t.alloc(o)),C=a.i32_const(t.alloc(o)),x=a.i32_const(t.alloc(o)),E=a.i32_const(t.alloc(o)),B=a.i32_const(t.alloc(o)),F=a.i32_const(t.alloc(o)),v=a.i32_const(t.alloc(o)),P=a.i32_const(t.alloc(o)),O=a.i32_const(t.alloc(o));i.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),[...a.call(e+"_copy",a.getLocal("p2"),a.getLocal("pr")),...a.ret([])]),a.if(a.call(e+"_isZero",a.getLocal("p2")),[...a.call(e+"_copy",a.getLocal("p1"),a.getLocal("pr")),...a.ret([])]),a.if(a.call(n+"_isOne",c),[...a.call(e+"_addMixed",l,r,g),...a.ret([])]),a.if(a.call(n+"_isOne",u),[...a.call(e+"_addMixed",r,l,g),...a.ret([])]),a.call(n+"_square",c,_),a.call(n+"_square",u,p),a.call(n+"_mul",r,p,m),a.call(n+"_mul",l,_,L),a.call(n+"_mul",c,_,y),a.call(n+"_mul",u,p,A),a.call(n+"_mul",s,A,b),a.call(n+"_mul",d,y,I),a.if(a.call(n+"_eq",m,L),a.if(a.call(n+"_eq",b,I),[...a.call(e+"_double",a.getLocal("p1"),a.getLocal("pr")),...a.ret([])])),a.call(n+"_sub",L,m,w),a.call(n+"_sub",I,b,C),a.call(n+"_add",w,w,x),a.call(n+"_square",x,x),a.call(n+"_mul",w,x,E),a.call(n+"_add",C,C,B),a.call(n+"_mul",m,x,v),a.call(n+"_square",B,F),a.call(n+"_add",v,v,P),a.call(n+"_sub",F,E,g),a.call(n+"_sub",g,P,g),a.call(n+"_mul",b,E,O),a.call(n+"_add",O,O,O),a.call(n+"_sub",v,g,f),a.call(n+"_mul",f,B,f),a.call(n+"_sub",f,O,f),a.call(n+"_add",c,u,h),a.call(n+"_square",h,h),a.call(n+"_sub",h,_,h),a.call(n+"_sub",h,p,h),a.call(n+"_mul",h,w,h))}(),function(){const i=t.addFunction(e+"_negAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.getLocal("pr"),l=a.i32_add(a.getLocal("pr"),a.i32_const(o));i.addCode(a.call(n+"_copy",r,c),a.call(n+"_neg",s,l))}(),function(){const i=t.addFunction(e+"_neg");i.addParam("p1","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.i32_add(a.getLocal("p1"),a.i32_const(2*o)),l=a.getLocal("pr"),d=a.i32_add(a.getLocal("pr"),a.i32_const(o)),u=a.i32_add(a.getLocal("pr"),a.i32_const(2*o));i.addCode(a.call(n+"_copy",r,l),a.call(n+"_neg",s,d),a.call(n+"_copy",c,u))}(),function(){const n=t.addFunction(e+"_subAffine");n.addParam("p1","i32"),n.addParam("p2","i32"),n.addParam("pr","i32");const i=n.getCodeBuilder(),a=i.i32_const(t.alloc(3*o));n.addCode(i.call(e+"_negAffine",i.getLocal("p2"),a),i.call(e+"_addAffine",i.getLocal("p1"),a,i.getLocal("pr")))}(),function(){const n=t.addFunction(e+"_subMixed");n.addParam("p1","i32"),n.addParam("p2","i32"),n.addParam("pr","i32");const i=n.getCodeBuilder(),a=i.i32_const(t.alloc(3*o));n.addCode(i.call(e+"_negAffine",i.getLocal("p2"),a),i.call(e+"_addMixed",i.getLocal("p1"),a,i.getLocal("pr")))}(),function(){const n=t.addFunction(e+"_sub");n.addParam("p1","i32"),n.addParam("p2","i32"),n.addParam("pr","i32");const i=n.getCodeBuilder(),a=i.i32_const(t.alloc(3*o));n.addCode(i.call(e+"_neg",i.getLocal("p2"),a),i.call(e+"_add",i.getLocal("p1"),a,i.getLocal("pr")))}(),function(){const i=t.addFunction(e+"_fromMontgomeryAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder();i.addCode(a.call(n+"_fromMontgomery",a.getLocal("p1"),a.getLocal("pr")));for(let t=1;t<2;t++)i.addCode(a.call(n+"_fromMontgomery",a.i32_add(a.getLocal("p1"),a.i32_const(t*o)),a.i32_add(a.getLocal("pr"),a.i32_const(t*o))))}(),function(){const i=t.addFunction(e+"_fromMontgomery");i.addParam("p1","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder();i.addCode(a.call(n+"_fromMontgomery",a.getLocal("p1"),a.getLocal("pr")));for(let t=1;t<3;t++)i.addCode(a.call(n+"_fromMontgomery",a.i32_add(a.getLocal("p1"),a.i32_const(t*o)),a.i32_add(a.getLocal("pr"),a.i32_const(t*o))))}(),function(){const i=t.addFunction(e+"_toMontgomeryAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder();i.addCode(a.call(n+"_toMontgomery",a.getLocal("p1"),a.getLocal("pr")));for(let t=1;t<2;t++)i.addCode(a.call(n+"_toMontgomery",a.i32_add(a.getLocal("p1"),a.i32_const(t*o)),a.i32_add(a.getLocal("pr"),a.i32_const(t*o))))}(),function(){const i=t.addFunction(e+"_toMontgomery");i.addParam("p1","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder();i.addCode(a.call(n+"_toMontgomery",a.getLocal("p1"),a.getLocal("pr")));for(let t=1;t<3;t++)i.addCode(a.call(n+"_toMontgomery",a.i32_add(a.getLocal("p1"),a.i32_const(t*o)),a.i32_add(a.getLocal("pr"),a.i32_const(t*o))))}(),function(){const i=t.addFunction(e+"_toAffine");i.addParam("p1","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.i32_add(a.getLocal("p1"),a.i32_const(2*o)),l=a.getLocal("pr"),d=a.i32_add(a.getLocal("pr"),a.i32_const(o)),u=a.i32_const(t.alloc(o)),g=a.i32_const(t.alloc(o)),f=a.i32_const(t.alloc(o));i.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),[...a.call(n+"_zero",l),...a.call(n+"_zero",d)],[...a.call(n+"_inverse",c,u),...a.call(n+"_square",u,g),...a.call(n+"_mul",u,g,f),...a.call(n+"_mul",r,g,l),...a.call(n+"_mul",s,f,d)]))}(),function(){const a=t.addFunction(e+"_inCurveAffine");a.addParam("pIn","i32"),a.setReturnType("i32");const r=a.getCodeBuilder(),s=r.getLocal("pIn"),c=r.i32_add(r.getLocal("pIn"),r.i32_const(o)),l=r.i32_const(t.alloc(o)),d=r.i32_const(t.alloc(o));a.addCode(r.call(n+"_square",c,l),r.call(n+"_square",s,d),r.call(n+"_mul",s,d,d),r.call(n+"_add",d,r.i32_const(i),d),r.ret(r.call(n+"_eq",l,d)))}(),function(){const n=t.addFunction(e+"_inCurve");n.addParam("pIn","i32"),n.setReturnType("i32");const i=n.getCodeBuilder(),a=i.i32_const(t.alloc(2*o));n.addCode(i.call(e+"_toAffine",i.getLocal("pIn"),a),i.ret(i.call(e+"_inCurveAffine",a)))}(),function(){const i=t.addFunction(e+"_batchToAffine");i.addParam("pIn","i32"),i.addParam("n","i32"),i.addParam("pOut","i32"),i.addLocal("pAux","i32"),i.addLocal("itIn","i32"),i.addLocal("itAux","i32"),i.addLocal("itOut","i32"),i.addLocal("i","i32");const a=i.getCodeBuilder(),r=a.i32_const(t.alloc(o));i.addCode(a.setLocal("pAux",a.i32_load(a.i32_const(0))),a.i32_store(a.i32_const(0),a.i32_add(a.getLocal("pAux"),a.i32_mul(a.getLocal("n"),a.i32_const(o)))),a.call(n+"_batchInverse",a.i32_add(a.getLocal("pIn"),a.i32_const(2*o)),a.i32_const(3*o),a.getLocal("n"),a.getLocal("pAux"),a.i32_const(o)),a.setLocal("itIn",a.getLocal("pIn")),a.setLocal("itAux",a.getLocal("pAux")),a.setLocal("itOut",a.getLocal("pOut")),a.setLocal("i",a.i32_const(0)),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("i"),a.getLocal("n"))),a.if(a.call(n+"_isZero",a.getLocal("itAux")),[...a.call(n+"_zero",a.getLocal("itOut")),...a.call(n+"_zero",a.i32_add(a.getLocal("itOut"),a.i32_const(o)))],[...a.call(n+"_mul",a.getLocal("itAux"),a.i32_add(a.getLocal("itIn"),a.i32_const(o)),r),...a.call(n+"_square",a.getLocal("itAux"),a.getLocal("itAux")),...a.call(n+"_mul",a.getLocal("itAux"),a.getLocal("itIn"),a.getLocal("itOut")),...a.call(n+"_mul",a.getLocal("itAux"),r,a.i32_add(a.getLocal("itOut"),a.i32_const(o)))]),a.setLocal("itIn",a.i32_add(a.getLocal("itIn"),a.i32_const(3*o))),a.setLocal("itOut",a.i32_add(a.getLocal("itOut"),a.i32_const(2*o))),a.setLocal("itAux",a.i32_add(a.getLocal("itAux"),a.i32_const(o))),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(1))),a.br(0))),a.i32_store(a.i32_const(0),a.getLocal("pAux")))}(),function(){const i=t.addFunction(e+"_normalize");i.addParam("p1","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder(),r=a.getLocal("p1"),s=a.i32_add(a.getLocal("p1"),a.i32_const(o)),c=a.i32_add(a.getLocal("p1"),a.i32_const(2*o)),l=a.getLocal("pr"),d=a.i32_add(a.getLocal("pr"),a.i32_const(o)),u=a.i32_add(a.getLocal("pr"),a.i32_const(2*o)),g=a.i32_const(t.alloc(o)),f=a.i32_const(t.alloc(o)),h=a.i32_const(t.alloc(o));i.addCode(a.if(a.call(e+"_isZero",a.getLocal("p1")),a.call(e+"_zero",a.getLocal("pr")),[...a.call(n+"_inverse",c,g),...a.call(n+"_square",g,f),...a.call(n+"_mul",g,f,h),...a.call(n+"_mul",r,f,l),...a.call(n+"_mul",s,h,d),...a.call(n+"_one",u)]))}(),function(){const n=t.addFunction(e+"__reverseBytes");n.addParam("pIn","i32"),n.addParam("n","i32"),n.addParam("pOut","i32"),n.addLocal("itOut","i32"),n.addLocal("itIn","i32");const i=n.getCodeBuilder();n.addCode(i.setLocal("itOut",i.i32_sub(i.i32_add(i.getLocal("pOut"),i.getLocal("n")),i.i32_const(1))),i.setLocal("itIn",i.getLocal("pIn")),i.block(i.loop(i.br_if(1,i.i32_lt_s(i.getLocal("itOut"),i.getLocal("pOut"))),i.i32_store8(i.getLocal("itOut"),i.i32_load8_u(i.getLocal("itIn"))),i.setLocal("itOut",i.i32_sub(i.getLocal("itOut"),i.i32_const(1))),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(1))),i.br(0))))}(),function(){const n=t.addFunction(e+"_LEMtoU");n.addParam("pIn","i32"),n.addParam("pOut","i32");const i=n.getCodeBuilder(),a=t.alloc(2*o),r=i.i32_const(a),s=i.i32_const(a),c=i.i32_const(a+o);n.addCode(i.if(i.call(e+"_isZeroAffine",i.getLocal("pIn")),[...i.call(e+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(e+"_fromMontgomeryAffine",i.getLocal("pIn"),r),i.call(e+"__reverseBytes",s,i.i32_const(o),i.getLocal("pOut")),i.call(e+"__reverseBytes",c,i.i32_const(o),i.i32_add(i.getLocal("pOut"),i.i32_const(o))))}(),function(){const i=t.addFunction(e+"_LEMtoC");i.addParam("pIn","i32"),i.addParam("pOut","i32");const a=i.getCodeBuilder(),r=a.i32_const(t.alloc(o));i.addCode(a.if(a.call(e+"_isZeroAffine",a.getLocal("pIn")),[...a.call(n+"_zero",a.getLocal("pOut")),...a.i32_store8(a.getLocal("pOut"),a.i32_const(64)),...a.ret([])]),a.call(n+"_fromMontgomery",a.getLocal("pIn"),r),a.call(e+"__reverseBytes",r,a.i32_const(o),a.getLocal("pOut")),a.if(a.i32_eq(a.call(n+"_sign",a.i32_add(a.getLocal("pIn"),a.i32_const(o))),a.i32_const(-1)),a.i32_store8(a.getLocal("pOut"),a.i32_or(a.i32_load8_u(a.getLocal("pOut")),a.i32_const(128)))))}(),function(){const n=t.addFunction(e+"_UtoLEM");n.addParam("pIn","i32"),n.addParam("pOut","i32");const i=n.getCodeBuilder(),a=t.alloc(2*o),r=i.i32_const(a),s=i.i32_const(a),c=i.i32_const(a+o);n.addCode(i.if(i.i32_and(i.i32_load8_u(i.getLocal("pIn")),i.i32_const(64)),[...i.call(e+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(e+"__reverseBytes",i.getLocal("pIn"),i.i32_const(o),s),i.call(e+"__reverseBytes",i.i32_add(i.getLocal("pIn"),i.i32_const(o)),i.i32_const(o),c),i.call(e+"_toMontgomeryAffine",r,i.getLocal("pOut")))}(),function(){const a=t.addFunction(e+"_CtoLEM");a.addParam("pIn","i32"),a.addParam("pOut","i32"),a.addLocal("firstByte","i32"),a.addLocal("greatest","i32");const r=a.getCodeBuilder(),s=t.alloc(2*o),c=r.i32_const(s),l=r.i32_const(s+o);a.addCode(r.setLocal("firstByte",r.i32_load8_u(r.getLocal("pIn"))),r.if(r.i32_and(r.getLocal("firstByte"),r.i32_const(64)),[...r.call(e+"_zeroAffine",r.getLocal("pOut")),...r.ret([])]),r.setLocal("greatest",r.i32_and(r.getLocal("firstByte"),r.i32_const(128))),r.call(n+"_copy",r.getLocal("pIn"),l),r.i32_store8(l,r.i32_and(r.getLocal("firstByte"),r.i32_const(63))),r.call(e+"__reverseBytes",l,r.i32_const(o),c),r.call(n+"_toMontgomery",c,r.getLocal("pOut")),r.call(n+"_square",r.getLocal("pOut"),l),r.call(n+"_mul",r.getLocal("pOut"),l,l),r.call(n+"_add",l,r.i32_const(i),l),r.call(n+"_sqrt",l,l),r.call(n+"_neg",l,c),r.if(r.i32_eq(r.call(n+"_sign",l),r.i32_const(-1)),r.if(r.getLocal("greatest"),r.call(n+"_copy",l,r.i32_add(r.getLocal("pOut"),r.i32_const(o))),r.call(n+"_neg",l,r.i32_add(r.getLocal("pOut"),r.i32_const(o)))),r.if(r.getLocal("greatest"),r.call(n+"_neg",l,r.i32_add(r.getLocal("pOut"),r.i32_const(o))),r.call(n+"_copy",l,r.i32_add(r.getLocal("pOut"),r.i32_const(o))))))}(),Qt(t,e+"_batchLEMtoU",e+"_LEMtoU",2*o,2*o),Qt(t,e+"_batchLEMtoC",e+"_LEMtoC",2*o,o),Qt(t,e+"_batchUtoLEM",e+"_UtoLEM",2*o,2*o),Qt(t,e+"_batchCtoLEM",e+"_CtoLEM",o,2*o,!0),Qt(t,e+"_batchToJacobian",e+"_toJacobian",2*o,3*o,!0),kt(t,e,e+"_multiexp",e+"_add",3*o),kt(t,e,e+"_multiexpAffine",e+"_addMixed",2*o),Ut(t,e+"_timesScalar",3*o,e+"_add",e+"_double",e+"_sub",e+"_copy",e+"_zero"),Ut(t,e+"_timesScalarAffine",2*o,e+"_addMixed",e+"_double",e+"_subMixed",e+"_copyAffine",e+"_zero"),t.exportFunction(e+"_isZero"),t.exportFunction(e+"_isZeroAffine"),t.exportFunction(e+"_eq"),t.exportFunction(e+"_eqMixed"),t.exportFunction(e+"_eqAffine"),t.exportFunction(e+"_copy"),t.exportFunction(e+"_copyAffine"),t.exportFunction(e+"_zero"),t.exportFunction(e+"_zeroAffine"),t.exportFunction(e+"_double"),t.exportFunction(e+"_doubleAffine"),t.exportFunction(e+"_add"),t.exportFunction(e+"_addMixed"),t.exportFunction(e+"_addAffine"),t.exportFunction(e+"_neg"),t.exportFunction(e+"_negAffine"),t.exportFunction(e+"_sub"),t.exportFunction(e+"_subMixed"),t.exportFunction(e+"_subAffine"),t.exportFunction(e+"_fromMontgomery"),t.exportFunction(e+"_fromMontgomeryAffine"),t.exportFunction(e+"_toMontgomery"),t.exportFunction(e+"_toMontgomeryAffine"),t.exportFunction(e+"_timesScalar"),t.exportFunction(e+"_timesScalarAffine"),t.exportFunction(e+"_normalize"),t.exportFunction(e+"_LEMtoU"),t.exportFunction(e+"_LEMtoC"),t.exportFunction(e+"_UtoLEM"),t.exportFunction(e+"_CtoLEM"),t.exportFunction(e+"_batchLEMtoU"),t.exportFunction(e+"_batchLEMtoC"),t.exportFunction(e+"_batchUtoLEM"),t.exportFunction(e+"_batchCtoLEM"),t.exportFunction(e+"_toAffine"),t.exportFunction(e+"_toJacobian"),t.exportFunction(e+"_batchToAffine"),t.exportFunction(e+"_batchToJacobian"),t.exportFunction(e+"_inCurve"),t.exportFunction(e+"_inCurveAffine")),e};const{isOdd:Nt,modInv:qt,modPow:Mt}=W,Dt=H;var Rt=function(t,e,n,i,a){const o=8*t.modules[i].n64,r=8*t.modules[n].n64,s=t.modules[i].q;let c=s-1n,l=0;for(;!Nt(c);)l++,c>>=1n;let d=2n;for(;1n===Mt(d,s>>1n,s);)d+=1n;const u=new Array(l+1);u[l]=Mt(d,c,s);let g=l-1;for(;g>=0;)u[g]=Mt(u[g+1],2n,s),g--;const f=[],h=(1n<<BigInt(8*o))%s;for(let t=0;t<u.length;t++){const e=u[t]*h%s;f.push(...Dt.bigInt2BytesLE(e,o))}const _=t.alloc(f),p=new Array(l+1);p[0]=1n;for(let t=1;t<=l;t++)p[t]=2n*p[t-1];const m=[];for(let t=0;t<=l;t++){const e=qt(p[t],s)*h%s;m.push(...Dt.bigInt2BytesLE(e,o))}const L=t.alloc(m),y=Mt(d,2n,s),A=[],b=[];for(let t=0;t<=l;t++){const e=Mt(y,2n**BigInt(t),s),n=qt(s+1n-e,s);A.push(...Dt.bigInt2BytesLE(e*h%s,o)),b.push(...Dt.bigInt2BytesLE(n*h%s,o))}const I=t.alloc(A),w=t.alloc(b);function C(t){let e=0;for(let n=0;n<8;n++)t&1<<n&&(e|=128>>n);return e}const x=Array(256);for(let t=0;t<256;t++)x[t]=C(t);const E=t.alloc(x);!function(){const n=t.addFunction(e+"__rev");n.addParam("x","i32"),n.addParam("bits","i32"),n.setReturnType("i32");const i=n.getCodeBuilder();n.addCode(i.i32_rotl(i.i32_add(i.i32_add(i.i32_shl(i.i32_load8_u(i.i32_and(i.getLocal("x"),i.i32_const(255)),E,0),i.i32_const(24)),i.i32_shl(i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(8)),i.i32_const(255)),E,0),i.i32_const(16))),i.i32_add(i.i32_shl(i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(16)),i.i32_const(255)),E,0),i.i32_const(8)),i.i32_load8_u(i.i32_and(i.i32_shr_u(i.getLocal("x"),i.i32_const(24)),i.i32_const(255)),E,0))),i.getLocal("bits")))}(),function(){const i=t.addFunction(e+"__reversePermutation");i.addParam("px","i32"),i.addParam("bits","i32"),i.addLocal("n","i32"),i.addLocal("i","i32"),i.addLocal("ri","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32");const a=i.getCodeBuilder(),o=a.i32_const(t.alloc(r));i.addCode(a.setLocal("n",a.i32_shl(a.i32_const(1),a.getLocal("bits"))),a.setLocal("i",a.i32_const(0)),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("i"),a.getLocal("n"))),a.setLocal("idx1",a.i32_add(a.getLocal("px"),a.i32_mul(a.getLocal("i"),a.i32_const(r)))),a.setLocal("ri",a.call(e+"__rev",a.getLocal("i"),a.getLocal("bits"))),a.setLocal("idx2",a.i32_add(a.getLocal("px"),a.i32_mul(a.getLocal("ri"),a.i32_const(r)))),a.if(a.i32_lt_u(a.getLocal("i"),a.getLocal("ri")),[...a.call(n+"_copy",a.getLocal("idx1"),o),...a.call(n+"_copy",a.getLocal("idx2"),a.getLocal("idx1")),...a.call(n+"_copy",o,a.getLocal("idx2"))]),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(1))),a.br(0))))}(),function(){const o=t.addFunction(e+"__fftFinal");o.addParam("px","i32"),o.addParam("bits","i32"),o.addParam("reverse","i32"),o.addParam("mulFactor","i32"),o.addLocal("n","i32"),o.addLocal("ndiv2","i32"),o.addLocal("pInv2","i32"),o.addLocal("i","i32"),o.addLocal("mask","i32"),o.addLocal("idx1","i32"),o.addLocal("idx2","i32");const s=o.getCodeBuilder(),c=s.i32_const(t.alloc(r));o.addCode(s.if(s.i32_and(s.i32_eqz(s.getLocal("reverse")),s.call(i+"_isOne",s.getLocal("mulFactor"))),s.ret([])),s.setLocal("n",s.i32_shl(s.i32_const(1),s.getLocal("bits"))),s.setLocal("mask",s.i32_sub(s.getLocal("n"),s.i32_const(1))),s.setLocal("i",s.i32_const(1)),s.setLocal("ndiv2",s.i32_shr_u(s.getLocal("n"),s.i32_const(1))),s.block(s.loop(s.br_if(1,s.i32_ge_u(s.getLocal("i"),s.getLocal("ndiv2"))),s.setLocal("idx1",s.i32_add(s.getLocal("px"),s.i32_mul(s.getLocal("i"),s.i32_const(r)))),s.setLocal("idx2",s.i32_add(s.getLocal("px"),s.i32_mul(s.i32_sub(s.getLocal("n"),s.getLocal("i")),s.i32_const(r)))),s.if(s.getLocal("reverse"),s.if(s.call(i+"_isOne",s.getLocal("mulFactor")),[...s.call(n+"_copy",s.getLocal("idx1"),c),...s.call(n+"_copy",s.getLocal("idx2"),s.getLocal("idx1")),...s.call(n+"_copy",c,s.getLocal("idx2"))],[...s.call(n+"_copy",s.getLocal("idx1"),c),...s.call(a,s.getLocal("idx2"),s.getLocal("mulFactor"),s.getLocal("idx1")),...s.call(a,c,s.getLocal("mulFactor"),s.getLocal("idx2"))]),s.if(s.call(i+"_isOne",s.getLocal("mulFactor")),[],[...s.call(a,s.getLocal("idx1"),s.getLocal("mulFactor"),s.getLocal("idx1")),...s.call(a,s.getLocal("idx2"),s.getLocal("mulFactor"),s.getLocal("idx2"))])),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))),s.if(s.call(i+"_isOne",s.getLocal("mulFactor")),[],[...s.call(a,s.getLocal("px"),s.getLocal("mulFactor"),s.getLocal("px")),...s.setLocal("idx2",s.i32_add(s.getLocal("px"),s.i32_mul(s.getLocal("ndiv2"),s.i32_const(r)))),...s.call(a,s.getLocal("idx2"),s.getLocal("mulFactor"),s.getLocal("idx2"))]))}(),function(){const s=t.addFunction(e+"_rawfft");s.addParam("px","i32"),s.addParam("bits","i32"),s.addParam("reverse","i32"),s.addParam("mulFactor","i32"),s.addLocal("s","i32"),s.addLocal("k","i32"),s.addLocal("j","i32"),s.addLocal("m","i32"),s.addLocal("mdiv2","i32"),s.addLocal("n","i32"),s.addLocal("pwm","i32"),s.addLocal("idx1","i32"),s.addLocal("idx2","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(o)),d=c.i32_const(t.alloc(r)),u=c.i32_const(t.alloc(r));s.addCode(c.call(e+"__reversePermutation",c.getLocal("px"),c.getLocal("bits")),c.setLocal("n",c.i32_shl(c.i32_const(1),c.getLocal("bits"))),c.setLocal("s",c.i32_const(1)),c.block(c.loop(c.br_if(1,c.i32_gt_u(c.getLocal("s"),c.getLocal("bits"))),c.setLocal("m",c.i32_shl(c.i32_const(1),c.getLocal("s"))),c.setLocal("pwm",c.i32_add(c.i32_const(_),c.i32_mul(c.getLocal("s"),c.i32_const(o)))),c.setLocal("k",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("k"),c.getLocal("n"))),c.call(i+"_one",l),c.setLocal("mdiv2",c.i32_shr_u(c.getLocal("m"),c.i32_const(1))),c.setLocal("j",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("j"),c.getLocal("mdiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("px"),c.i32_mul(c.i32_add(c.getLocal("k"),c.getLocal("j")),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("idx1"),c.i32_mul(c.getLocal("mdiv2"),c.i32_const(r)))),c.call(a,c.getLocal("idx2"),l,d),c.call(n+"_copy",c.getLocal("idx1"),u),c.call(n+"_add",u,d,c.getLocal("idx1")),c.call(n+"_sub",u,d,c.getLocal("idx2")),c.call(i+"_mul",l,c.getLocal("pwm"),l),c.setLocal("j",c.i32_add(c.getLocal("j"),c.i32_const(1))),c.br(0))),c.setLocal("k",c.i32_add(c.getLocal("k"),c.getLocal("m"))),c.br(0))),c.setLocal("s",c.i32_add(c.getLocal("s"),c.i32_const(1))),c.br(0))),c.call(e+"__fftFinal",c.getLocal("px"),c.getLocal("bits"),c.getLocal("reverse"),c.getLocal("mulFactor")))}(),function(){const n=t.addFunction(e+"__log2");n.addParam("n","i32"),n.setReturnType("i32"),n.addLocal("bits","i32"),n.addLocal("aux","i32");const i=n.getCodeBuilder();n.addCode(i.setLocal("aux",i.i32_shr_u(i.getLocal("n"),i.i32_const(1)))),n.addCode(i.setLocal("bits",i.i32_const(0))),n.addCode(i.block(i.loop(i.br_if(1,i.i32_eqz(i.getLocal("aux"))),i.setLocal("aux",i.i32_shr_u(i.getLocal("aux"),i.i32_const(1))),i.setLocal("bits",i.i32_add(i.getLocal("bits"),i.i32_const(1))),i.br(0)))),n.addCode(i.if(i.i32_ne(i.getLocal("n"),i.i32_shl(i.i32_const(1),i.getLocal("bits"))),i.unreachable())),n.addCode(i.if(i.i32_gt_u(i.getLocal("bits"),i.i32_const(l)),i.unreachable())),n.addCode(i.getLocal("bits"))}(),function(){const n=t.addFunction(e+"_fft");n.addParam("px","i32"),n.addParam("n","i32"),n.addLocal("bits","i32");const a=n.getCodeBuilder(),r=a.i32_const(t.alloc(o));n.addCode(a.setLocal("bits",a.call(e+"__log2",a.getLocal("n"))),a.call(i+"_one",r),a.call(e+"_rawfft",a.getLocal("px"),a.getLocal("bits"),a.i32_const(0),r))}(),function(){const n=t.addFunction(e+"_ifft");n.addParam("px","i32"),n.addParam("n","i32"),n.addLocal("bits","i32"),n.addLocal("pInv2","i32");const i=n.getCodeBuilder();n.addCode(i.setLocal("bits",i.call(e+"__log2",i.getLocal("n"))),i.setLocal("pInv2",i.i32_add(i.i32_const(L),i.i32_mul(i.getLocal("bits"),i.i32_const(o)))),i.call(e+"_rawfft",i.getLocal("px"),i.getLocal("bits"),i.i32_const(1),i.getLocal("pInv2")))}(),function(){const s=t.addFunction(e+"_fftJoin");s.addParam("pBuff1","i32"),s.addParam("pBuff2","i32"),s.addParam("n","i32"),s.addParam("first","i32"),s.addParam("inc","i32"),s.addLocal("idx1","i32"),s.addLocal("idx2","i32"),s.addLocal("i","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(o)),d=c.i32_const(t.alloc(r)),u=c.i32_const(t.alloc(r));s.addCode(c.call(i+"_copy",c.getLocal("first"),l),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.call(a,c.getLocal("idx2"),l,d),c.call(n+"_copy",c.getLocal("idx1"),u),c.call(n+"_add",u,d,c.getLocal("idx1")),c.call(n+"_sub",u,d,c.getLocal("idx2")),c.call(i+"_mul",l,c.getLocal("inc"),l),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),function(){const s=t.addFunction(e+"_fftJoinExt");s.addParam("pBuff1","i32"),s.addParam("pBuff2","i32"),s.addParam("n","i32"),s.addParam("first","i32"),s.addParam("inc","i32"),s.addParam("totalBits","i32"),s.addLocal("idx1","i32"),s.addLocal("idx2","i32"),s.addLocal("i","i32"),s.addLocal("pShiftToM","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(o)),d=c.i32_const(t.alloc(r));s.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(I),c.i32_mul(c.getLocal("totalBits"),c.i32_const(o)))),c.call(i+"_copy",c.getLocal("first"),l),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.call(n+"_add",c.getLocal("idx1"),c.getLocal("idx2"),d),c.call(a,c.getLocal("idx2"),c.getLocal("pShiftToM"),c.getLocal("idx2")),c.call(n+"_add",c.getLocal("idx1"),c.getLocal("idx2"),c.getLocal("idx2")),c.call(a,c.getLocal("idx2"),l,c.getLocal("idx2")),c.call(n+"_copy",d,c.getLocal("idx1")),c.call(i+"_mul",l,c.getLocal("inc"),l),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),function(){const s=t.addFunction(e+"_fftJoinExtInv");s.addParam("pBuff1","i32"),s.addParam("pBuff2","i32"),s.addParam("n","i32"),s.addParam("first","i32"),s.addParam("inc","i32"),s.addParam("totalBits","i32"),s.addLocal("idx1","i32"),s.addLocal("idx2","i32"),s.addLocal("i","i32"),s.addLocal("pShiftToM","i32"),s.addLocal("pSConst","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(o)),d=c.i32_const(t.alloc(r));s.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(I),c.i32_mul(c.getLocal("totalBits"),c.i32_const(o)))),c.setLocal("pSConst",c.i32_add(c.i32_const(w),c.i32_mul(c.getLocal("totalBits"),c.i32_const(o)))),c.call(i+"_copy",c.getLocal("first"),l),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.call(a,c.getLocal("idx2"),l,d),c.call(n+"_sub",c.getLocal("idx1"),d,c.getLocal("idx2")),c.call(a,c.getLocal("idx2"),c.getLocal("pSConst"),c.getLocal("idx2")),c.call(a,c.getLocal("idx1"),c.getLocal("pShiftToM"),c.getLocal("idx1")),c.call(n+"_sub",d,c.getLocal("idx1"),c.getLocal("idx1")),c.call(a,c.getLocal("idx1"),c.getLocal("pSConst"),c.getLocal("idx1")),c.call(i+"_mul",l,c.getLocal("inc"),l),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),function(){const s=t.addFunction(e+"_fftMix");s.addParam("pBuff","i32"),s.addParam("n","i32"),s.addParam("exp","i32"),s.addLocal("nGroups","i32"),s.addLocal("nPerGroup","i32"),s.addLocal("nPerGroupDiv2","i32"),s.addLocal("pairOffset","i32"),s.addLocal("idx1","i32"),s.addLocal("idx2","i32"),s.addLocal("i","i32"),s.addLocal("j","i32"),s.addLocal("pwm","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(o)),d=c.i32_const(t.alloc(r)),u=c.i32_const(t.alloc(r));s.addCode(c.setLocal("nPerGroup",c.i32_shl(c.i32_const(1),c.getLocal("exp"))),c.setLocal("nPerGroupDiv2",c.i32_shr_u(c.getLocal("nPerGroup"),c.i32_const(1))),c.setLocal("nGroups",c.i32_shr_u(c.getLocal("n"),c.getLocal("exp"))),c.setLocal("pairOffset",c.i32_mul(c.getLocal("nPerGroupDiv2"),c.i32_const(r))),c.setLocal("pwm",c.i32_add(c.i32_const(_),c.i32_mul(c.getLocal("exp"),c.i32_const(o)))),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("nGroups"))),c.call(i+"_one",l),c.setLocal("j",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("j"),c.getLocal("nPerGroupDiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff"),c.i32_mul(c.i32_add(c.i32_mul(c.getLocal("i"),c.getLocal("nPerGroup")),c.getLocal("j")),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("idx1"),c.getLocal("pairOffset"))),c.call(a,c.getLocal("idx2"),l,d),c.call(n+"_copy",c.getLocal("idx1"),u),c.call(n+"_add",u,d,c.getLocal("idx1")),c.call(n+"_sub",u,d,c.getLocal("idx2")),c.call(i+"_mul",l,c.getLocal("pwm"),l),c.setLocal("j",c.i32_add(c.getLocal("j"),c.i32_const(1))),c.br(0))),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),function(){const i=t.addFunction(e+"_fftFinal");i.addParam("pBuff","i32"),i.addParam("n","i32"),i.addParam("factor","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32"),i.addLocal("ndiv2","i32");const o=i.getCodeBuilder(),s=o.i32_const(t.alloc(r));i.addCode(o.setLocal("ndiv2",o.i32_shr_u(o.getLocal("n"),o.i32_const(1))),o.if(o.i32_and(o.getLocal("n"),o.i32_const(1)),o.call(a,o.i32_add(o.getLocal("pBuff"),o.i32_mul(o.getLocal("ndiv2"),o.i32_const(r))),o.getLocal("factor"),o.i32_add(o.getLocal("pBuff"),o.i32_mul(o.getLocal("ndiv2"),o.i32_const(r))))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_ge_u(o.getLocal("i"),o.getLocal("ndiv2"))),o.setLocal("idx1",o.i32_add(o.getLocal("pBuff"),o.i32_mul(o.getLocal("i"),o.i32_const(r)))),o.setLocal("idx2",o.i32_add(o.getLocal("pBuff"),o.i32_mul(o.i32_sub(o.i32_sub(o.getLocal("n"),o.i32_const(1)),o.getLocal("i")),o.i32_const(r)))),o.call(a,o.getLocal("idx2"),o.getLocal("factor"),s),o.call(a,o.getLocal("idx1"),o.getLocal("factor"),o.getLocal("idx2")),o.call(n+"_copy",s,o.getLocal("idx1")),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),function(){const s=t.addFunction(e+"_prepareLagrangeEvaluation");s.addParam("pBuff1","i32"),s.addParam("pBuff2","i32"),s.addParam("n","i32"),s.addParam("first","i32"),s.addParam("inc","i32"),s.addParam("totalBits","i32"),s.addLocal("idx1","i32"),s.addLocal("idx2","i32"),s.addLocal("i","i32"),s.addLocal("pShiftToM","i32"),s.addLocal("pSConst","i32");const c=s.getCodeBuilder(),l=c.i32_const(t.alloc(o)),d=c.i32_const(t.alloc(r));s.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(I),c.i32_mul(c.getLocal("totalBits"),c.i32_const(o)))),c.setLocal("pSConst",c.i32_add(c.i32_const(w),c.i32_mul(c.getLocal("totalBits"),c.i32_const(o)))),c.call(i+"_copy",c.getLocal("first"),l),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(r)))),c.call(a,c.getLocal("idx1"),c.getLocal("pShiftToM"),d),c.call(n+"_sub",c.getLocal("idx2"),d,d),c.call(n+"_sub",c.getLocal("idx1"),c.getLocal("idx2"),c.getLocal("idx2")),c.call(a,d,c.getLocal("pSConst"),c.getLocal("idx1")),c.call(a,c.getLocal("idx2"),l,c.getLocal("idx2")),c.call(i+"_mul",l,c.getLocal("inc"),l),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}(),t.exportFunction(e+"_fft"),t.exportFunction(e+"_ifft"),t.exportFunction(e+"_rawfft"),t.exportFunction(e+"_fftJoin"),t.exportFunction(e+"_fftJoinExt"),t.exportFunction(e+"_fftJoinExtInv"),t.exportFunction(e+"_fftMix"),t.exportFunction(e+"_fftFinal"),t.exportFunction(e+"_prepareLagrangeEvaluation")},zt=function(t,e,n){const i=8*t.modules[n].n64;return function(){const a=t.addFunction(e+"_zero");a.addParam("px","i32"),a.addParam("n","i32"),a.addLocal("lastp","i32"),a.addLocal("p","i32");const o=a.getCodeBuilder();a.addCode(o.setLocal("p",o.getLocal("px")),o.setLocal("lastp",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("n"),o.i32_const(i)))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("p"),o.getLocal("lastp"))),o.call(n+"_zero",o.getLocal("p")),o.setLocal("p",o.i32_add(o.getLocal("p"),o.i32_const(i))),o.br(0))))}(),function(){const a=t.addFunction(e+"_constructLC");a.addParam("ppolynomials","i32"),a.addParam("psignals","i32"),a.addParam("nSignals","i32"),a.addParam("pres","i32"),a.addLocal("i","i32"),a.addLocal("j","i32"),a.addLocal("pp","i32"),a.addLocal("ps","i32"),a.addLocal("pd","i32"),a.addLocal("ncoefs","i32");const o=a.getCodeBuilder(),r=o.i32_const(t.alloc(i));a.addCode(o.setLocal("i",o.i32_const(0)),o.setLocal("pp",o.getLocal("ppolynomials")),o.setLocal("ps",o.getLocal("psignals")),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("nSignals"))),o.setLocal("ncoefs",o.i32_load(o.getLocal("pp"))),o.setLocal("pp",o.i32_add(o.getLocal("pp"),o.i32_const(4))),o.setLocal("j",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("j"),o.getLocal("ncoefs"))),o.setLocal("pd",o.i32_add(o.getLocal("pres"),o.i32_mul(o.i32_load(o.getLocal("pp")),o.i32_const(i)))),o.setLocal("pp",o.i32_add(o.getLocal("pp"),o.i32_const(4))),o.call(n+"_mul",o.getLocal("ps"),o.getLocal("pp"),r),o.call(n+"_add",r,o.getLocal("pd"),o.getLocal("pd")),o.setLocal("pp",o.i32_add(o.getLocal("pp"),o.i32_const(i))),o.setLocal("j",o.i32_add(o.getLocal("j"),o.i32_const(1))),o.br(0))),o.setLocal("ps",o.i32_add(o.getLocal("ps"),o.i32_const(i))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),t.exportFunction(e+"_zero"),t.exportFunction(e+"_constructLC"),e},Gt=function(t,e,n){const i=8*t.modules[n].n64;return function(){const a=t.addFunction(e+"_buildABC");a.addParam("pCoefs","i32"),a.addParam("nCoefs","i32"),a.addParam("pWitness","i32"),a.addParam("pA","i32"),a.addParam("pB","i32"),a.addParam("pC","i32"),a.addParam("offsetOut","i32"),a.addParam("nOut","i32"),a.addParam("offsetWitness","i32"),a.addParam("nWitness","i32"),a.addLocal("it","i32"),a.addLocal("ita","i32"),a.addLocal("itb","i32"),a.addLocal("last","i32"),a.addLocal("m","i32"),a.addLocal("c","i32"),a.addLocal("s","i32"),a.addLocal("pOut","i32");const o=a.getCodeBuilder(),r=o.i32_const(t.alloc(i));a.addCode(o.setLocal("ita",o.getLocal("pA")),o.setLocal("itb",o.getLocal("pB")),o.setLocal("last",o.i32_add(o.getLocal("pA"),o.i32_mul(o.getLocal("nOut"),o.i32_const(i)))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("ita"),o.getLocal("last"))),o.call(n+"_zero",o.getLocal("ita")),o.call(n+"_zero",o.getLocal("itb")),o.setLocal("ita",o.i32_add(o.getLocal("ita"),o.i32_const(i))),o.setLocal("itb",o.i32_add(o.getLocal("itb"),o.i32_const(i))),o.br(0))),o.setLocal("it",o.getLocal("pCoefs")),o.setLocal("last",o.i32_add(o.getLocal("pCoefs"),o.i32_mul(o.getLocal("nCoefs"),o.i32_const(i+12)))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("it"),o.getLocal("last"))),o.setLocal("s",o.i32_load(o.getLocal("it"),8)),o.if(o.i32_or(o.i32_lt_u(o.getLocal("s"),o.getLocal("offsetWitness")),o.i32_ge_u(o.getLocal("s"),o.i32_add(o.getLocal("offsetWitness"),o.getLocal("nWitness")))),[...o.setLocal("it",o.i32_add(o.getLocal("it"),o.i32_const(i+12))),...o.br(1)]),o.setLocal("m",o.i32_load(o.getLocal("it"))),o.if(o.i32_eq(o.getLocal("m"),o.i32_const(0)),o.setLocal("pOut",o.getLocal("pA")),o.if(o.i32_eq(o.getLocal("m"),o.i32_const(1)),o.setLocal("pOut",o.getLocal("pB")),[...o.setLocal("it",o.i32_add(o.getLocal("it"),o.i32_const(i+12))),...o.br(1)])),o.setLocal("c",o.i32_load(o.getLocal("it"),4)),o.if(o.i32_or(o.i32_lt_u(o.getLocal("c"),o.getLocal("offsetOut")),o.i32_ge_u(o.getLocal("c"),o.i32_add(o.getLocal("offsetOut"),o.getLocal("nOut")))),[...o.setLocal("it",o.i32_add(o.getLocal("it"),o.i32_const(i+12))),...o.br(1)]),o.setLocal("pOut",o.i32_add(o.getLocal("pOut"),o.i32_mul(o.i32_sub(o.getLocal("c"),o.getLocal("offsetOut")),o.i32_const(i)))),o.call(n+"_mul",o.i32_add(o.getLocal("pWitness"),o.i32_mul(o.i32_sub(o.getLocal("s"),o.getLocal("offsetWitness")),o.i32_const(i))),o.i32_add(o.getLocal("it"),o.i32_const(12)),r),o.call(n+"_add",o.getLocal("pOut"),r,o.getLocal("pOut")),o.setLocal("it",o.i32_add(o.getLocal("it"),o.i32_const(i+12))),o.br(0))),o.setLocal("ita",o.getLocal("pA")),o.setLocal("itb",o.getLocal("pB")),o.setLocal("it",o.getLocal("pC")),o.setLocal("last",o.i32_add(o.getLocal("pA"),o.i32_mul(o.getLocal("nOut"),o.i32_const(i)))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("ita"),o.getLocal("last"))),o.call(n+"_mul",o.getLocal("ita"),o.getLocal("itb"),o.getLocal("it")),o.setLocal("ita",o.i32_add(o.getLocal("ita"),o.i32_const(i))),o.setLocal("itb",o.i32_add(o.getLocal("itb"),o.i32_const(i))),o.setLocal("it",o.i32_add(o.getLocal("it"),o.i32_const(i))),o.br(0))))}(),function(){const a=t.addFunction(e+"_joinABC");a.addParam("pA","i32"),a.addParam("pB","i32"),a.addParam("pC","i32"),a.addParam("n","i32"),a.addParam("pP","i32"),a.addLocal("ita","i32"),a.addLocal("itb","i32"),a.addLocal("itc","i32"),a.addLocal("itp","i32"),a.addLocal("last","i32");const o=a.getCodeBuilder(),r=o.i32_const(t.alloc(i));a.addCode(o.setLocal("ita",o.getLocal("pA")),o.setLocal("itb",o.getLocal("pB")),o.setLocal("itc",o.getLocal("pC")),o.setLocal("itp",o.getLocal("pP")),o.setLocal("last",o.i32_add(o.getLocal("pA"),o.i32_mul(o.getLocal("n"),o.i32_const(i)))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("ita"),o.getLocal("last"))),o.call(n+"_mul",o.getLocal("ita"),o.getLocal("itb"),r),o.call(n+"_sub",r,o.getLocal("itc"),o.getLocal("itp")),o.setLocal("ita",o.i32_add(o.getLocal("ita"),o.i32_const(i))),o.setLocal("itb",o.i32_add(o.getLocal("itb"),o.i32_const(i))),o.setLocal("itc",o.i32_add(o.getLocal("itc"),o.i32_const(i))),o.setLocal("itp",o.i32_add(o.getLocal("itp"),o.i32_const(i))),o.br(0))))}(),function(){const a=t.addFunction(e+"_batchAdd");a.addParam("pa","i32"),a.addParam("pb","i32"),a.addParam("n","i32"),a.addParam("pr","i32"),a.addLocal("ita","i32"),a.addLocal("itb","i32"),a.addLocal("itr","i32"),a.addLocal("last","i32");const o=a.getCodeBuilder();a.addCode(o.setLocal("ita",o.getLocal("pa")),o.setLocal("itb",o.getLocal("pb")),o.setLocal("itr",o.getLocal("pr")),o.setLocal("last",o.i32_add(o.getLocal("pa"),o.i32_mul(o.getLocal("n"),o.i32_const(i)))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("ita"),o.getLocal("last"))),o.call(n+"_add",o.getLocal("ita"),o.getLocal("itb"),o.getLocal("itr")),o.setLocal("ita",o.i32_add(o.getLocal("ita"),o.i32_const(i))),o.setLocal("itb",o.i32_add(o.getLocal("itb"),o.i32_const(i))),o.setLocal("itr",o.i32_add(o.getLocal("itr"),o.i32_const(i))),o.br(0))))}(),t.exportFunction(e+"_buildABC"),t.exportFunction(e+"_joinABC"),t.exportFunction(e+"_batchAdd"),e},jt=function(t,e,n,i,a,o,r,s){const c=t.addFunction(e);c.addParam("pIn","i32"),c.addParam("n","i32"),c.addParam("pFirst","i32"),c.addParam("pInc","i32"),c.addParam("pOut","i32"),c.addLocal("pOldFree","i32"),c.addLocal("i","i32"),c.addLocal("pFrom","i32"),c.addLocal("pTo","i32");const l=c.getCodeBuilder(),d=l.i32_const(t.alloc(r));c.addCode(l.setLocal("pFrom",l.getLocal("pIn")),l.setLocal("pTo",l.getLocal("pOut"))),c.addCode(l.call(i+"_copy",l.getLocal("pFirst"),d)),c.addCode(l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.call(s,l.getLocal("pFrom"),d,l.getLocal("pTo")),l.setLocal("pFrom",l.i32_add(l.getLocal("pFrom"),l.i32_const(a))),l.setLocal("pTo",l.i32_add(l.getLocal("pTo"),l.i32_const(o))),l.call(i+"_mul",d,l.getLocal("pInc"),d),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0)))),t.exportFunction(e)};const Vt=H,Kt=It,Ht=xt,$t=vt,Yt=St,Jt=Tt,Wt=Rt,Zt=zt,Xt=Gt,te=jt,{bitLength:ee,modInv:ne,isOdd:ie,isNegative:ae}=W,oe=H,re=It,se=xt,ce=vt,le=St,de=Tt,ue=Rt,ge=zt,fe=Gt,he=jt,{bitLength:_e,isOdd:pe,isNegative:me}=W;var Le=function(t,e){const n=e||"bn128";if(t.modules[n])return n;const i=21888242871839275222246405745257275088696311157297823662689037894645226208583n,a=21888242871839275222246405745257275088548364400416034343698204186575808495617n,o=Math.floor((ee(i-1n)-1)/64)+1,r=8*o,s=r,c=r,l=2*c,d=12*c,u=t.alloc(Vt.bigInt2BytesLE(a,s)),g=Kt(t,i,"f1m");Ht(t,a,"fr","frm");const f=t.alloc(Vt.bigInt2BytesLE(y(3n),c)),h=Jt(t,"g1m","f1m",f);Wt(t,"frm","frm","frm","frm_mul"),Zt(t,"pol","frm"),Xt(t,"qap","frm");const _=$t(t,"f1m_neg","f2m","f1m"),p=t.alloc([...Vt.bigInt2BytesLE(y(19485874751759354771024239261021720505790618469301721065564631296452457478373n),c),...Vt.bigInt2BytesLE(y(266929791119991161246907387137283842545076965332900288569378510910307636690n),c)]),m=Jt(t,"g2m","f2m",p);function L(e,n){const i=t.addFunction(e);i.addParam("pG","i32"),i.addParam("pFr","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder(),o=a.i32_const(t.alloc(r));i.addCode(a.call("frm_fromMontgomery",a.getLocal("pFr"),o),a.call(n,a.getLocal("pG"),o,a.i32_const(r),a.getLocal("pr"))),t.exportFunction(e)}function y(t){return BigInt(t)*(1n<<BigInt(8*c))%i}L("g1m_timesFr","g1m_timesScalar"),Wt(t,"g1m","g1m","frm","g1m_timesFr"),L("g2m_timesFr","g2m_timesScalar"),Wt(t,"g2m","g2m","frm","g2m_timesFr"),L("g1m_timesFrAffine","g1m_timesScalarAffine"),L("g2m_timesFrAffine","g2m_timesScalarAffine"),te(t,"frm_batchApplyKey","fmr","frm",r,r,r,"frm_mul"),te(t,"g1m_batchApplyKey","g1m","frm",3*r,3*r,r,"g1m_timesFr"),te(t,"g1m_batchApplyKeyMixed","g1m","frm",2*r,3*r,r,"g1m_timesFrAffine"),te(t,"g2m_batchApplyKey","g2m","frm",2*r*3,3*r*2,r,"g2m_timesFr"),te(t,"g2m_batchApplyKeyMixed","g2m","frm",2*r*2,3*r*2,r,"g2m_timesFrAffine");const A=[1n,2n,1n],b=t.alloc([...Vt.bigInt2BytesLE(y(A[0]),c),...Vt.bigInt2BytesLE(y(A[1]),c),...Vt.bigInt2BytesLE(y(A[2]),c)]),I=[0n,1n,0n],w=t.alloc([...Vt.bigInt2BytesLE(y(I[0]),c),...Vt.bigInt2BytesLE(y(I[1]),c),...Vt.bigInt2BytesLE(y(I[2]),c)]),C=[[10857046999023057135944570762232829481370756359578518086990519993285655852781n,11559732032986387107991004021392285783925812861821192530917403151452391805634n],[8495653923123431417604973247489272438418190587263600148770280649306958101930n,4082367875863433681332203403145435568316851327593401208105741076214120093531n],[1n,0n]],x=t.alloc([...Vt.bigInt2BytesLE(y(C[0][0]),c),...Vt.bigInt2BytesLE(y(C[0][1]),c),...Vt.bigInt2BytesLE(y(C[1][0]),c),...Vt.bigInt2BytesLE(y(C[1][1]),c),...Vt.bigInt2BytesLE(y(C[2][0]),c),...Vt.bigInt2BytesLE(y(C[2][1]),c)]),E=[[0n,0n],[1n,0n],[0n,0n]],B=t.alloc([...Vt.bigInt2BytesLE(y(E[0][0]),c),...Vt.bigInt2BytesLE(y(E[0][1]),c),...Vt.bigInt2BytesLE(y(E[1][0]),c),...Vt.bigInt2BytesLE(y(E[1][1]),c),...Vt.bigInt2BytesLE(y(E[2][0]),c),...Vt.bigInt2BytesLE(y(E[2][1]),c)]),F=t.alloc([...Vt.bigInt2BytesLE(y(1),c),...Vt.bigInt2BytesLE(y(0),c),...Vt.bigInt2BytesLE(y(0),c),...Vt.bigInt2BytesLE(y(0),c),...Vt.bigInt2BytesLE(y(0),c),...Vt.bigInt2BytesLE(y(0),c),...Vt.bigInt2BytesLE(y(0),c),...Vt.bigInt2BytesLE(y(0),c),...Vt.bigInt2BytesLE(y(0),c),...Vt.bigInt2BytesLE(y(0),c),...Vt.bigInt2BytesLE(y(0),c),...Vt.bigInt2BytesLE(y(0),c)]),v=t.alloc([...Vt.bigInt2BytesLE(y(9),c),...Vt.bigInt2BytesLE(y(1),c)]),P=t.alloc([...Vt.bigInt2BytesLE(y(ne(2n,i)),c),...Vt.bigInt2BytesLE(0n,c)]),O=v,S=t.alloc([...Vt.bigInt2BytesLE(y(19485874751759354771024239261021720505790618469301721065564631296452457478373n),c),...Vt.bigInt2BytesLE(y(266929791119991161246907387137283842545076965332900288569378510910307636690n),c)]);!function(){const e=t.addFunction(n+"_mulNR6");e.addParam("x","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder();e.addCode(i.call(_+"_mul",i.i32_const(v),i.getLocal("x"),i.getLocal("pr")))}();const U=Yt(t,n+"_mulNR6","f6m","f2m");!function(){const e=t.addFunction(n+"_mulNR12");e.addParam("x","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder();e.addCode(i.call(_+"_mul",i.i32_const(v),i.i32_add(i.getLocal("x"),i.i32_const(4*r)),i.getLocal("pr")),i.call(_+"_copy",i.getLocal("x"),i.i32_add(i.getLocal("pr"),i.i32_const(2*r))),i.call(_+"_copy",i.i32_add(i.getLocal("x"),i.i32_const(2*r)),i.i32_add(i.getLocal("pr"),i.i32_const(4*r))))}();const Q=$t(t,n+"_mulNR12","ftm",U),k=function(t){let e=29793968203157093288n;const n=[];for(;e>0n;)ie(e)?n.push(1):n.push(0),e>>=1n;return n}(),T=t.alloc(k),N=3*l,q=k.length-1,M=k.reduce(((t,e)=>t+(0!=e?1:0)),0),D=6*r,R=3*r*2+(M+q+1)*N;t.modules[n]={n64:o,pG1gen:b,pG1zero:w,pG1b:f,pG2gen:x,pG2zero:B,pG2b:p,pq:t.modules.f1m.pq,pr:u,pOneT:F,prePSize:D,preQSize:R,r:a.toString(),q:i.toString()};function z(e){const a=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[8376118865763821496583973867626364092589906065868298776909617916018768340080n,16469823323077808223889137241176536799009286646108169935659301613961712198316n],[21888242871839275220042445260109153167277707414472061641714758635765020556617n,0n],[11697423496358154304825782922584725312912383441159505038794027105778954184319n,303847389135065887422783454877609941456349188919719272345083954437860409601n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3321304630594332808241809054958361220322477375291206261884409189760185844239n,5722266937896532885780051958958348231143373700109372999374820235121374419868n],[21888242871839275222246405745257275088696311157297823662689037894645226208582n,0n],[13512124006075453725662431877630910996106405091429524885779419978626457868503n,5418419548761466998357268504080738289687024511189653727029736280683514010267n],[2203960485148121921418603742825762020974279258880205651966n,0n],[10190819375481120917420622822672549775783927716138318623895010788866272024264n,21584395482704209334823622290379665147239961968378104390343953940207365798982n],[2203960485148121921418603742825762020974279258880205651967n,0n],[18566938241244942414004596690298913868373833782006617400804628704885040364344n,16165975933942742336466353786298926857552937457188450663314217659523851788715n]]],o=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[21575463638280843010398324269430826099269044274347216827212613867836435027261n,10307601595873709700152284273816112264069230130616436755625194854815875713954n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3772000881919853776433695186713858239009073593817195771773381919316419345261n,2236595495967245188281701248203181795121068902605861227855261137820944008926n],[2203960485148121921418603742825762020974279258880205651966n,0n],[18429021223477853657660792034369865839114504446431234726392080002137598044644n,9344045779998320333812420223237981029506012124075525679208581902008406485703n]],[[1n,0n],[2581911344467009335267311115468803099551665605076196740867805258568234346338n,19937756971775647987995932169929341994314640652964949448313374472400716661030n],[2203960485148121921418603742825762020974279258880205651966n,0n],[5324479202449903542726783395506214481928257762400643279780343368557297135718n,16208900380737693084919495127334387981393726419856888799917914180988844123039n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[13981852324922362344252311234282257507216387789820983642040889267519694726527n,7629828391165209371577384193250820201684255241773809077146787135900891633097n]]],r=t.addFunction(n+"__frobeniusMap"+e);r.addParam("x","i32"),r.addParam("r","i32");const s=r.getCodeBuilder();for(let n=0;n<6;n++){const i=0==n?s.getLocal("x"):s.i32_add(s.getLocal("x"),s.i32_const(n*l)),u=i,f=s.i32_add(s.getLocal("x"),s.i32_const(n*l+c)),h=0==n?s.getLocal("r"):s.i32_add(s.getLocal("r"),s.i32_const(n*l)),p=h,m=s.i32_add(s.getLocal("r"),s.i32_const(n*l+c)),L=d(a[Math.floor(n/3)][e%12],o[n%3][e%6]),A=t.alloc([...Vt.bigInt2BytesLE(y(L[0]),32),...Vt.bigInt2BytesLE(y(L[1]),32)]);e%2==1?r.addCode(s.call(g+"_copy",u,p),s.call(g+"_neg",f,m),s.call(_+"_mul",h,s.i32_const(A),h)):r.addCode(s.call(_+"_mul",i,s.i32_const(A),h))}function d(t,e){const n=BigInt(t[0]),a=BigInt(t[1]),o=BigInt(e[0]),r=BigInt(e[1]),s=[(n*o-a*r)%i,(n*r+a*o)%i];return ae(s[0])&&(s[0]=s[0]+i),s}}function G(){!function(){const e=t.addFunction(n+"__cyclotomicSquare");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),a=i.getLocal("x"),o=i.i32_add(i.getLocal("x"),i.i32_const(l)),r=i.i32_add(i.getLocal("x"),i.i32_const(2*l)),s=i.i32_add(i.getLocal("x"),i.i32_const(3*l)),c=i.i32_add(i.getLocal("x"),i.i32_const(4*l)),d=i.i32_add(i.getLocal("x"),i.i32_const(5*l)),u=i.getLocal("r"),g=i.i32_add(i.getLocal("r"),i.i32_const(l)),f=i.i32_add(i.getLocal("r"),i.i32_const(2*l)),h=i.i32_add(i.getLocal("r"),i.i32_const(3*l)),p=i.i32_add(i.getLocal("r"),i.i32_const(4*l)),m=i.i32_add(i.getLocal("r"),i.i32_const(5*l)),L=i.i32_const(t.alloc(l)),y=i.i32_const(t.alloc(l)),A=i.i32_const(t.alloc(l)),b=i.i32_const(t.alloc(l)),I=i.i32_const(t.alloc(l)),w=i.i32_const(t.alloc(l)),C=i.i32_const(t.alloc(l)),x=i.i32_const(t.alloc(l));e.addCode(i.call(_+"_mul",a,c,C),i.call(_+"_mul",c,i.i32_const(v),L),i.call(_+"_add",a,L,L),i.call(_+"_add",a,c,x),i.call(_+"_mul",x,L,L),i.call(_+"_mul",i.i32_const(v),C,x),i.call(_+"_add",C,x,x),i.call(_+"_sub",L,x,L),i.call(_+"_add",C,C,y),i.call(_+"_mul",s,r,C),i.call(_+"_mul",r,i.i32_const(v),A),i.call(_+"_add",s,A,A),i.call(_+"_add",s,r,x),i.call(_+"_mul",x,A,A),i.call(_+"_mul",i.i32_const(v),C,x),i.call(_+"_add",C,x,x),i.call(_+"_sub",A,x,A),i.call(_+"_add",C,C,b),i.call(_+"_mul",o,d,C),i.call(_+"_mul",d,i.i32_const(v),I),i.call(_+"_add",o,I,I),i.call(_+"_add",o,d,x),i.call(_+"_mul",x,I,I),i.call(_+"_mul",i.i32_const(v),C,x),i.call(_+"_add",C,x,x),i.call(_+"_sub",I,x,I),i.call(_+"_add",C,C,w),i.call(_+"_sub",L,a,u),i.call(_+"_add",u,u,u),i.call(_+"_add",L,u,u),i.call(_+"_add",y,c,p),i.call(_+"_add",p,p,p),i.call(_+"_add",y,p,p),i.call(_+"_mul",w,i.i32_const(O),x),i.call(_+"_add",x,s,h),i.call(_+"_add",h,h,h),i.call(_+"_add",x,h,h),i.call(_+"_sub",I,r,f),i.call(_+"_add",f,f,f),i.call(_+"_add",I,f,f),i.call(_+"_sub",A,o,g),i.call(_+"_add",g,g,g),i.call(_+"_add",A,g,g),i.call(_+"_add",b,d,m),i.call(_+"_add",m,m,m),i.call(_+"_add",b,m,m))}(),function(e,i){const a=function(t){let e=t;const n=[];for(;e>0n;){if(ie(e)){const t=2-Number(e%4n);n.push(t),e-=BigInt(t)}else n.push(0);e>>=1n}return n}(e).map((t=>-1==t?255:t)),o=t.alloc(a),r=t.addFunction(n+"__cyclotomicExp_"+i);r.addParam("x","i32"),r.addParam("r","i32"),r.addLocal("bit","i32"),r.addLocal("i","i32");const s=r.getCodeBuilder(),c=s.getLocal("x"),l=s.getLocal("r"),u=s.i32_const(t.alloc(d));r.addCode(s.call(Q+"_conjugate",c,u),s.call(Q+"_one",l),s.if(s.teeLocal("bit",s.i32_load8_s(s.i32_const(a.length-1),o)),s.if(s.i32_eq(s.getLocal("bit"),s.i32_const(1)),s.call(Q+"_mul",l,c,l),s.call(Q+"_mul",l,u,l))),s.setLocal("i",s.i32_const(a.length-2)),s.block(s.loop(s.call(n+"__cyclotomicSquare",l,l),s.if(s.teeLocal("bit",s.i32_load8_s(s.getLocal("i"),o)),s.if(s.i32_eq(s.getLocal("bit"),s.i32_const(1)),s.call(Q+"_mul",l,c,l),s.call(Q+"_mul",l,u,l))),s.br_if(1,s.i32_eqz(s.getLocal("i"))),s.setLocal("i",s.i32_sub(s.getLocal("i"),s.i32_const(1))),s.br(0))))}(4965661367192848881n,"w0");const e=t.addFunction(n+"__finalExponentiationLastChunk");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),a=i.getLocal("x"),o=i.getLocal("r"),r=i.i32_const(t.alloc(d)),s=i.i32_const(t.alloc(d)),c=i.i32_const(t.alloc(d)),u=i.i32_const(t.alloc(d)),g=i.i32_const(t.alloc(d)),f=i.i32_const(t.alloc(d)),h=i.i32_const(t.alloc(d)),p=i.i32_const(t.alloc(d)),m=i.i32_const(t.alloc(d)),L=i.i32_const(t.alloc(d)),y=i.i32_const(t.alloc(d)),A=i.i32_const(t.alloc(d)),b=i.i32_const(t.alloc(d)),I=i.i32_const(t.alloc(d)),w=i.i32_const(t.alloc(d)),C=i.i32_const(t.alloc(d)),x=i.i32_const(t.alloc(d)),E=i.i32_const(t.alloc(d)),B=i.i32_const(t.alloc(d)),F=i.i32_const(t.alloc(d)),P=i.i32_const(t.alloc(d));e.addCode(i.call(n+"__cyclotomicExp_w0",a,r),i.call(Q+"_conjugate",r,r),i.call(n+"__cyclotomicSquare",r,s),i.call(n+"__cyclotomicSquare",s,c),i.call(Q+"_mul",c,s,u),i.call(n+"__cyclotomicExp_w0",u,g),i.call(Q+"_conjugate",g,g),i.call(n+"__cyclotomicSquare",g,f),i.call(n+"__cyclotomicExp_w0",f,h),i.call(Q+"_conjugate",h,h),i.call(Q+"_conjugate",u,p),i.call(Q+"_conjugate",h,m),i.call(Q+"_mul",m,g,L),i.call(Q+"_mul",L,p,y),i.call(Q+"_mul",y,s,A),i.call(Q+"_mul",y,g,b),i.call(Q+"_mul",b,a,I),i.call(n+"__frobeniusMap1",A,w),i.call(Q+"_mul",w,I,C),i.call(n+"__frobeniusMap2",y,x),i.call(Q+"_mul",x,C,E),i.call(Q+"_conjugate",a,B),i.call(Q+"_mul",B,A,F),i.call(n+"__frobeniusMap3",F,P),i.call(Q+"_mul",P,E,o))}const j=t.alloc(D),V=t.alloc(R);function K(e){const i=t.addFunction(n+"_pairingEq"+e);for(let t=0;t<e;t++)i.addParam("p_"+t,"i32"),i.addParam("q_"+t,"i32");i.addParam("c","i32"),i.setReturnType("i32");const a=i.getCodeBuilder(),o=a.i32_const(t.alloc(d)),r=a.i32_const(t.alloc(d));i.addCode(a.call(Q+"_one",o));for(let t=0;t<e;t++)i.addCode(a.call(n+"_prepareG1",a.getLocal("p_"+t),a.i32_const(j))),i.addCode(a.call(n+"_prepareG2",a.getLocal("q_"+t),a.i32_const(V))),i.addCode(a.call(n+"_millerLoop",a.i32_const(j),a.i32_const(V),r)),i.addCode(a.call(Q+"_mul",o,r,o));i.addCode(a.call(n+"_finalExponentiation",o,o)),i.addCode(a.call(Q+"_eq",o,a.getLocal("c")))}!function(){const e=t.addFunction(n+"_prepAddStep");e.addParam("pQ","i32"),e.addParam("pR","i32"),e.addParam("pCoef","i32");const i=e.getCodeBuilder(),a=i.getLocal("pQ"),o=i.i32_add(i.getLocal("pQ"),i.i32_const(l)),r=i.getLocal("pR"),s=i.i32_add(i.getLocal("pR"),i.i32_const(l)),c=i.i32_add(i.getLocal("pR"),i.i32_const(2*l)),d=i.getLocal("pCoef"),u=i.i32_add(i.getLocal("pCoef"),i.i32_const(l)),g=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*l)),f=u,h=i.i32_const(t.alloc(l)),p=i.i32_const(t.alloc(l)),m=i.i32_const(t.alloc(l)),L=i.i32_const(t.alloc(l)),y=i.i32_const(t.alloc(l)),A=i.i32_const(t.alloc(l)),b=i.i32_const(t.alloc(l));e.addCode(i.call(_+"_mul",a,c,f),i.call(_+"_sub",r,f,f),i.call(_+"_mul",o,c,h),i.call(_+"_sub",s,h,h),i.call(_+"_square",f,p),i.call(_+"_square",h,m),i.call(_+"_mul",f,p,L),i.call(_+"_mul",r,p,y),i.call(_+"_add",y,y,b),i.call(_+"_mul",c,m,A),i.call(_+"_add",L,A,A),i.call(_+"_sub",A,b,A),i.call(_+"_mul",f,A,r),i.call(_+"_mul",L,s,s),i.call(_+"_sub",y,A,b),i.call(_+"_mul",h,b,b),i.call(_+"_sub",b,s,s),i.call(_+"_mul",c,L,c),i.call(_+"_mul",f,o,b),i.call(_+"_mul",h,a,d),i.call(_+"_sub",d,b,d),i.call(_+"_mul",d,i.i32_const(O),d),i.call(_+"_neg",h,g))}(),function(){const e=t.addFunction(n+"_prepDblStep");e.addParam("pR","i32"),e.addParam("pCoef","i32");const i=e.getCodeBuilder(),a=i.getLocal("pR"),o=i.i32_add(i.getLocal("pR"),i.i32_const(l)),r=i.i32_add(i.getLocal("pR"),i.i32_const(2*l)),s=i.getLocal("pCoef"),c=i.i32_add(i.getLocal("pCoef"),i.i32_const(l)),d=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*l)),u=i.i32_const(t.alloc(l)),g=i.i32_const(t.alloc(l)),f=i.i32_const(t.alloc(l)),h=i.i32_const(t.alloc(l)),p=i.i32_const(t.alloc(l)),m=i.i32_const(t.alloc(l)),L=i.i32_const(t.alloc(l)),y=i.i32_const(t.alloc(l)),A=i.i32_const(t.alloc(l)),b=i.i32_const(t.alloc(l)),I=i.i32_const(t.alloc(l)),w=i.i32_const(t.alloc(l));e.addCode(i.call(_+"_mul",o,i.i32_const(P),u),i.call(_+"_mul",a,u,u),i.call(_+"_square",o,g),i.call(_+"_square",r,f),i.call(_+"_add",f,f,h),i.call(_+"_add",h,f,h),i.call(_+"_mul",i.i32_const(S),h,p),i.call(_+"_add",p,p,m),i.call(_+"_add",p,m,m),i.call(_+"_add",g,m,L),i.call(_+"_mul",L,i.i32_const(P),L),i.call(_+"_add",g,f,w),i.call(_+"_add",o,r,y),i.call(_+"_square",y,y),i.call(_+"_sub",y,w,y),i.call(_+"_sub",p,g,A),i.call(_+"_square",a,b),i.call(_+"_square",p,I),i.call(_+"_sub",g,m,w),i.call(_+"_mul",u,w,a),i.call(_+"_add",I,I,w),i.call(_+"_add",I,w,w),i.call(_+"_square",L,o),i.call(_+"_sub",o,w,o),i.call(_+"_mul",g,y,r),i.call(_+"_mul",i.i32_const(O),A,s),i.call(_+"_neg",y,c),i.call(_+"_add",b,b,d),i.call(_+"_add",b,d,d))}(),function(){const e=t.addFunction(n+"_prepareG1");e.addParam("pP","i32"),e.addParam("ppreP","i32");const i=e.getCodeBuilder();e.addCode(i.call(h+"_normalize",i.getLocal("pP"),i.getLocal("ppreP")))}(),function(){!function(){const e=t.addFunction(n+"_mulByQ");e.addParam("p1","i32"),e.addParam("pr","i32");const i=e.getCodeBuilder(),a=i.getLocal("p1"),o=i.i32_add(i.getLocal("p1"),i.i32_const(l)),r=i.i32_add(i.getLocal("p1"),i.i32_const(2*l)),s=i.getLocal("pr"),d=i.i32_add(i.getLocal("pr"),i.i32_const(l)),u=i.i32_add(i.getLocal("pr"),i.i32_const(2*l)),g=i.i32_const(t.alloc([...Vt.bigInt2BytesLE(y("21575463638280843010398324269430826099269044274347216827212613867836435027261"),c),...Vt.bigInt2BytesLE(y("10307601595873709700152284273816112264069230130616436755625194854815875713954"),c)])),f=i.i32_const(t.alloc([...Vt.bigInt2BytesLE(y("2821565182194536844548159561693502659359617185244120367078079554186484126554"),c),...Vt.bigInt2BytesLE(y("3505843767911556378687030309984248845540243509899259641013678093033130930403"),c)]));e.addCode(i.call(_+"_conjugate",a,s),i.call(_+"_mul",g,s,s),i.call(_+"_conjugate",o,d),i.call(_+"_mul",f,d,d),i.call(_+"_conjugate",r,u))}();const e=t.addFunction(n+"_prepareG2");e.addParam("pQ","i32"),e.addParam("ppreQ","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),a=i.getLocal("pQ"),o=t.alloc(3*l),r=i.i32_const(o),s=i.i32_const(o),d=i.i32_const(o+l),u=i.i32_const(o+2*l),g=i.i32_add(i.getLocal("ppreQ"),i.i32_const(0)),f=i.i32_add(i.getLocal("ppreQ"),i.i32_const(l)),h=t.alloc(3*l),p=i.i32_const(h),L=t.alloc(3*l),A=i.i32_const(L),b=i.i32_const(L+l);e.addCode(i.call(m+"_normalize",a,g),i.call(_+"_copy",g,s),i.call(_+"_copy",f,d),i.call(_+"_one",u)),e.addCode(i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*l))),i.setLocal("i",i.i32_const(k.length-2)),i.block(i.loop(i.call(n+"_prepDblStep",r,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(N))),i.if(i.i32_load8_s(i.getLocal("i"),T),[...i.call(n+"_prepAddStep",g,r,i.getLocal("pCoef")),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(N)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0)))),e.addCode(i.call(n+"_mulByQ",g,p),i.call(n+"_mulByQ",p,A)),e.addCode(i.call(_+"_neg",b,b),i.call(n+"_prepAddStep",p,r,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(N))),i.call(n+"_prepAddStep",A,r,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(N))))}(),function(){const e=t.addFunction(n+"__mulBy024");e.addParam("pEll0","i32"),e.addParam("pEllVW","i32"),e.addParam("pEllVV","i32"),e.addParam("pR","i32");const i=e.getCodeBuilder(),a=i.getLocal("pEll0"),o=i.getLocal("pEllVV"),s=i.getLocal("pEllVW"),c=i.getLocal("pR"),d=i.i32_add(i.getLocal("pR"),i.i32_const(2*r)),u=i.i32_add(i.getLocal("pR"),i.i32_const(4*r)),g=i.i32_add(i.getLocal("pR"),i.i32_const(6*r)),f=i.i32_add(i.getLocal("pR"),i.i32_const(8*r)),h=i.i32_add(i.getLocal("pR"),i.i32_const(10*r)),p=i.i32_const(t.alloc(l)),m=i.i32_const(t.alloc(l)),L=i.i32_const(t.alloc(l)),y=i.i32_const(t.alloc(l)),A=i.i32_const(t.alloc(l)),b=i.i32_const(t.alloc(l)),I=i.i32_const(t.alloc(l)),w=i.i32_const(t.alloc(l)),C=i.i32_const(t.alloc(l)),x=i.i32_const(t.alloc(l)),E=i.i32_const(t.alloc(l));e.addCode(i.call(_+"_mul",c,a,I),i.call(_+"_mul",u,o,w),i.call(_+"_mul",f,s,C),i.call(_+"_add",c,f,L),i.call(_+"_add",c,u,m),i.call(_+"_add",d,g,y),i.call(_+"_add",y,h,y),i.call(_+"_mul",d,o,x),i.call(_+"_add",x,C,A),i.call(_+"_mul",i.i32_const(v),A,b),i.call(_+"_add",b,I,c),i.call(_+"_mul",h,s,A),i.call(_+"_add",x,A,x),i.call(_+"_add",A,w,A),i.call(_+"_mul",i.i32_const(v),A,b),i.call(_+"_mul",d,a,A),i.call(_+"_add",x,A,x),i.call(_+"_add",b,A,d),i.call(_+"_add",a,o,p),i.call(_+"_mul",m,p,A),i.call(_+"_add",I,w,E),i.call(_+"_sub",A,E,A),i.call(_+"_mul",g,s,b),i.call(_+"_add",x,b,x),i.call(_+"_add",u,f,p),i.call(_+"_add",A,b,u),i.call(_+"_add",o,s,m),i.call(_+"_mul",m,p,A),i.call(_+"_add",w,C,E),i.call(_+"_sub",A,E,A),i.call(_+"_mul",i.i32_const(v),A,b),i.call(_+"_mul",g,a,A),i.call(_+"_add",x,A,x),i.call(_+"_add",b,A,g),i.call(_+"_mul",h,o,A),i.call(_+"_add",x,A,x),i.call(_+"_mul",i.i32_const(v),A,b),i.call(_+"_add",a,s,p),i.call(_+"_mul",L,p,A),i.call(_+"_add",I,C,E),i.call(_+"_sub",A,E,A),i.call(_+"_add",b,A,f),i.call(_+"_add",a,o,p),i.call(_+"_add",p,s,p),i.call(_+"_mul",y,p,A),i.call(_+"_sub",A,x,h))}(),function(){const e=t.addFunction(n+"__mulBy024Old");e.addParam("pEll0","i32"),e.addParam("pEllVW","i32"),e.addParam("pEllVV","i32"),e.addParam("pR","i32");const i=e.getCodeBuilder(),a=i.getLocal("pEll0"),o=i.getLocal("pEllVV"),r=i.getLocal("pEllVW"),s=i.getLocal("pR"),c=t.alloc(d),u=i.i32_const(c),g=i.i32_const(c),f=i.i32_const(c+l),h=i.i32_const(c+2*l),p=i.i32_const(c+3*l),m=i.i32_const(c+4*l),L=i.i32_const(c+5*l);e.addCode(i.call(_+"_copy",a,g),i.call(_+"_zero",f),i.call(_+"_copy",o,h),i.call(_+"_zero",p),i.call(_+"_copy",r,m),i.call(_+"_zero",L),i.call(Q+"_mul",u,s,s))}(),function(){const e=t.addFunction(n+"_millerLoop");e.addParam("ppreP","i32"),e.addParam("ppreQ","i32"),e.addParam("r","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),a=i.getLocal("ppreP"),o=i.i32_add(i.getLocal("ppreP"),i.i32_const(c)),r=i.getLocal("pCoef"),s=i.i32_add(i.getLocal("pCoef"),i.i32_const(l)),d=i.i32_add(i.getLocal("pCoef"),i.i32_const(2*l)),u=t.alloc(l),g=i.i32_const(u),f=t.alloc(l),h=i.i32_const(f),p=i.getLocal("r");e.addCode(i.call(Q+"_one",p),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*l))),i.setLocal("i",i.i32_const(k.length-2)),i.block(i.loop(i.call(Q+"_square",p,p),i.call(_+"_mul1",s,o,g),i.call(_+"_mul1",d,a,h),i.call(n+"__mulBy024",r,g,h,p),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(N))),i.if(i.i32_load8_s(i.getLocal("i"),T),[...i.call(_+"_mul1",s,o,g),...i.call(_+"_mul1",d,a,h),...i.call(n+"__mulBy024",r,g,h,p),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(N)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0)))),e.addCode(i.call(_+"_mul1",s,o,g),i.call(_+"_mul1",d,a,h),i.call(n+"__mulBy024",r,g,h,p),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(N))),i.call(_+"_mul1",s,o,g),i.call(_+"_mul1",d,a,h),i.call(n+"__mulBy024",r,g,h,p),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(N))))}();for(let e=0;e<10;e++)z(e),t.exportFunction(n+"__frobeniusMap"+e);!function(){const e=t.addFunction(n+"_finalExponentiationOld");e.addParam("x","i32"),e.addParam("r","i32");const i=t.alloc(Vt.bigInt2BytesLE(552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480n,352)),a=e.getCodeBuilder();e.addCode(a.call(Q+"_exp",a.getLocal("x"),a.i32_const(i),a.i32_const(352),a.getLocal("r")))}(),function(){!function(){const e=t.addFunction(n+"__finalExponentiationFirstChunk");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),a=i.getLocal("x"),o=a,s=i.i32_add(a,i.i32_const(6*r)),c=i.getLocal("r"),l=t.alloc(d),u=i.i32_const(l),g=u,f=i.i32_const(l+6*r),h=i.i32_const(t.alloc(d)),_=i.i32_const(t.alloc(d)),p=i.i32_const(t.alloc(d));e.addCode(i.call(U+"_copy",o,g),i.call(U+"_neg",s,f),i.call(Q+"_inverse",a,h),i.call(Q+"_mul",u,h,_),i.call(n+"__frobeniusMap2",_,p),i.call(Q+"_mul",_,p,c))}(),G();const e=t.addFunction(n+"_finalExponentiation");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),a=i.getLocal("x"),o=i.getLocal("r"),s=i.i32_const(t.alloc(d));e.addCode(i.call(n+"__finalExponentiationFirstChunk",a,s),i.call(n+"__finalExponentiationLastChunk",s,o))}();for(let e=1;e<=5;e++)K(e),t.exportFunction(n+"_pairingEq"+e);!function(){const e=t.addFunction(n+"_pairing");e.addParam("p","i32"),e.addParam("q","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),a=i.i32_const(t.alloc(d));e.addCode(i.call(n+"_prepareG1",i.getLocal("p"),i.i32_const(j))),e.addCode(i.call(n+"_prepareG2",i.getLocal("q"),i.i32_const(V))),e.addCode(i.call(n+"_millerLoop",i.i32_const(j),i.i32_const(V),a)),e.addCode(i.call(n+"_finalExponentiation",a,i.getLocal("r")))}(),t.exportFunction(n+"_pairing"),t.exportFunction(n+"_prepareG1"),t.exportFunction(n+"_prepareG2"),t.exportFunction(n+"_millerLoop"),t.exportFunction(n+"_finalExponentiation"),t.exportFunction(n+"_finalExponentiationOld"),t.exportFunction(n+"__mulBy024"),t.exportFunction(n+"__mulBy024Old"),t.exportFunction(n+"__cyclotomicSquare"),t.exportFunction(n+"__cyclotomicExp_w0")},ye=function(t,e){const n=e||"bls12381";if(t.modules[n])return n;const i=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,a=0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,o=Math.floor((_e(i-1n)-1)/64)+1,r=8*o,s=r,c=2*s,l=12*s,d=Math.floor((_e(a-1n)-1)/64)+1,u=8*d,g=u,f=t.alloc(oe.bigInt2BytesLE(a,g)),h=re(t,i,"f1m","intq");se(t,a,"fr","frm","intr");const _=t.alloc(oe.bigInt2BytesLE(b(4n),s)),p=de(t,"g1m","f1m",_);ue(t,"frm","frm","frm","frm_mul"),ge(t,"pol","frm"),fe(t,"qap","frm");const m=ce(t,"f1m_neg","f2m","f1m"),L=t.alloc([...oe.bigInt2BytesLE(b(4n),s),...oe.bigInt2BytesLE(b(4n),s)]),y=de(t,"g2m","f2m",L);function A(e,n){const i=t.addFunction(e);i.addParam("pG","i32"),i.addParam("pFr","i32"),i.addParam("pr","i32");const a=i.getCodeBuilder(),o=a.i32_const(t.alloc(u));i.addCode(a.call("frm_fromMontgomery",a.getLocal("pFr"),o),a.call(n,a.getLocal("pG"),o,a.i32_const(u),a.getLocal("pr"))),t.exportFunction(e)}function b(t){return BigInt(t)*(1n<<BigInt(8*s))%i}A("g1m_timesFr","g1m_timesScalar"),ue(t,"g1m","g1m","frm","g1m_timesFr"),A("g2m_timesFr","g2m_timesScalar"),ue(t,"g2m","g2m","frm","g2m_timesFr"),A("g1m_timesFrAffine","g1m_timesScalarAffine"),A("g2m_timesFrAffine","g2m_timesScalarAffine"),he(t,"frm_batchApplyKey","fmr","frm",u,u,u,"frm_mul"),he(t,"g1m_batchApplyKey","g1m","frm",3*r,3*r,u,"g1m_timesFr"),he(t,"g1m_batchApplyKeyMixed","g1m","frm",2*r,3*r,u,"g1m_timesFrAffine"),he(t,"g2m_batchApplyKey","g2m","frm",2*r*3,3*r*2,u,"g2m_timesFr"),he(t,"g2m_batchApplyKeyMixed","g2m","frm",2*r*2,3*r*2,u,"g2m_timesFrAffine");const I=[3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507n,1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569n,1n],w=t.alloc([...oe.bigInt2BytesLE(b(I[0]),s),...oe.bigInt2BytesLE(b(I[1]),s),...oe.bigInt2BytesLE(b(I[2]),s)]),C=[0n,1n,0n],x=t.alloc([...oe.bigInt2BytesLE(b(C[0]),s),...oe.bigInt2BytesLE(b(C[1]),s),...oe.bigInt2BytesLE(b(C[2]),s)]),E=[[352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160n,3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758n],[1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905n,927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582n],[1n,0n]],B=t.alloc([...oe.bigInt2BytesLE(b(E[0][0]),s),...oe.bigInt2BytesLE(b(E[0][1]),s),...oe.bigInt2BytesLE(b(E[1][0]),s),...oe.bigInt2BytesLE(b(E[1][1]),s),...oe.bigInt2BytesLE(b(E[2][0]),s),...oe.bigInt2BytesLE(b(E[2][1]),s)]),F=[[0n,0n],[1n,0n],[0n,0n]],v=t.alloc([...oe.bigInt2BytesLE(b(F[0][0]),s),...oe.bigInt2BytesLE(b(F[0][1]),s),...oe.bigInt2BytesLE(b(F[1][0]),s),...oe.bigInt2BytesLE(b(F[1][1]),s),...oe.bigInt2BytesLE(b(F[2][0]),s),...oe.bigInt2BytesLE(b(F[2][1]),s)]),P=t.alloc([...oe.bigInt2BytesLE(b(1n),s),...oe.bigInt2BytesLE(b(0n),s),...oe.bigInt2BytesLE(b(0n),s),...oe.bigInt2BytesLE(b(0n),s),...oe.bigInt2BytesLE(b(0n),s),...oe.bigInt2BytesLE(b(0n),s),...oe.bigInt2BytesLE(b(0n),s),...oe.bigInt2BytesLE(b(0n),s),...oe.bigInt2BytesLE(b(0n),s),...oe.bigInt2BytesLE(b(0n),s),...oe.bigInt2BytesLE(b(0n),s),...oe.bigInt2BytesLE(b(0n),s)]),O=t.alloc([...oe.bigInt2BytesLE(b(1n),s),...oe.bigInt2BytesLE(b(1n),s)]);!function(){const e=t.addFunction(m+"_mulNR");e.addParam("x","i32"),e.addParam("pr","i32");const n=e.getCodeBuilder(),i=n.i32_const(t.alloc(s)),a=n.getLocal("x"),o=n.i32_add(n.getLocal("x"),n.i32_const(s)),r=n.getLocal("pr"),c=n.i32_add(n.getLocal("pr"),n.i32_const(s));e.addCode(n.call(h+"_copy",a,i),n.call(h+"_sub",a,o,r),n.call(h+"_add",i,o,c))}();const S=le(t,m+"_mulNR","f6m","f2m");!function(){const e=t.addFunction(S+"_mulNR");e.addParam("x","i32"),e.addParam("pr","i32");const n=e.getCodeBuilder(),i=n.i32_const(t.alloc(2*s));e.addCode(n.call(m+"_copy",n.getLocal("x"),i),n.call(m+"_mulNR",n.i32_add(n.getLocal("x"),n.i32_const(4*r)),n.getLocal("pr")),n.call(m+"_copy",n.i32_add(n.getLocal("x"),n.i32_const(2*r)),n.i32_add(n.getLocal("pr"),n.i32_const(4*r))),n.call(m+"_copy",i,n.i32_add(n.getLocal("pr"),n.i32_const(2*r))))}();const U=ce(t,S+"_mulNR","ftm",S),Q=function(t){let e=0xd201000000010000n;const n=[];for(;e>0n;)pe(e)?n.push(1):n.push(0),e>>=1n;return n}(),k=t.alloc(Q),T=3*c,N=Q.length-1,q=Q.reduce(((t,e)=>t+(0!=e?1:0)),0),M=6*r,D=3*r*2+(q+N+1)*T,R=15132376222941642752n;function z(e){const n=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n,151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n],[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n,877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n,3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n,3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n]]],a=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[0n,1n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[0n,793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n]],[[1n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n]]],o=t.addFunction(U+"_frobeniusMap"+e);o.addParam("x","i32"),o.addParam("r","i32");const l=o.getCodeBuilder();for(let i=0;i<6;i++){const u=0==i?l.getLocal("x"):l.i32_add(l.getLocal("x"),l.i32_const(i*c)),g=u,f=l.i32_add(l.getLocal("x"),l.i32_const(i*c+s)),_=0==i?l.getLocal("r"):l.i32_add(l.getLocal("r"),l.i32_const(i*c)),p=_,L=l.i32_add(l.getLocal("r"),l.i32_const(i*c+s)),y=d(n[Math.floor(i/3)][e%12],a[i%3][e%6]),A=t.alloc([...oe.bigInt2BytesLE(b(y[0]),r),...oe.bigInt2BytesLE(b(y[1]),r)]);e%2==1?o.addCode(l.call(h+"_copy",g,p),l.call(h+"_neg",f,L),l.call(m+"_mul",_,l.i32_const(A),_)):o.addCode(l.call(m+"_mul",u,l.i32_const(A),_))}function d(t,e){const n=t[0],a=t[1],o=e[0],r=e[1],s=[(n*o-a*r)%i,(n*r+a*o)%i];return me(s[0])&&(s[0]=s[0]+i),s}}t.modules[n]={n64q:o,n64r:d,n8q:r,n8r:u,pG1gen:w,pG1zero:x,pG1b:_,pG2gen:B,pG2zero:v,pG2b:L,pq:t.modules.f1m.pq,pr:f,pOneT:P,r:a,q:i,prePSize:M,preQSize:D},function(){const e=t.addFunction(S+"_mul1");e.addParam("pA","i32"),e.addParam("pC1","i32"),e.addParam("pR","i32");const n=e.getCodeBuilder(),i=n.getLocal("pA"),a=n.i32_add(n.getLocal("pA"),n.i32_const(2*s)),o=n.i32_add(n.getLocal("pA"),n.i32_const(4*s)),r=n.getLocal("pC1"),c=n.getLocal("pR"),l=n.i32_add(n.getLocal("pR"),n.i32_const(2*s)),d=n.i32_add(n.getLocal("pR"),n.i32_const(4*s)),u=n.i32_const(t.alloc(2*s)),g=n.i32_const(t.alloc(2*s));e.addCode(n.call(m+"_add",i,a,u),n.call(m+"_add",a,o,g),n.call(m+"_mul",a,r,d),n.call(m+"_mul",g,r,c),n.call(m+"_sub",c,d,c),n.call(m+"_mulNR",c,c),n.call(m+"_mul",u,r,l),n.call(m+"_sub",l,d,l))}(),function(){const e=t.addFunction(S+"_mul01");e.addParam("pA","i32"),e.addParam("pC0","i32"),e.addParam("pC1","i32"),e.addParam("pR","i32");const n=e.getCodeBuilder(),i=n.getLocal("pA"),a=n.i32_add(n.getLocal("pA"),n.i32_const(2*s)),o=n.i32_add(n.getLocal("pA"),n.i32_const(4*s)),r=n.getLocal("pC0"),c=n.getLocal("pC1"),l=n.getLocal("pR"),d=n.i32_add(n.getLocal("pR"),n.i32_const(2*s)),u=n.i32_add(n.getLocal("pR"),n.i32_const(4*s)),g=n.i32_const(t.alloc(2*s)),f=n.i32_const(t.alloc(2*s)),h=n.i32_const(t.alloc(2*s)),_=n.i32_const(t.alloc(2*s));e.addCode(n.call(m+"_mul",i,r,g),n.call(m+"_mul",a,c,f),n.call(m+"_add",i,a,h),n.call(m+"_add",i,o,_),n.call(m+"_add",a,o,l),n.call(m+"_mul",l,c,l),n.call(m+"_sub",l,f,l),n.call(m+"_mulNR",l,l),n.call(m+"_add",l,g,l),n.call(m+"_add",r,c,d),n.call(m+"_mul",d,h,d),n.call(m+"_sub",d,g,d),n.call(m+"_sub",d,f,d),n.call(m+"_mul",_,r,u),n.call(m+"_sub",u,g,u),n.call(m+"_add",u,f,u))}(),function(){const e=t.addFunction(U+"_mul014");e.addParam("pA","i32"),e.addParam("pC0","i32"),e.addParam("pC1","i32"),e.addParam("pC4","i32"),e.addParam("pR","i32");const n=e.getCodeBuilder(),i=n.getLocal("pA"),a=n.i32_add(n.getLocal("pA"),n.i32_const(6*s)),o=n.getLocal("pC0"),r=n.getLocal("pC1"),c=n.getLocal("pC4"),l=n.i32_const(t.alloc(6*s)),d=n.i32_const(t.alloc(6*s)),u=n.i32_const(t.alloc(2*s)),g=n.getLocal("pR"),f=n.i32_add(n.getLocal("pR"),n.i32_const(6*s));e.addCode(n.call(S+"_mul01",i,o,r,l),n.call(S+"_mul1",a,c,d),n.call(m+"_add",r,c,u),n.call(S+"_add",a,i,f),n.call(S+"_mul01",f,o,u,f),n.call(S+"_sub",f,l,f),n.call(S+"_sub",f,d,f),n.call(S+"_copy",d,g),n.call(S+"_mulNR",g,g),n.call(S+"_add",g,l,g))}(),function(){const e=t.addFunction(n+"_ell");e.addParam("pP","i32"),e.addParam("pCoefs","i32"),e.addParam("pF","i32");const i=e.getCodeBuilder(),a=i.getLocal("pP"),o=i.i32_add(i.getLocal("pP"),i.i32_const(r)),c=i.getLocal("pF"),l=i.getLocal("pCoefs"),d=i.i32_add(i.getLocal("pCoefs"),i.i32_const(s)),u=i.i32_add(i.getLocal("pCoefs"),i.i32_const(2*s)),g=i.i32_add(i.getLocal("pCoefs"),i.i32_const(3*s)),f=i.i32_add(i.getLocal("pCoefs"),i.i32_const(4*s)),_=t.alloc(2*s),p=i.i32_const(_),m=i.i32_const(_),L=i.i32_const(_+s),y=t.alloc(2*s),A=i.i32_const(y),b=i.i32_const(y),I=i.i32_const(y+s);e.addCode(i.call(h+"_mul",l,o,m),i.call(h+"_mul",d,o,L),i.call(h+"_mul",u,a,b),i.call(h+"_mul",g,a,I),i.call(U+"_mul014",c,f,A,p,c))}();const G=t.alloc(M),j=t.alloc(D);function V(e){const i=t.addFunction(n+"_pairingEq"+e);for(let t=0;t<e;t++)i.addParam("p_"+t,"i32"),i.addParam("q_"+t,"i32");i.addParam("c","i32"),i.setReturnType("i32");const a=i.getCodeBuilder(),o=a.i32_const(t.alloc(l)),r=a.i32_const(t.alloc(l));i.addCode(a.call(U+"_one",o));for(let t=0;t<e;t++)i.addCode(a.call(n+"_prepareG1",a.getLocal("p_"+t),a.i32_const(G))),i.addCode(a.call(n+"_prepareG2",a.getLocal("q_"+t),a.i32_const(j))),i.addCode(a.if(a.i32_eqz(a.call(p+"_inGroupAffine",a.i32_const(G))),a.ret(a.i32_const(0))),a.if(a.i32_eqz(a.call(y+"_inGroupAffine",a.i32_const(j))),a.ret(a.i32_const(0)))),i.addCode(a.call(n+"_millerLoop",a.i32_const(G),a.i32_const(j),r)),i.addCode(a.call(U+"_mul",o,r,o));i.addCode(a.call(n+"_finalExponentiation",o,o)),i.addCode(a.call(U+"_eq",o,a.getLocal("c")))}for(let e=0;e<10;e++)z(e),t.exportFunction(U+"_frobeniusMap"+e);!function(){const e=t.addFunction(p+"_inGroupAffine");e.addParam("p","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),i=(R*R-1n)/3n,a=n.i32_const(t.alloc(oe.bigInt2BytesLE(b(4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n),r))),o=n.i32_const(t.alloc(oe.bigInt2BytesLE(b(793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n),r))),c=n.i32_const(t.alloc(oe.bigInt2BytesLE(i,16))),l=n.getLocal("p"),d=n.i32_add(n.getLocal("p"),n.i32_const(s)),u=t.alloc(3*s),g=n.i32_const(u),f=n.i32_const(u),_=n.i32_const(u+s),m=t.alloc(2*s),L=n.i32_const(m),y=n.i32_const(m),A=n.i32_const(m+s);e.addCode(n.if(n.call(p+"_isZeroAffine",n.getLocal("p")),n.ret(n.i32_const(1))),n.if(n.i32_eqz(n.call(p+"_inCurveAffine",n.getLocal("p"))),n.ret(n.i32_const(0))),n.call(h+"_mul",l,a,f),n.call(h+"_copy",d,_),n.call(h+"_mul",l,o,y),n.call(h+"_copy",d,A),n.call(p+"_doubleAffine",g,g),n.call(p+"_subMixed",g,n.getLocal("p"),g),n.call(p+"_subMixed",g,L,g),n.call(p+"_timesScalar",g,c,n.i32_const(16),g),n.ret(n.call(p+"_eqMixed",g,L)));const I=t.addFunction(p+"_inGroup");I.addParam("pIn","i32"),I.setReturnType("i32");const w=I.getCodeBuilder(),C=w.i32_const(t.alloc(2*s));I.addCode(w.call(p+"_toAffine",w.getLocal("pIn"),C),w.ret(w.call(p+"_inGroupAffine",C)))}(),function(){const e=t.addFunction(y+"_inGroupAffine");e.addParam("p","i32"),e.setReturnType("i32");const n=e.getCodeBuilder(),i=[2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894n,2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893n],a=[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],o=n.i32_const(t.alloc([...oe.bigInt2BytesLE(b(i[0]),r),...oe.bigInt2BytesLE(b(i[1]),r)])),l=n.i32_const(t.alloc(oe.bigInt2BytesLE(b(4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n),r))),d=n.i32_const(t.alloc([...oe.bigInt2BytesLE(b(a[0]),r),...oe.bigInt2BytesLE(b(a[1]),r)])),u=n.i32_const(t.alloc(oe.bigInt2BytesLE(R,8))),g=n.getLocal("p"),f=n.i32_add(n.getLocal("p"),n.i32_const(c)),_=n.i32_const(t.alloc(s)),p=n.i32_const(t.alloc(c)),L=n.i32_const(t.alloc(c)),A=t.alloc(2*c),I=n.i32_const(A),w=n.i32_const(A),C=n.i32_const(A),x=n.i32_const(A+s),E=n.i32_const(A+c),B=n.i32_const(A+c),F=n.i32_const(A+c+s),v=t.alloc(3*c),P=n.i32_const(v),O=n.i32_const(v),S=n.i32_const(v),U=n.i32_const(v+s),Q=n.i32_const(v+c),k=n.i32_const(v+c),T=n.i32_const(v+c+s),N=n.i32_const(v+2*c);e.addCode(n.if(n.call(y+"_isZeroAffine",n.getLocal("p")),n.ret(n.i32_const(1))),n.if(n.i32_eqz(n.call(y+"_inCurveAffine",n.getLocal("p"))),n.ret(n.i32_const(0))),n.call(m+"_mul",g,o,p),n.call(m+"_mul",f,o,L),n.call(m+"_mul1",p,l,w),n.call(m+"_neg",L,E),n.call(m+"_neg",p,O),n.call(m+"_mul",L,d,Q),n.call(h+"_sub",C,x,_),n.call(h+"_add",C,x,x),n.call(h+"_copy",_,C),n.call(h+"_sub",B,F,_),n.call(h+"_add",B,F,F),n.call(h+"_copy",_,B),n.call(h+"_add",S,U,_),n.call(h+"_sub",S,U,U),n.call(h+"_copy",_,S),n.call(h+"_sub",T,k,_),n.call(h+"_add",k,T,T),n.call(h+"_copy",_,k),n.call(m+"_one",N),n.call(y+"_timesScalar",P,u,n.i32_const(8),P),n.call(y+"_addMixed",P,I,P),n.ret(n.call(y+"_eqMixed",P,n.getLocal("p"))));const q=t.addFunction(y+"_inGroup");q.addParam("pIn","i32"),q.setReturnType("i32");const M=q.getCodeBuilder(),D=M.i32_const(t.alloc(2*c));q.addCode(M.call(y+"_toAffine",M.getLocal("pIn"),D),M.ret(M.call(y+"_inGroupAffine",D)))}(),function(){const e=t.addFunction(n+"_prepAddStep");e.addParam("R","i32"),e.addParam("Q","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),a=i.getLocal("R"),o=i.i32_add(i.getLocal("R"),i.i32_const(2*r)),s=i.i32_add(i.getLocal("R"),i.i32_const(4*r)),l=i.getLocal("Q"),d=i.i32_add(i.getLocal("Q"),i.i32_const(2*r)),u=i.getLocal("r"),g=i.i32_add(i.getLocal("r"),i.i32_const(2*r)),f=i.i32_add(i.getLocal("r"),i.i32_const(4*r)),h=i.i32_const(t.alloc(c)),_=i.i32_const(t.alloc(c)),p=i.i32_const(t.alloc(c)),L=i.i32_const(t.alloc(c)),y=i.i32_const(t.alloc(c)),A=i.i32_const(t.alloc(c)),b=i.i32_const(t.alloc(c)),I=i.i32_const(t.alloc(c)),w=i.i32_const(t.alloc(c)),C=i.i32_const(t.alloc(c)),x=i.i32_const(t.alloc(c));e.addCode(i.call(m+"_square",s,h),i.call(m+"_square",d,_),i.call(m+"_mul",h,l,L),i.call(m+"_add",d,s,g),i.call(m+"_square",g,g),i.call(m+"_sub",g,_,g),i.call(m+"_sub",g,h,g),i.call(m+"_mul",g,h,g),i.call(m+"_sub",L,a,y),i.call(m+"_square",y,A),i.call(m+"_add",A,A,b),i.call(m+"_add",b,b,b),i.call(m+"_mul",b,y,I),i.call(m+"_sub",g,o,w),i.call(m+"_sub",w,o,w),i.call(m+"_mul",w,l,f),i.call(m+"_mul",b,a,C),i.call(m+"_square",w,a),i.call(m+"_sub",a,I,a),i.call(m+"_sub",a,C,a),i.call(m+"_sub",a,C,a),i.call(m+"_add",s,y,s),i.call(m+"_square",s,s),i.call(m+"_sub",s,h,s),i.call(m+"_sub",s,A,s),i.call(m+"_add",d,s,u),i.call(m+"_sub",C,a,x),i.call(m+"_mul",x,w,x),i.call(m+"_mul",o,I,L),i.call(m+"_add",L,L,L),i.call(m+"_sub",x,L,o),i.call(m+"_square",u,u),i.call(m+"_sub",u,_,u),i.call(m+"_square",s,p),i.call(m+"_sub",u,p,u),i.call(m+"_add",f,f,f),i.call(m+"_sub",f,u,f),i.call(m+"_add",s,s,u),i.call(m+"_neg",w,w),i.call(m+"_add",w,w,g))}(),function(){const e=t.addFunction(n+"_prepDblStep");e.addParam("R","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),a=i.getLocal("R"),o=i.i32_add(i.getLocal("R"),i.i32_const(2*r)),s=i.i32_add(i.getLocal("R"),i.i32_const(4*r)),l=i.getLocal("r"),d=i.i32_add(i.getLocal("r"),i.i32_const(2*r)),u=i.i32_add(i.getLocal("r"),i.i32_const(4*r)),g=i.i32_const(t.alloc(c)),f=i.i32_const(t.alloc(c)),h=i.i32_const(t.alloc(c)),_=i.i32_const(t.alloc(c)),p=i.i32_const(t.alloc(c));e.addCode(i.call(m+"_square",a,l),i.call(m+"_square",o,f),i.call(m+"_square",f,h),i.call(m+"_add",f,a,d),i.call(m+"_square",d,d),i.call(m+"_sub",d,l,d),i.call(m+"_sub",d,h,d),i.call(m+"_add",d,d,d),i.call(m+"_add",l,l,_),i.call(m+"_add",_,l,_),i.call(m+"_add",a,_,u),i.call(m+"_square",_,p),i.call(m+"_square",s,g),i.call(m+"_sub",p,d,a),i.call(m+"_sub",a,d,a),i.call(m+"_add",s,o,s),i.call(m+"_square",s,s),i.call(m+"_sub",s,f,s),i.call(m+"_sub",s,g,s),i.call(m+"_sub",d,a,o),i.call(m+"_mul",o,_,o),i.call(m+"_add",h,h,h),i.call(m+"_add",h,h,h),i.call(m+"_add",h,h,h),i.call(m+"_sub",o,h,o),i.call(m+"_mul",_,g,d),i.call(m+"_add",d,d,d),i.call(m+"_neg",d,d),i.call(m+"_square",u,u),i.call(m+"_sub",u,l,u),i.call(m+"_sub",u,p,u),i.call(m+"_add",f,f,f),i.call(m+"_add",f,f,f),i.call(m+"_sub",u,f,u),i.call(m+"_mul",s,g,l),i.call(m+"_add",l,l,l))}(),function(){const e=t.addFunction(n+"_prepareG1");e.addParam("pP","i32"),e.addParam("ppreP","i32");const i=e.getCodeBuilder();e.addCode(i.call(p+"_normalize",i.getLocal("pP"),i.getLocal("ppreP")))}(),function(){const e=t.addFunction(n+"_prepareG2");e.addParam("pQ","i32"),e.addParam("ppreQ","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),a=i.getLocal("pQ"),o=t.alloc(3*c),r=i.i32_const(o),s=i.getLocal("ppreQ");e.addCode(i.call(y+"_normalize",a,s),i.if(i.call(y+"_isZero",s),i.ret([])),i.call(y+"_copy",s,r),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*c)))),e.addCode(i.setLocal("i",i.i32_const(Q.length-2)),i.block(i.loop(i.call(n+"_prepDblStep",r,i.getLocal("pCoef")),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(T))),i.if(i.i32_load8_s(i.getLocal("i"),k),[...i.call(n+"_prepAddStep",r,s,i.getLocal("pCoef")),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(T)))]),i.br_if(1,i.i32_eqz(i.getLocal("i"))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0))))}(),function(){const e=t.addFunction(n+"_millerLoop");e.addParam("ppreP","i32"),e.addParam("ppreQ","i32"),e.addParam("r","i32"),e.addLocal("pCoef","i32"),e.addLocal("i","i32");const i=e.getCodeBuilder(),a=i.getLocal("ppreP"),o=i.getLocal("pCoef"),r=i.getLocal("r");e.addCode(i.call(U+"_one",r),i.if(i.call(p+"_isZero",a),i.ret([])),i.if(i.call(p+"_isZero",i.getLocal("ppreQ")),i.ret([])),i.setLocal("pCoef",i.i32_add(i.getLocal("ppreQ"),i.i32_const(3*c))),i.setLocal("i",i.i32_const(Q.length-2)),i.block(i.loop(i.call(n+"_ell",a,o,r),i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(T))),i.if(i.i32_load8_s(i.getLocal("i"),k),[...i.call(n+"_ell",a,o,r),...i.setLocal("pCoef",i.i32_add(i.getLocal("pCoef"),i.i32_const(T)))]),i.call(U+"_square",r,r),i.br_if(1,i.i32_eq(i.getLocal("i"),i.i32_const(1))),i.setLocal("i",i.i32_sub(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.call(n+"_ell",a,o,r)),e.addCode(i.call(U+"_conjugate",r,r))}(),function(){const e=t.addFunction(n+"_finalExponentiationOld");e.addParam("x","i32"),e.addParam("r","i32");const i=t.alloc(oe.bigInt2BytesLE(322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560n,544)),a=e.getCodeBuilder();e.addCode(a.call(U+"_exp",a.getLocal("x"),a.i32_const(i),a.i32_const(544),a.getLocal("r")))}(),function(){!function(){const e=t.addFunction(n+"__cyclotomicSquare");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),a=i.getLocal("x"),o=i.i32_add(i.getLocal("x"),i.i32_const(c)),r=i.i32_add(i.getLocal("x"),i.i32_const(2*c)),s=i.i32_add(i.getLocal("x"),i.i32_const(3*c)),l=i.i32_add(i.getLocal("x"),i.i32_const(4*c)),d=i.i32_add(i.getLocal("x"),i.i32_const(5*c)),u=i.getLocal("r"),g=i.i32_add(i.getLocal("r"),i.i32_const(c)),f=i.i32_add(i.getLocal("r"),i.i32_const(2*c)),h=i.i32_add(i.getLocal("r"),i.i32_const(3*c)),_=i.i32_add(i.getLocal("r"),i.i32_const(4*c)),p=i.i32_add(i.getLocal("r"),i.i32_const(5*c)),L=i.i32_const(t.alloc(c)),y=i.i32_const(t.alloc(c)),A=i.i32_const(t.alloc(c)),b=i.i32_const(t.alloc(c)),I=i.i32_const(t.alloc(c)),w=i.i32_const(t.alloc(c)),C=i.i32_const(t.alloc(c)),x=i.i32_const(t.alloc(c));e.addCode(i.call(m+"_mul",a,l,C),i.call(m+"_mulNR",l,L),i.call(m+"_add",a,L,L),i.call(m+"_add",a,l,x),i.call(m+"_mul",x,L,L),i.call(m+"_mulNR",C,x),i.call(m+"_add",C,x,x),i.call(m+"_sub",L,x,L),i.call(m+"_add",C,C,y),i.call(m+"_mul",s,r,C),i.call(m+"_mulNR",r,A),i.call(m+"_add",s,A,A),i.call(m+"_add",s,r,x),i.call(m+"_mul",x,A,A),i.call(m+"_mulNR",C,x),i.call(m+"_add",C,x,x),i.call(m+"_sub",A,x,A),i.call(m+"_add",C,C,b),i.call(m+"_mul",o,d,C),i.call(m+"_mulNR",d,I),i.call(m+"_add",o,I,I),i.call(m+"_add",o,d,x),i.call(m+"_mul",x,I,I),i.call(m+"_mulNR",C,x),i.call(m+"_add",C,x,x),i.call(m+"_sub",I,x,I),i.call(m+"_add",C,C,w),i.call(m+"_sub",L,a,u),i.call(m+"_add",u,u,u),i.call(m+"_add",L,u,u),i.call(m+"_add",y,l,_),i.call(m+"_add",_,_,_),i.call(m+"_add",y,_,_),i.call(m+"_mul",w,i.i32_const(O),x),i.call(m+"_add",x,s,h),i.call(m+"_add",h,h,h),i.call(m+"_add",x,h,h),i.call(m+"_sub",I,r,f),i.call(m+"_add",f,f,f),i.call(m+"_add",I,f,f),i.call(m+"_sub",A,o,g),i.call(m+"_add",g,g,g),i.call(m+"_add",A,g,g),i.call(m+"_add",b,d,p),i.call(m+"_add",p,p,p),i.call(m+"_add",b,p,p))}(),function(e,i,a){const o=function(t){let e=t;const n=[];for(;e>0n;){if(pe(e)){const t=2-Number(e%4n);n.push(t),e-=BigInt(t)}else n.push(0);e>>=1n}return n}(e).map((t=>-1==t?255:t)),r=t.alloc(o),s=t.addFunction(n+"__cyclotomicExp_"+a);s.addParam("x","i32"),s.addParam("r","i32"),s.addLocal("bit","i32"),s.addLocal("i","i32");const c=s.getCodeBuilder(),d=c.getLocal("x"),u=c.getLocal("r"),g=c.i32_const(t.alloc(l));s.addCode(c.call(U+"_conjugate",d,g),c.call(U+"_one",u),c.if(c.teeLocal("bit",c.i32_load8_s(c.i32_const(o.length-1),r)),c.if(c.i32_eq(c.getLocal("bit"),c.i32_const(1)),c.call(U+"_mul",u,d,u),c.call(U+"_mul",u,g,u))),c.setLocal("i",c.i32_const(o.length-2)),c.block(c.loop(c.call(n+"__cyclotomicSquare",u,u),c.if(c.teeLocal("bit",c.i32_load8_s(c.getLocal("i"),r)),c.if(c.i32_eq(c.getLocal("bit"),c.i32_const(1)),c.call(U+"_mul",u,d,u),c.call(U+"_mul",u,g,u))),c.br_if(1,c.i32_eqz(c.getLocal("i"))),c.setLocal("i",c.i32_sub(c.getLocal("i"),c.i32_const(1))),c.br(0)))),i&&s.addCode(c.call(U+"_conjugate",u,u))}(R,!0,"w0");const e=t.addFunction(n+"_finalExponentiation");e.addParam("x","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),a=i.getLocal("x"),o=i.getLocal("r"),r=i.i32_const(t.alloc(l)),s=i.i32_const(t.alloc(l)),d=i.i32_const(t.alloc(l)),u=i.i32_const(t.alloc(l)),g=i.i32_const(t.alloc(l)),f=i.i32_const(t.alloc(l)),h=i.i32_const(t.alloc(l));e.addCode(i.call(U+"_frobeniusMap6",a,r),i.call(U+"_inverse",a,s),i.call(U+"_mul",r,s,d),i.call(U+"_copy",d,s),i.call(U+"_frobeniusMap2",d,d),i.call(U+"_mul",d,s,d),i.call(n+"__cyclotomicSquare",d,s),i.call(U+"_conjugate",s,s),i.call(n+"__cyclotomicExp_w0",d,u),i.call(n+"__cyclotomicSquare",u,g),i.call(U+"_mul",s,u,f),i.call(n+"__cyclotomicExp_w0",f,s),i.call(n+"__cyclotomicExp_w0",s,r),i.call(n+"__cyclotomicExp_w0",r,h),i.call(U+"_mul",h,g,h),i.call(n+"__cyclotomicExp_w0",h,g),i.call(U+"_conjugate",f,f),i.call(U+"_mul",g,f,g),i.call(U+"_mul",g,d,g),i.call(U+"_conjugate",d,f),i.call(U+"_mul",s,d,s),i.call(U+"_frobeniusMap3",s,s),i.call(U+"_mul",h,f,h),i.call(U+"_frobeniusMap1",h,h),i.call(U+"_mul",u,r,u),i.call(U+"_frobeniusMap2",u,u),i.call(U+"_mul",u,s,u),i.call(U+"_mul",u,h,u),i.call(U+"_mul",u,g,o))}();for(let e=1;e<=5;e++)V(e),t.exportFunction(n+"_pairingEq"+e);!function(){const e=t.addFunction(n+"_pairing");e.addParam("p","i32"),e.addParam("q","i32"),e.addParam("r","i32");const i=e.getCodeBuilder(),a=i.i32_const(t.alloc(l));e.addCode(i.call(n+"_prepareG1",i.getLocal("p"),i.i32_const(G))),e.addCode(i.call(n+"_prepareG2",i.getLocal("q"),i.i32_const(j))),e.addCode(i.call(n+"_millerLoop",i.i32_const(G),i.i32_const(j),a)),e.addCode(i.call(n+"_finalExponentiation",a,i.getLocal("r")))}(),t.exportFunction(n+"_pairing"),t.exportFunction(n+"_prepareG1"),t.exportFunction(n+"_prepareG2"),t.exportFunction(n+"_millerLoop"),t.exportFunction(n+"_finalExponentiation"),t.exportFunction(n+"_finalExponentiationOld"),t.exportFunction(n+"__cyclotomicSquare"),t.exportFunction(n+"__cyclotomicExp_w0"),t.exportFunction(S+"_mul1"),t.exportFunction(S+"_mul01"),t.exportFunction(U+"_mul014"),t.exportFunction(p+"_inGroupAffine"),t.exportFunction(p+"_inGroup"),t.exportFunction(y+"_inGroupAffine"),t.exportFunction(y+"_inGroup")};function Ae(t,e){let n=t;void 0===e&&0==(e=Math.floor((o(t)-1)/8)+1)&&(e=1);const i=new Uint8Array(e),a=new DataView(i.buffer);let r=0;for(;r<e;)r+4<=e?(a.setUint32(r,Number(n&BigInt(4294967295)),!0),r+=4,n>>=BigInt(32)):r+2<=e?(a.setUint16(r,Number(n&BigInt(65535)),!0),r+=2,n>>=BigInt(16)):(a.setUint8(r,Number(n&BigInt(255)),!0),r+=1,n>>=BigInt(8));if(n)throw new Error("Number does not fit in this length");return i}const be=[];for(let t=0;t<256;t++)be[t]=Ie(t,8);function Ie(t,e){let n=0,i=t;for(let t=0;t<e;t++)n<<=1,n|=1&i,i>>=1;return n}function we(t,e){return(be[t>>>24]|be[t>>>16&255]<<8|be[t>>>8&255]<<16|be[255&t]<<24)>>>32-e}function Ce(t){return(4294901760&t?(t&=4294901760,16):0)|(4278255360&t?(t&=4278255360,8):0)|(4042322160&t?(t&=4042322160,4):0)|(3435973836&t?(t&=3435973836,2):0)|!!(2863311530&t)}function xe(t,e){const n=t.byteLength/e,i=Ce(n);if(n!=1<<i)throw new Error("Invalid number of pointers");for(let a=0;a<n;a++){const n=we(a,i);if(a>n){const i=t.slice(a*e,(a+1)*e);t.set(t.slice(n*e,(n+1)*e),a*e),t.set(i,n*e)}}}function Ee(t,e){const n=new Uint8Array(e*t.length);for(let i=0;i<t.length;i++)n.set(t[i],i*e);return n}function Be(t,e){const n=t.byteLength/e,i=new Array(n);for(let a=0;a<n;a++)i[a]=t.slice(a*e,a*e+e);return i}var Fe=Object.freeze({__proto__:null,array2buffer:Ee,beBuff2int:function(t){let e=BigInt(0),n=t.length,i=0;const a=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;n>0;)n>=4?(n-=4,e+=BigInt(a.getUint32(n))<<BigInt(8*i),i+=4):n>=2?(n-=2,e+=BigInt(a.getUint16(n))<<BigInt(8*i),i+=2):(n-=1,e+=BigInt(a.getUint8(n))<<BigInt(8*i),i+=1);return e},beInt2Buff:function(t,e){let n=t;const i=new Uint8Array(e),a=new DataView(i.buffer);let o=e;for(;o>0;)o-4>=0?(o-=4,a.setUint32(o,Number(n&BigInt(4294967295))),n>>=BigInt(32)):o-2>=0?(o-=2,a.setUint16(o,Number(n&BigInt(65535))),n>>=BigInt(16)):(o-=1,a.setUint8(o,Number(n&BigInt(255))),n>>=BigInt(8));if(n)throw new Error("Number does not fit in this length");return i},bitReverse:we,buffReverseBits:xe,buffer2array:Be,leBuff2int:function(t){let e=BigInt(0),n=0;const i=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;n<t.length;)n+4<=t.length?(e+=BigInt(i.getUint32(n,!0))<<BigInt(8*n),n+=4):n+2<=t.length?(e+=BigInt(i.getUint16(n,!0))<<BigInt(8*n),n+=2):(e+=BigInt(i.getUint8(n,!0))<<BigInt(8*n),n+=1);return e},leInt2Buff:Ae,log2:Ce,stringifyBigInts:function t(e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(e instanceof Uint8Array)return F(e,0);if(Array.isArray(e))return e.map(t);if("object"==typeof e){const n={};return Object.keys(e).forEach((i=>{n[i]=t(e[i])})),n}return e},stringifyFElements:function t(e,n){if("bigint"==typeof n||void 0!==n.eq)return n.toString(10);if(n instanceof Uint8Array)return e.toString(e.e(n));if(Array.isArray(n))return n.map(t.bind(this,e));if("object"==typeof n){const i={};return Object.keys(n).forEach((a=>{i[a]=t(e,n[a])})),i}return n},unstringifyBigInts:function t(e){if("string"==typeof e&&/^[0-9]+$/.test(e))return BigInt(e);if("string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return BigInt(e);if(Array.isArray(e))return e.map(t);if("object"==typeof e){if(null===e)return null;const n={};return Object.keys(e).forEach((i=>{n[i]=t(e[i])})),n}return e},unstringifyFElements:function t(e,n){if("string"==typeof n&&/^[0-9]+$/.test(n))return e.e(n);if("string"==typeof n&&/^0x[0-9a-fA-F]+$/.test(n))return e.e(n);if(Array.isArray(n))return n.map(t.bind(this,e));if("object"==typeof n){if(null===n)return null;const i={};return Object.keys(n).forEach((a=>{i[a]=t(e,n[a])})),i}return n}});const ve=1<<30;class Pe{constructor(t){this.buffers=[],this.byteLength=t;for(let e=0;e<t;e+=ve){const n=Math.min(t-e,ve);this.buffers.push(new Uint8Array(n))}}slice(t,e){void 0===e&&(e=this.byteLength),void 0===t&&(t=0);const n=e-t,i=Math.floor(t/ve);if(i==Math.floor((t+n-1)/ve)||0==n)return this.buffers[i].slice(t%ve,t%ve+n);let a,o=i,r=t%ve,s=n;for(;s>0;){const t=r+s>ve?ve-r:s,e=new Uint8Array(this.buffers[o].buffer,this.buffers[o].byteOffset+r,t);if(t==n)return e.slice();a||(a=n<=ve?new Uint8Array(n):new Pe(n)),a.set(e,n-s),s-=t,o++,r=0}return a}set(t,e){void 0===e&&(e=0);const n=t.byteLength;if(0==n)return;const i=Math.floor(e/ve);if(i==Math.floor((e+n-1)/ve))return t instanceof Pe&&1==t.buffers.length?this.buffers[i].set(t.buffers[0],e%ve):this.buffers[i].set(t,e%ve);let a=i,o=e%ve,r=n;for(;r>0;){const e=o+r>ve?ve-o:r,i=t.slice(n-r,n-r+e);new Uint8Array(this.buffers[a].buffer,this.buffers[a].byteOffset+o,e).set(i),r-=e,a++,o=0}}}function Oe(t,e,n,i){return async function(a){const o=Math.floor(a.byteLength/n);if(o*n!==a.byteLength)throw new Error("Invalid buffer size");const r=Math.floor(o/t.concurrency),s=[];for(let c=0;c<t.concurrency;c++){let l;if(l=c<t.concurrency-1?r:o-c*r,0==l)continue;const d=[{cmd:"ALLOCSET",var:0,buff:a.slice(c*r*n,c*r*n+l*n)},{cmd:"ALLOC",var:1,len:i*l},{cmd:"CALL",fnName:e,params:[{var:0},{val:l},{var:1}]},{cmd:"GET",out:0,var:1,len:i*l}];s.push(t.queueAction(d))}const c=await Promise.all(s);let l;l=a instanceof Pe?new Pe(o*i):new Uint8Array(o*i);let d=0;for(let t=0;t<c.length;t++)l.set(c[t][0],d),d+=c[t][0].byteLength;return l}}class Se{constructor(t,e,n,i){if(this.tm=t,this.prefix=e,this.p=i,this.n8=n,this.type="F1",this.m=1,this.half=l(i,U),this.bitLength=o(i),this.mask=p(c(U,this.bitLength),U),this.pOp1=t.alloc(n),this.pOp2=t.alloc(n),this.pOp3=t.alloc(n),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(n/8),this.n32=Math.floor(n/4),8*this.n64!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=l(this.p,U),this.nqr=this.two;let a=this.exp(this.nqr,this.half);for(;!this.eq(a,this.negone);)this.nqr=this.add(this.nqr,this.one),a=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let r=p(this.p,U);for(;!g(r);)this.s=this.s+1,r=l(r,U);this.w=[],this.w[this.s]=this.exp(this.nqr,r);for(let t=this.s-1;t>=0;t--)this.w[t]=this.square(this.w[t+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=Oe(t,e+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=Oe(t,e+"_batchFromMontgomery",this.n8,this.n8)}op2(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=O(a(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,e){if(t instanceof Uint8Array)return t;let n=a(t,e);r(n)?(n=m(n),w(n,this.p)&&(n=b(n,this.p)),n=p(this.p,n)):w(n,this.p)&&(n=b(n,this.p));const i=Ae(n,this.n8);return this.toMontgomery(i)}toString(t,e){return P(F(this.fromMontgomery(t),0),e)}fromRng(t){let e;const n=new Uint8Array(this.n8);do{e=S;for(let n=0;n<this.n64;n++)e=_(e,c(t.nextU64(),64*n));e=x(e,this.mask)}while(C(e,this.p));return E(n,0,e,this.n8),n}random(){return this.fromRng(z())}toObject(t){return F(this.fromMontgomery(t),0)}fromObject(t){const e=new Uint8Array(this.n8);return E(e,0,t,this.n8),this.toMontgomery(e)}toRprLE(t,e,n){t.set(this.fromMontgomery(n),e)}toRprBE(t,e,n){const i=this.fromMontgomery(n);for(let t=0;t<this.n8/2;t++){const e=i[t];i[t]=i[this.n8-1-t],i[this.n8-1-t]=e}t.set(i,e)}fromRprLE(t,e){e=e||0;const n=t.slice(e,e+this.n8);return this.toMontgomery(n)}async batchInverse(t){let e=!1;const n=this.n8,i=this.n8;Array.isArray(t)?(t=Ee(t,n),e=!0):t=t.slice(0,t.byteLength);const a=Math.floor(t.byteLength/n);if(a*n!==t.byteLength)throw new Error("Invalid buffer size");const o=Math.floor(a/this.tm.concurrency),r=[];for(let e=0;e<this.tm.concurrency;e++){let s;if(s=e<this.tm.concurrency-1?o:a-e*o,0==s)continue;const c=[{cmd:"ALLOCSET",var:0,buff:t.slice(e*o*n,e*o*n+s*n)},{cmd:"ALLOC",var:1,len:i*s},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:n},{val:s},{var:1},{val:i}]},{cmd:"GET",out:0,var:1,len:i*s}];r.push(this.tm.queueAction(c))}const s=await Promise.all(r);let c;c=t instanceof Pe?new Pe(a*i):new Uint8Array(a*i);let l=0;for(let t=0;t<s.length;t++)c.set(s[t][0],l),l+=s[t][0].byteLength;return e?Be(c,i):c}}class Ue{constructor(t,e,n){this.tm=t,this.prefix=e,this.F=n,this.type="F2",this.m=2*n.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=t.alloc(2*n.n8),this.pOp2=t.alloc(2*n.n8),this.pOp3=t.alloc(2*n.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}mul1(t,e){return this.op2("_mul1",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=O(a(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&2==t.length){const n=this.F.e(t[0],e),i=this.F.e(t[1],e),a=new Uint8Array(2*this.F.n8);return a.set(n),a.set(i,2*this.F.n8),a}throw new Error("invalid F2")}toString(t,e){return`[${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8),e)}]`}fromRng(t){const e=this.F.fromRng(t),n=this.F.fromRng(t),i=new Uint8Array(2*this.F.n8);return i.set(e),i.set(n,this.F.n8),i}random(){return this.fromRng(z())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8))]}fromObject(t){const e=new Uint8Array(2*this.F.n8),n=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]);return e.set(n),e.set(i,this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class Qe{constructor(t,e,n){this.tm=t,this.prefix=e,this.F=n,this.type="F3",this.m=3*n.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=t.alloc(3*n.n8),this.pOp2=t.alloc(3*n.n8),this.pOp3=t.alloc(3*n.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}add(t,e){return this.op2("_add",t,e)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=O(a(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&3==t.length){const n=this.F.e(t[0],e),i=this.F.e(t[1],e),a=this.F.e(t[2],e),o=new Uint8Array(3*this.F.n8);return o.set(n),o.set(i,this.F.n8),o.set(a,2*this.F.n8),o}throw new Error("invalid F3")}toString(t,e){return`[${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),e)}, ${this.F.toString(t.slice(2*this.F.n8),e)}]`}fromRng(t){const e=this.F.fromRng(t),n=this.F.fromRng(t),i=this.F.fromRng(t),a=new Uint8Array(3*this.F.n8);return a.set(e),a.set(n,this.F.n8),a.set(i,2*this.F.n8),a}random(){return this.fromRng(z())}toObject(t){return[this.F.toObject(t.slice(0,this.F.n8)),this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8))]}fromObject(t){const e=new Uint8Array(3*this.F.n8),n=this.F.fromObject(t[0]),i=this.F.fromObject(t[1]),a=this.F.fromObject(t[2]);return e.set(n),e.set(i,this.F.n8),e.set(a,2*this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,2*this.F.n8)}c3(t){return t.slice(2*this.F.n8)}}class ke{constructor(t,e,n,i,a,o){this.tm=t,this.prefix=e,this.F=n,this.pOp1=t.alloc(3*n.n8),this.pOp2=t.alloc(3*n.n8),this.pOp3=t.alloc(3*n.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*n.n8),this.tm.instance.exports[e+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*n.n8),this.one=this.tm.getBuff(i,3*n.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(i,2*n.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(a,n.n8),o&&(this.cofactor=O(o)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=Oe(t,e+"_batchLEMtoC",2*n.n8,n.n8),this.batchLEMtoU=Oe(t,e+"_batchLEMtoU",2*n.n8,2*n.n8),this.batchCtoLEM=Oe(t,e+"_batchCtoLEM",n.n8,2*n.n8),this.batchUtoLEM=Oe(t,e+"_batchUtoLEM",2*n.n8,2*n.n8),this.batchToJacobian=Oe(t,e+"_batchToJacobian",2*n.n8,3*n.n8),this.batchToAffine=Oe(t,e+"_batchToAffine",3*n.n8,2*n.n8)}op2(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_add",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_addMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_addMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_addAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}sub(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_sub",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_subMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_subMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_subAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}neg(t){if(t.byteLength==3*this.F.n8)return this.op1("_neg",t);if(t.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==3*this.F.n8)return this.op1("_double",t);if(t.byteLength==2*this.F.n8)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==3*this.F.n8)return this.op1Bool("_isZero",t);if(t.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,e){let n;if(e instanceof Uint8Array||(e=O(a(e))),t.byteLength==3*this.F.n8)n=this.prefix+"_timesScalar";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");n=this.prefix+"_timesScalarAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[n](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(t,e){let n;if(t.byteLength==3*this.F.n8)n=this.prefix+"_timesFr";else{if(t.byteLength!=2*this.F.n8)throw new Error("invalid point size");n=this.prefix+"_timesFrAffine"}return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[n](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eq",t,e);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",t,e);throw new Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",t,e);throw new Error("invalid point size")}throw new Error("invalid point size")}toAffine(t){if(t.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",t);if(t.byteLength==2*this.F.n8)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==3*this.F.n8)return t;if(t.byteLength==2*this.F.n8)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,e,n){if(this.tm.setBuff(this.pOp1,n),n.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(n.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,e)}fromRprUncompressed(t,e){const n=t.slice(e,e+2*this.F.n8);return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(t,e,n){if(this.tm.setBuff(this.pOp1,n),n.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(n.byteLength!=2*this.F.n8)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,this.F.n8);t.set(i,e)}fromRprCompressed(t,e){const n=t.slice(e,e+this.F.n8);return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(t){const e=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(e,0,t),e}toRprLEM(t,e,n){if(n.byteLength!=2*this.F.n8){if(n.byteLength!=3*this.F.n8)throw new Error("invalid point size");{this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const i=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(i,e)}}else t.set(n,e)}fromRprLEM(t,e){return e=e||0,t.slice(e,e+2*this.F.n8)}toString(t,e){if(t.byteLength==3*this.F.n8)return`[ ${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8,2*this.F.n8),e)}, ${this.F.toString(t.slice(2*this.F.n8),e)} ]`;if(t.byteLength==2*this.F.n8)return`[ ${this.F.toString(t.slice(0,this.F.n8),e)}, ${this.F.toString(t.slice(this.F.n8),e)} ]`;throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;const e=this.F,n=this.toAffine(t),i=n.slice(0,this.F.n8),a=n.slice(this.F.n8,2*this.F.n8),o=e.add(e.mul(e.square(i),i),this.b),r=e.square(a);return e.eq(o,r)}fromRng(t){const e=this.F;let n,i,a=[];do{a[0]=e.fromRng(t),n=t.nextBool(),i=e.add(e.mul(e.square(a[0]),a[0]),this.b)}while(!e.isSquare(i));a[1]=e.sqrt(i),n^e.isNegative(a[1])&&(a[1]=e.neg(a[1]));let o=new Uint8Array(2*this.F.n8);return o.set(a[0]),o.set(a[1],this.F.n8),this.cofactor&&(o=this.timesScalar(o,this.cofactor)),o}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const e=this.F.toObject(t.slice(0,this.F.n8)),n=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));let i;return i=t.byteLength==3*this.F.n8?this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one),[e,n,i]}fromObject(t){const e=this.F.fromObject(t[0]),n=this.F.fromObject(t[1]);let i;if(i=3==t.length?this.F.fromObject(t[2]):this.F.one,this.F.isZero(i,this.F.one))return this.zeroAffine;if(this.F.eq(i,this.F.one)){const t=new Uint8Array(2*this.F.n8);return t.set(e),t.set(n,this.F.n8),t}{const t=new Uint8Array(3*this.F.n8);return t.set(e),t.set(n,this.F.n8),t.set(i,2*this.F.n8),t}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}const Te=25;class Ne{constructor(){this.promise=new Promise(((t,e)=>{this.reject=e,this.resolve=t}))}}let qe;const Me='(function thread(self) {\n    const MAXMEM = 32767;\n    let instance;\n    let memory;\n\n    if (self) {\n        self.onmessage = function(e) {\n            let data;\n            if (e.data) {\n                data = e.data;\n            } else {\n                data = e;\n            }\n\n            if (data[0].cmd == "INIT") {\n                init(data[0]).then(function() {\n                    self.postMessage(data.result);\n                });\n            } else if (data[0].cmd == "TERMINATE") {\n                self.close();\n            } else {\n                const res = runTask(data);\n                self.postMessage(res);\n            }\n        };\n    }\n\n    async function init(data) {\n        const code = new Uint8Array(data.code);\n        const wasmModule = await WebAssembly.compile(code);\n        memory = new WebAssembly.Memory({initial:data.init, maximum: MAXMEM});\n\n        instance = await WebAssembly.instantiate(wasmModule, {\n            env: {\n                "memory": memory\n            }\n        });\n    }\n\n\n\n    function alloc(length) {\n        const u32 = new Uint32Array(memory.buffer, 0, 1);\n        while (u32[0] & 3) u32[0]++;  // Return always aligned pointers\n        const res = u32[0];\n        u32[0] += length;\n        if (u32[0] + length > memory.buffer.byteLength) {\n            const currentPages = memory.buffer.byteLength / 0x10000;\n            let requiredPages = Math.floor((u32[0] + length) / 0x10000)+1;\n            if (requiredPages>MAXMEM) requiredPages=MAXMEM;\n            memory.grow(requiredPages-currentPages);\n        }\n        return res;\n    }\n\n    function allocBuffer(buffer) {\n        const p = alloc(buffer.byteLength);\n        setBuffer(p, buffer);\n        return p;\n    }\n\n    function getBuffer(pointer, length) {\n        const u8 = new Uint8Array(memory.buffer);\n        return new Uint8Array(u8.buffer, u8.byteOffset + pointer, length);\n    }\n\n    function setBuffer(pointer, buffer) {\n        const u8 = new Uint8Array(memory.buffer);\n        u8.set(new Uint8Array(buffer), pointer);\n    }\n\n    function runTask(task) {\n        if (task[0].cmd == "INIT") {\n            return init(task[0]);\n        }\n        const ctx = {\n            vars: [],\n            out: []\n        };\n        const u32a = new Uint32Array(memory.buffer, 0, 1);\n        const oldAlloc = u32a[0];\n        for (let i=0; i<task.length; i++) {\n            switch (task[i].cmd) {\n            case "ALLOCSET":\n                ctx.vars[task[i].var] = allocBuffer(task[i].buff);\n                break;\n            case "ALLOC":\n                ctx.vars[task[i].var] = alloc(task[i].len);\n                break;\n            case "SET":\n                setBuffer(ctx.vars[task[i].var], task[i].buff);\n                break;\n            case "CALL": {\n                const params = [];\n                for (let j=0; j<task[i].params.length; j++) {\n                    const p = task[i].params[j];\n                    if (typeof p.var !== "undefined") {\n                        params.push(ctx.vars[p.var] + (p.offset || 0));\n                    } else if (typeof p.val != "undefined") {\n                        params.push(p.val);\n                    }\n                }\n                instance.exports[task[i].fnName](...params);\n                break;\n            }\n            case "GET":\n                ctx.out[task[i].out] = getBuffer(ctx.vars[task[i].var], task[i].len).slice();\n                break;\n            default:\n                throw new Error("Invalid cmd");\n            }\n        }\n        const u32b = new Uint32Array(memory.buffer, 0, 1);\n        u32b[0] = oldAlloc;\n        return ctx.out;\n    }\n\n\n    return runTask;\n})(self)';if(globalThis?.Blob){const t=(new TextEncoder).encode(Me),e=new Blob([t],{type:"application/javascript"});qe=URL.createObjectURL(e)}else qe="data:application/javascript;base64,"+globalThis.btoa(Me);class De{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,e,n,i){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=i||new Ne,this.workers[t].postMessage(e,n),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(0==this.working[t]){const e=this.actionQueue.shift();this.postAction(t,e.data,e.transfers,e.deferred)}}queueAction(t,e){const n=new Ne;if(this.singleThread){const e=this.taskManager(t);n.resolve(e)}else this.actionQueue.push({data:t,transfers:e,deferred:n}),this.processWorks();return n.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){const e=this.alloc(t.byteLength);return this.setBuff(e,t),e}getBuff(t,e){return this.u8.slice(t,t+e)}setBuff(t,e){this.u8.set(new Uint8Array(e),t)}alloc(t){for(;3&this.u32[0];)this.u32[0]++;const e=this.u32[0];return this.u32[0]+=t,e}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await new Promise((t=>setTimeout(t,200)))}}function Re(t,e){const n=t[e],i=t.Fr,a=t.tm;t[e].batchApplyKey=async function(t,o,r,s,c){let l,d,u,g,f;if(s=s||"affine",c=c||"affine","G1"==e)"jacobian"==s?(u=3*n.F.n8,l="g1m_batchApplyKey"):(u=2*n.F.n8,l="g1m_batchApplyKeyMixed"),g=3*n.F.n8,"jacobian"==c?f=3*n.F.n8:(d="g1m_batchToAffine",f=2*n.F.n8);else if("G2"==e)"jacobian"==s?(u=3*n.F.n8,l="g2m_batchApplyKey"):(u=2*n.F.n8,l="g2m_batchApplyKeyMixed"),g=3*n.F.n8,"jacobian"==c?f=3*n.F.n8:(d="g2m_batchToAffine",f=2*n.F.n8);else{if("Fr"!=e)throw new Error("Invalid group: "+e);l="frm_batchApplyKey",u=n.n8,g=n.n8,f=n.n8}const h=Math.floor(t.byteLength/u),_=Math.floor(h/a.concurrency),p=[];r=i.e(r);let m=i.e(o);for(let e=0;e<a.concurrency;e++){let n;if(n=e<a.concurrency-1?_:h-e*_,0==n)continue;const o=[];o.push({cmd:"ALLOCSET",var:0,buff:t.slice(e*_*u,e*_*u+n*u)}),o.push({cmd:"ALLOCSET",var:1,buff:m}),o.push({cmd:"ALLOCSET",var:2,buff:r}),o.push({cmd:"ALLOC",var:3,len:n*Math.max(g,f)}),o.push({cmd:"CALL",fnName:l,params:[{var:0},{val:n},{var:1},{var:2},{var:3}]}),d&&o.push({cmd:"CALL",fnName:d,params:[{var:3},{val:n},{var:3}]}),o.push({cmd:"GET",out:0,var:3,len:n*f}),p.push(a.queueAction(o)),m=i.mul(m,i.exp(r,n))}const L=await Promise.all(p);let y;y=t instanceof Pe?new Pe(h*f):new Uint8Array(h*f);let A=0;for(let t=0;t<L.length;t++)y.set(L[t][0],A),A+=L[t][0].byteLength;return y}}const ze=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function Ge(t,e){const n=t[e],i=n.tm;async function a(t,i,a,o,r){if(!(t instanceof Uint8Array))throw o&&o.error(`${r} _multiExpChunk buffBases is not Uint8Array`),new Error(`${r} _multiExpChunk buffBases is not Uint8Array`);if(!(i instanceof Uint8Array))throw o&&o.error(`${r} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${r} _multiExpChunk buffScalars is not Uint8Array`);let s,c;if(a=a||"affine","G1"==e)"affine"==a?(c="g1m_multiexpAffine_chunk",s=2*n.F.n8):(c="g1m_multiexp_chunk",s=3*n.F.n8);else{if("G2"!=e)throw new Error("Invalid group");"affine"==a?(c="g2m_multiexpAffine_chunk",s=2*n.F.n8):(c="g2m_multiexp_chunk",s=3*n.F.n8)}const l=Math.floor(t.byteLength/s);if(0==l)return n.zero;const d=Math.floor(i.byteLength/l);if(d*l!=i.byteLength)throw new Error("Scalar size does not match");const u=ze[Ce(l)],g=Math.floor((8*d-1)/u)+1,f=[];for(let e=0;e<g;e++){const a=[{cmd:"ALLOCSET",var:0,buff:t},{cmd:"ALLOCSET",var:1,buff:i},{cmd:"ALLOC",var:2,len:3*n.F.n8},{cmd:"CALL",fnName:c,params:[{var:0},{var:1},{val:d},{val:l},{val:e*u},{val:Math.min(8*d-e*u,u)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*n.F.n8}];f.push(n.tm.queueAction(a))}const h=await Promise.all(f);let _=n.zero;for(let t=h.length-1;t>=0;t--){if(!n.isZero(_))for(let t=0;t<u;t++)_=n.double(_);_=n.add(_,h[t][0])}return _}async function o(t,o,r,s,c){const l=1<<22;let d;if("G1"==e)d="affine"==r?2*n.F.n8:3*n.F.n8;else{if("G2"!=e)throw new Error("Invalid group");d="affine"==r?2*n.F.n8:3*n.F.n8}const u=Math.floor(t.byteLength/d),g=Math.floor(o.byteLength/u);if(g*u!=o.byteLength)throw new Error("Scalar size does not match");const f=ze[Ce(u)],h=Math.floor((8*g-1)/f)+1;let _;_=Math.floor(u/(i.concurrency/h)),_>l&&(_=l),_<1024&&(_=1024);const p=[];for(let e=0;e<u;e+=_){s&&s.debug(`Multiexp start: ${c}: ${e}/${u}`);const n=Math.min(u-e,_),i=t.slice(e*d,(e+n)*d),l=o.slice(e*g,(e+n)*g);p.push(a(i,l,r,s,c).then((t=>(s&&s.debug(`Multiexp end: ${c}: ${e}/${u}`),t))))}const m=await Promise.all(p);let L=n.zero;for(let t=m.length-1;t>=0;t--)L=n.add(L,m[t]);return L}n.multiExp=async function(t,e,n,i){return await o(t,e,"jacobian",n,i)},n.multiExpAffine=async function(t,e,n,i){return await o(t,e,"affine",n,i)}}function je(t,e){const n=t[e],i=t.Fr,a=n.tm;async function o(t,s,c,l,d,u){let g,f,h,_,p,m,L,y;c=c||"affine",l=l||"affine","G1"==e?("affine"==c?(g=2*n.F.n8,_="g1m_batchToJacobian"):g=3*n.F.n8,f=3*n.F.n8,s&&(y="g1m_fftFinal"),L="g1m_fftJoin",m="g1m_fftMix","affine"==l?(h=2*n.F.n8,p="g1m_batchToAffine"):h=3*n.F.n8):"G2"==e?("affine"==c?(g=2*n.F.n8,_="g2m_batchToJacobian"):g=3*n.F.n8,f=3*n.F.n8,s&&(y="g2m_fftFinal"),L="g2m_fftJoin",m="g2m_fftMix","affine"==l?(h=2*n.F.n8,p="g2m_batchToAffine"):h=3*n.F.n8):"Fr"==e&&(g=n.n8,f=n.n8,h=n.n8,s&&(y="frm_fftFinal"),m="frm_fftMix",L="frm_fftJoin");let A=!1;Array.isArray(t)?(t=Ee(t,g),A=!0):t=t.slice(0,t.byteLength);const b=t.byteLength/g,I=Ce(b);if(1<<I!=b)throw new Error("fft must be multiple of 2");if(I==i.s+1){let e;return e=s?await async function(t,e,n,a,s){let c,l;c=t.slice(0,t.byteLength/2),l=t.slice(t.byteLength/2,t.byteLength);const d=[];d.push(o(c,!0,e,"jacobian",a,s)),d.push(o(l,!0,e,"jacobian",a,s)),[c,l]=await Promise.all(d);const u=await r(c,l,"fftJoinExtInv",i.one,i.shiftInv,"jacobian",n,a,s);let g;return g=u[0].byteLength>1<<28?new Pe(2*u[0].byteLength):new Uint8Array(2*u[0].byteLength),g.set(u[0]),g.set(u[1],u[0].byteLength),g}(t,c,l,d,u):await async function(t,e,n,a,s){let c,l;c=t.slice(0,t.byteLength/2),l=t.slice(t.byteLength/2,t.byteLength);const d=[];[c,l]=await r(c,l,"fftJoinExt",i.one,i.shift,e,"jacobian",a,s),d.push(o(c,!1,"jacobian",n,a,s)),d.push(o(l,!1,"jacobian",n,a,s));const u=await Promise.all(d);let g;return g=u[0].byteLength>1<<28?new Pe(2*u[0].byteLength):new Uint8Array(2*u[0].byteLength),g.set(u[0]),g.set(u[1],u[0].byteLength),g}(t,c,l,d,u),A?Be(e,h):e}let w,C,x;s&&(w=i.inv(i.e(b))),xe(t,g);let E=Math.min(16384,b),B=b/E;for(;B<a.concurrency&&E>=16;)B*=2,E/=2;const F=Ce(E),v=[];for(let e=0;e<B;e++){d&&d.debug(`${u}: fft ${I} mix start: ${e}/${B}`);const n=[];n.push({cmd:"ALLOC",var:0,len:f*E});const i=t.slice(E*e*g,E*(e+1)*g);n.push({cmd:"SET",var:0,buff:i}),_&&n.push({cmd:"CALL",fnName:_,params:[{var:0},{val:E},{var:0}]});for(let t=1;t<=F;t++)n.push({cmd:"CALL",fnName:m,params:[{var:0},{val:E},{val:t}]});F==I?(y&&(n.push({cmd:"ALLOCSET",var:1,buff:w}),n.push({cmd:"CALL",fnName:y,params:[{var:0},{val:E},{var:1}]})),p&&n.push({cmd:"CALL",fnName:p,params:[{var:0},{val:E},{var:0}]}),n.push({cmd:"GET",out:0,var:0,len:E*h})):n.push({cmd:"GET",out:0,var:0,len:f*E}),v.push(a.queueAction(n).then((t=>(d&&d.debug(`${u}: fft ${I} mix end: ${e}/${B}`),t))))}x=await Promise.all(v);for(let t=0;t<B;t++)x[t]=x[t][0];for(let t=F+1;t<=I;t++){d&&d.debug(`${u}: fft  ${I}  join: ${t}/${I}`);const e=1<<I-t,n=B/e,o=[];for(let r=0;r<e;r++)for(let s=0;s<n/2;s++){const c=i.exp(i.w[t],s*E),l=i.w[t],g=r*n+s,_=r*n+s+n/2,m=[];m.push({cmd:"ALLOCSET",var:0,buff:x[g]}),m.push({cmd:"ALLOCSET",var:1,buff:x[_]}),m.push({cmd:"ALLOCSET",var:2,buff:c}),m.push({cmd:"ALLOCSET",var:3,buff:l}),m.push({cmd:"CALL",fnName:L,params:[{var:0},{var:1},{val:E},{var:2},{var:3}]}),t==I?(y&&(m.push({cmd:"ALLOCSET",var:4,buff:w}),m.push({cmd:"CALL",fnName:y,params:[{var:0},{val:E},{var:4}]}),m.push({cmd:"CALL",fnName:y,params:[{var:1},{val:E},{var:4}]})),p&&(m.push({cmd:"CALL",fnName:p,params:[{var:0},{val:E},{var:0}]}),m.push({cmd:"CALL",fnName:p,params:[{var:1},{val:E},{var:1}]})),m.push({cmd:"GET",out:0,var:0,len:E*h}),m.push({cmd:"GET",out:1,var:1,len:E*h})):(m.push({cmd:"GET",out:0,var:0,len:E*f}),m.push({cmd:"GET",out:1,var:1,len:E*f})),o.push(a.queueAction(m).then((i=>(d&&d.debug(`${u}: fft ${I} join  ${t}/${I}  ${r+1}/${e} ${s}/${n/2}`),i))))}const r=await Promise.all(o);for(let t=0;t<e;t++)for(let e=0;e<n/2;e++){const i=t*n+e,a=t*n+e+n/2,o=r.shift();x[i]=o[0],x[a]=o[1]}}if(C=t instanceof Pe?new Pe(b*h):new Uint8Array(b*h),s){C.set(x[0].slice((E-1)*h));let t=h;for(let e=B-1;e>0;e--)C.set(x[e],t),t+=E*h,delete x[e];C.set(x[0].slice(0,(E-1)*h),t),delete x[0]}else for(let t=0;t<B;t++)C.set(x[t],E*h*t),delete x[t];return A?Be(C,h):C}async function r(t,o,r,s,c,l,d,u,g){let f,h,_,p,m,L;if("G1"==e)"affine"==l?(m=2*n.F.n8,h="g1m_batchToJacobian"):m=3*n.F.n8,L=3*n.F.n8,f="g1m_"+r,"affine"==d?(_="g1m_batchToAffine",p=2*n.F.n8):p=3*n.F.n8;else if("G2"==e)"affine"==l?(m=2*n.F.n8,h="g2m_batchToJacobian"):m=3*n.F.n8,f="g2m_"+r,L=3*n.F.n8,"affine"==d?(_="g2m_batchToAffine",p=2*n.F.n8):p=3*n.F.n8;else{if("Fr"!=e)throw new Error("Invalid group");m=i.n8,p=i.n8,L=i.n8,f="frm_"+r}if(t.byteLength!=o.byteLength)throw new Error("Invalid buffer size");const y=Math.floor(t.byteLength/m);if(y!=1<<Ce(y))throw new Error("Invalid number of points");let A=Math.floor(y/a.concurrency);A<16&&(A=16),A>65536&&(A=65536);const b=[];for(let e=0;e<y;e+=A){u&&u.debug(`${g}: fftJoinExt Start: ${e}/${y}`);const n=Math.min(y-e,A),r=i.mul(s,i.exp(c,e)),l=[],d=t.slice(e*m,(e+n)*m),I=o.slice(e*m,(e+n)*m);l.push({cmd:"ALLOC",var:0,len:L*n}),l.push({cmd:"SET",var:0,buff:d}),l.push({cmd:"ALLOC",var:1,len:L*n}),l.push({cmd:"SET",var:1,buff:I}),l.push({cmd:"ALLOCSET",var:2,buff:r}),l.push({cmd:"ALLOCSET",var:3,buff:c}),h&&(l.push({cmd:"CALL",fnName:h,params:[{var:0},{val:n},{var:0}]}),l.push({cmd:"CALL",fnName:h,params:[{var:1},{val:n},{var:1}]})),l.push({cmd:"CALL",fnName:f,params:[{var:0},{var:1},{val:n},{var:2},{var:3},{val:i.s}]}),_&&(l.push({cmd:"CALL",fnName:_,params:[{var:0},{val:n},{var:0}]}),l.push({cmd:"CALL",fnName:_,params:[{var:1},{val:n},{var:1}]})),l.push({cmd:"GET",out:0,var:0,len:n*p}),l.push({cmd:"GET",out:1,var:1,len:n*p}),b.push(a.queueAction(l).then((t=>(u&&u.debug(`${g}: fftJoinExt End: ${e}/${y}`),t))))}const I=await Promise.all(b);let w,C;y*p>1<<28?(w=new Pe(y*p),C=new Pe(y*p)):(w=new Uint8Array(y*p),C=new Uint8Array(y*p));let x=0;for(let t=0;t<I.length;t++)w.set(I[t][0],x),C.set(I[t][1],x),x+=I[t][0].byteLength;return[w,C]}n.fft=async function(t,e,n,i,a){return await o(t,!1,e,n,i,a)},n.ifft=async function(t,e,n,i,a){return await o(t,!0,e,n,i,a)},n.lagrangeEvaluations=async function(t,a,s,c,l){let d;if(a=a||"affine",s=s||"affine","G1"==e)d="affine"==a?2*n.F.n8:3*n.F.n8;else if("G2"==e)d="affine"==a?2*n.F.n8:3*n.F.n8;else{if("Fr"!=e)throw new Error("Invalid group");d=i.n8}const u=t.byteLength/d,g=Ce(u);if(2**g*d!=t.byteLength)throw c&&c.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(g<=i.s)return await n.ifft(t,a,s,c,l);if(g>i.s+1)throw c&&c.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let f=t.slice(0,t.byteLength/2),h=t.slice(t.byteLength/2,t.byteLength);const _=i.exp(i.shift,u/2),p=i.inv(i.sub(i.one,_));[f,h]=await r(f,h,"prepareLagrangeEvaluation",p,i.shiftInv,a,"jacobian",c,l+" prep");const m=[];let L;return m.push(o(f,!0,"jacobian",s,c,l+" t0")),m.push(o(h,!0,"jacobian",s,c,l+" t1")),[f,h]=await Promise.all(m),L=f.byteLength>1<<28?new Pe(2*f.byteLength):new Uint8Array(2*f.byteLength),L.set(f),L.set(h,f.byteLength),L},n.fftMix=async function(t){const o=3*n.F.n8;let r,s;if("G1"==e)r="g1m_fftMix",s="g1m_fftJoin";else if("G2"==e)r="g2m_fftMix",s="g2m_fftJoin";else{if("Fr"!=e)throw new Error("Invalid group");r="frm_fftMix",s="frm_fftJoin"}const c=Math.floor(t.byteLength/o),l=Ce(c);let d=1<<Ce(a.concurrency);c<=2*d&&(d=1);const u=c/d,g=Ce(u),f=[];for(let e=0;e<d;e++){const n=[],i=t.slice(e*u*o,(e+1)*u*o);n.push({cmd:"ALLOCSET",var:0,buff:i});for(let t=1;t<=g;t++)n.push({cmd:"CALL",fnName:r,params:[{var:0},{val:u},{val:t}]});n.push({cmd:"GET",out:0,var:0,len:u*o}),f.push(a.queueAction(n))}const h=await Promise.all(f),_=[];for(let t=0;t<h.length;t++)_[t]=h[t][0];for(let t=g+1;t<=l;t++){const e=1<<l-t,n=d/e,r=[];for(let c=0;c<e;c++)for(let e=0;e<n/2;e++){const l=i.exp(i.w[t],e*u),d=i.w[t],g=c*n+e,f=c*n+e+n/2,h=[];h.push({cmd:"ALLOCSET",var:0,buff:_[g]}),h.push({cmd:"ALLOCSET",var:1,buff:_[f]}),h.push({cmd:"ALLOCSET",var:2,buff:l}),h.push({cmd:"ALLOCSET",var:3,buff:d}),h.push({cmd:"CALL",fnName:s,params:[{var:0},{var:1},{val:u},{var:2},{var:3}]}),h.push({cmd:"GET",out:0,var:0,len:u*o}),h.push({cmd:"GET",out:1,var:1,len:u*o}),r.push(a.queueAction(h))}const c=await Promise.all(r);for(let t=0;t<e;t++)for(let e=0;e<n/2;e++){const i=t*n+e,a=t*n+e+n/2,o=c.shift();_[i]=o[0],_[a]=o[1]}}let p;p=t instanceof Pe?new Pe(c*o):new Uint8Array(c*o);let m=0;for(let t=0;t<d;t++)p.set(_[t],m),m+=_[t].byteLength;return p},n.fftJoin=async function(t,o,r,s){const c=3*n.F.n8;let l;if("G1"==e)l="g1m_fftJoin";else if("G2"==e)l="g2m_fftJoin";else{if("Fr"!=e)throw new Error("Invalid group");l="frm_fftJoin"}if(t.byteLength!=o.byteLength)throw new Error("Invalid buffer size");const d=Math.floor(t.byteLength/c);if(d!=1<<Ce(d))throw new Error("Invalid number of points");let u=1<<Ce(a.concurrency);d<=2*u&&(u=1);const g=d/u,f=[];for(let e=0;e<u;e++){const n=[],d=i.mul(r,i.exp(s,e*g)),u=t.slice(e*g*c,(e+1)*g*c),h=o.slice(e*g*c,(e+1)*g*c);n.push({cmd:"ALLOCSET",var:0,buff:u}),n.push({cmd:"ALLOCSET",var:1,buff:h}),n.push({cmd:"ALLOCSET",var:2,buff:d}),n.push({cmd:"ALLOCSET",var:3,buff:s}),n.push({cmd:"CALL",fnName:l,params:[{var:0},{var:1},{val:g},{var:2},{var:3}]}),n.push({cmd:"GET",out:0,var:0,len:g*c}),n.push({cmd:"GET",out:1,var:1,len:g*c}),f.push(a.queueAction(n))}const h=await Promise.all(f);let _,p;t instanceof Pe?(_=new Pe(d*c),p=new Pe(d*c)):(_=new Uint8Array(d*c),p=new Uint8Array(d*c));let m=0;for(let t=0;t<h.length;t++)_.set(h[t][0],m),p.set(h[t][1],m),m+=h[t][0].byteLength;return[_,p]},n.fftFinal=async function(t,i){const o=3*n.F.n8,r=2*n.F.n8;let s,c;if("G1"==e)s="g1m_fftFinal",c="g1m_batchToAffine";else{if("G2"!=e)throw new Error("Invalid group");s="g2m_fftFinal",c="g2m_batchToAffine"}const l=Math.floor(t.byteLength/o);if(l!=1<<Ce(l))throw new Error("Invalid number of points");const d=Math.floor(l/a.concurrency),u=[];for(let e=0;e<a.concurrency;e++){let n;if(n=e<a.concurrency-1?d:l-e*d,0==n)continue;const g=[],f=t.slice(e*d*o,(e*d+n)*o);g.push({cmd:"ALLOCSET",var:0,buff:f}),g.push({cmd:"ALLOCSET",var:1,buff:i}),g.push({cmd:"CALL",fnName:s,params:[{var:0},{val:n},{var:1}]}),g.push({cmd:"CALL",fnName:c,params:[{var:0},{val:n},{var:0}]}),g.push({cmd:"GET",out:0,var:0,len:n*r}),u.push(a.queueAction(g))}const g=await Promise.all(u);let f;f=t instanceof Pe?new Pe(l*r):new Uint8Array(l*r);let h=0;for(let t=g.length-1;t>=0;t--)f.set(g[t][0],h),h+=g[t][0].byteLength;return f}}async function Ve(t){const e=await async function(t,e){const n=new De;n.memory=new WebAssembly.Memory({initial:Te}),n.u8=new Uint8Array(n.memory.buffer),n.u32=new Uint32Array(n.memory.buffer);const i=await WebAssembly.compile(t.code);if(n.instance=await WebAssembly.instantiate(i,{env:{memory:n.memory}}),globalThis?.Worker||(e=!0),n.singleThread=e,n.initalPFree=n.u32[0],n.pq=t.pq,n.pr=t.pr,n.pG1gen=t.pG1gen,n.pG1zero=t.pG1zero,n.pG2gen=t.pG2gen,n.pG2zero=t.pG2zero,n.pOneT=t.pOneT,e)n.code=t.code,n.taskManager=function(t){const e=32767;let n,i;async function a(t){const a=new Uint8Array(t.code),o=await WebAssembly.compile(a);i=new WebAssembly.Memory({initial:t.init,maximum:e}),n=await WebAssembly.instantiate(o,{env:{memory:i}})}function o(t){const n=new Uint32Array(i.buffer,0,1);for(;3&n[0];)n[0]++;const a=n[0];if(n[0]+=t,n[0]+t>i.buffer.byteLength){const a=i.buffer.byteLength/65536;let o=Math.floor((n[0]+t)/65536)+1;o>e&&(o=e),i.grow(o-a)}return a}function r(t){const e=o(t.byteLength);return c(e,t),e}function s(t,e){const n=new Uint8Array(i.buffer);return new Uint8Array(n.buffer,n.byteOffset+t,e)}function c(t,e){new Uint8Array(i.buffer).set(new Uint8Array(e),t)}function l(t){if("INIT"==t[0].cmd)return a(t[0]);const e={vars:[],out:[]},l=new Uint32Array(i.buffer,0,1)[0];for(let i=0;i<t.length;i++)switch(t[i].cmd){case"ALLOCSET":e.vars[t[i].var]=r(t[i].buff);break;case"ALLOC":e.vars[t[i].var]=o(t[i].len);break;case"SET":c(e.vars[t[i].var],t[i].buff);break;case"CALL":{const a=[];for(let n=0;n<t[i].params.length;n++){const o=t[i].params[n];void 0!==o.var?a.push(e.vars[o.var]+(o.offset||0)):void 0!==o.val&&a.push(o.val)}n.exports[t[i].fnName](...a);break}case"GET":e.out[t[i].out]=s(e.vars[t[i].var],t[i].len).slice();break;default:throw new Error("Invalid cmd")}return new Uint32Array(i.buffer,0,1)[0]=l,e.out}return l}(),await n.taskManager([{cmd:"INIT",init:Te,code:n.code.slice()}]),n.concurrency=1;else{n.workers=[],n.pendingDeferreds=[],n.working=[];let e=2;"object"==typeof navigator&&navigator.hardwareConcurrency&&(e=navigator.hardwareConcurrency),0==e&&(e=2),e>64&&(e=64),n.concurrency=e;for(let t=0;t<e;t++)n.workers[t]=new Worker(qe),n.workers[t].addEventListener("message",a(t)),n.working[t]=!1;const i=[];for(let e=0;e<n.workers.length;e++){const a=t.code.slice();i.push(n.postAction(e,[{cmd:"INIT",init:Te,code:a}],[a.buffer]))}await Promise.all(i)}return n;function a(t){return function(e){let i;i=e&&e.data?e.data:e,n.working[t]=!1,n.pendingDeferreds[t].resolve(i),n.processWorks()}}}(t.wasm,t.singleThread),n={};return n.q=a(t.wasm.q.toString()),n.r=a(t.wasm.r.toString()),n.name=t.name,n.tm=e,n.prePSize=t.wasm.prePSize,n.preQSize=t.wasm.preQSize,n.Fr=new Se(e,"frm",t.n8r,t.r),n.F1=new Se(e,"f1m",t.n8q,t.q),n.F2=new Ue(e,"f2m",n.F1),n.G1=new ke(e,"g1m",n.F1,t.wasm.pG1gen,t.wasm.pG1b,t.cofactorG1),n.G2=new ke(e,"g2m",n.F2,t.wasm.pG2gen,t.wasm.pG2b,t.cofactorG2),n.F6=new Qe(e,"f6m",n.F2),n.F12=new Ue(e,"ftm",n.F6),n.Gt=n.F12,Re(n,"G1"),Re(n,"G2"),Re(n,"Fr"),Ge(n,"G1"),Ge(n,"G2"),je(n,"G1"),je(n,"G2"),je(n,"Fr"),function(t){const e=t.tm;t.pairing=function(n,i){e.startSyncOp();const a=e.allocBuff(t.G1.toJacobian(n)),o=e.allocBuff(t.G2.toJacobian(i)),r=e.alloc(t.Gt.n8);e.instance.exports[t.name+"_pairing"](a,o,r);const s=e.getBuff(r,t.Gt.n8);return e.endSyncOp(),s},t.pairingEq=async function(){let n,i;arguments.length%2==1?(n=arguments[arguments.length-1],i=(arguments.length-1)/2):(n=t.Gt.one,i=arguments.length/2);const a=[];for(let n=0;n<i;n++){const i=[],o=t.G1.toJacobian(arguments[2*n]);i.push({cmd:"ALLOCSET",var:0,buff:o}),i.push({cmd:"ALLOC",var:1,len:t.prePSize});const r=t.G2.toJacobian(arguments[2*n+1]);i.push({cmd:"ALLOCSET",var:2,buff:r}),i.push({cmd:"ALLOC",var:3,len:t.preQSize}),i.push({cmd:"ALLOC",var:4,len:t.Gt.n8}),i.push({cmd:"CALL",fnName:t.name+"_prepareG1",params:[{var:0},{var:1}]}),i.push({cmd:"CALL",fnName:t.name+"_prepareG2",params:[{var:2},{var:3}]}),i.push({cmd:"CALL",fnName:t.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),i.push({cmd:"GET",out:0,var:4,len:t.Gt.n8}),a.push(e.queueAction(i))}const o=await Promise.all(a);e.startSyncOp();const r=e.alloc(t.Gt.n8);e.instance.exports.ftm_one(r);for(let t=0;t<o.length;t++){const n=e.allocBuff(o[t][0]);e.instance.exports.ftm_mul(r,n,r)}e.instance.exports[t.name+"_finalExponentiation"](r,r);const s=e.allocBuff(n),c=!!e.instance.exports.ftm_eq(r,s);return e.endSyncOp(),c},t.prepareG1=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),n=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](e,n);const i=this.tm.getBuff(n,this.prePSize);return this.tm.endSyncOp(),i},t.prepareG2=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),n=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](e,n);const i=this.tm.getBuff(n,this.preQSize);return this.tm.endSyncOp(),i},t.millerLoop=function(t,e){this.tm.startSyncOp();const n=this.tm.allocBuff(t),i=this.tm.allocBuff(e),a=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](n,i,a);const o=this.tm.getBuff(a,this.Gt.n8);return this.tm.endSyncOp(),o},t.finalExponentiation=function(t){this.tm.startSyncOp();const e=this.tm.allocBuff(t),n=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](e,n);const i=this.tm.getBuff(n,this.Gt.n8);return this.tm.endSyncOp(),i}}(n),n.array2buffer=function(t,e){const n=new Uint8Array(e*t.length);for(let i=0;i<t.length;i++)n.set(t[i],i*e);return n},n.buffer2array=function(t,e){const n=t.byteLength/e,i=new Array(n);for(let a=0;a<n;a++)i[a]=t.slice(a*e,a*e+e);return i},n}function Ke(t){return BigInt(t)}function He(t){return t<0n}function $e(t){return 0n===t}function Ye(t){const e=[],n=Ke(t);return e.push(Number(0xFFn&n)),e.push(Number(n>>8n&0xFFn)),e.push(Number(n>>16n&0xFFn)),e.push(Number(n>>24n&0xFFn)),e}function Je(t){const e=function(t){for(var e=[],n=0;n<t.length;n++){var i=t.charCodeAt(n);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(n++,i=65536+((1023&i)<<10|1023&t.charCodeAt(n)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return e}(t);return[...en(e.length),...e]}function We(t){const e=[];let n=Ke(t);if(He(n))throw new Error("Number cannot be negative");for(;!$e(n);)e.push(Number(0x7Fn&n)),n>>=7n;0==e.length&&e.push(0);for(let t=0;t<e.length-1;t++)e[t]=128|e[t];return e}function Ze(t){let e,n;const i=function(t){return He(t)?t.toString(2).length-1:t.toString(2).length}(t);t<0?(n=!0,e=(1n<<BigInt(i))+t):(n=!1,e=Ke(t));const a=7-i%7,o=(1<<7-a)-1|128,r=We(e+((1n<<BigInt(a))-1n<<BigInt(i)));return n||(r[r.length-1]=r[r.length-1]&o),r}function Xe(t){let e=Ke(t);if(e>0xFFFFFFFFn)throw new Error("Number too big");if(e>0x7FFFFFFFn&&(e-=0x100000000n),e<-2147483648n)throw new Error("Number too small");return Ze(e)}function tn(t){let e=Ke(t);if(e>0xFFFFFFFFFFFFFFFFn)throw new Error("Number too big");if(e>0x7FFFFFFFFFFFFFFFn&&(e-=0x10000000000000000n),e<-9223372036854775808n)throw new Error("Number too small");return Ze(e)}function en(t){let e=Ke(t);if(e>0xFFFFFFFFn)throw new Error("Number too big");return We(e)}function nn(t){return Array.from(t,(function(t){return("0"+(255&t).toString(16)).slice(-2)})).join("")}class an{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,e){const n=this.func.localIdxByName[t];if(void 0===n)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...e,33,...en(n)]}teeLocal(t,e){const n=this.func.localIdxByName[t];if(void 0===n)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...e,34,...en(n)]}getLocal(t){const e=this.func.localIdxByName[t];if(void 0===e)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...en(e)]}i64_load8_s(t,e,n){return[...t,48,void 0===n?0:n,...en(e||0)]}i64_load8_u(t,e,n){return[...t,49,void 0===n?0:n,...en(e||0)]}i64_load16_s(t,e,n){return[...t,50,void 0===n?1:n,...en(e||0)]}i64_load16_u(t,e,n){return[...t,51,void 0===n?1:n,...en(e||0)]}i64_load32_s(t,e,n){return[...t,52,void 0===n?2:n,...en(e||0)]}i64_load32_u(t,e,n){return[...t,53,void 0===n?2:n,...en(e||0)]}i64_load(t,e,n){return[...t,41,void 0===n?3:n,...en(e||0)]}i64_store(t,e,n,i){let a,o,r;return Array.isArray(e)?(a=0,o=3,r=e):Array.isArray(n)?(a=e,o=3,r=n):Array.isArray(i)&&(a=e,o=n,r=i),[...t,...r,55,o,...en(a)]}i64_store32(t,e,n,i){let a,o,r;return Array.isArray(e)?(a=0,o=2,r=e):Array.isArray(n)?(a=e,o=2,r=n):Array.isArray(i)&&(a=e,o=n,r=i),[...t,...r,62,o,...en(a)]}i64_store16(t,e,n,i){let a,o,r;return Array.isArray(e)?(a=0,o=1,r=e):Array.isArray(n)?(a=e,o=1,r=n):Array.isArray(i)&&(a=e,o=n,r=i),[...t,...r,61,o,...en(a)]}i64_store8(t,e,n,i){let a,o,r;return Array.isArray(e)?(a=0,o=0,r=e):Array.isArray(n)?(a=e,o=0,r=n):Array.isArray(i)&&(a=e,o=n,r=i),[...t,...r,60,o,...en(a)]}i32_load8_s(t,e,n){return[...t,44,void 0===n?0:n,...en(e||0)]}i32_load8_u(t,e,n){return[...t,45,void 0===n?0:n,...en(e||0)]}i32_load16_s(t,e,n){return[...t,46,void 0===n?1:n,...en(e||0)]}i32_load16_u(t,e,n){return[...t,47,void 0===n?1:n,...en(e||0)]}i32_load(t,e,n){return[...t,40,void 0===n?2:n,...en(e||0)]}i32_store(t,e,n,i){let a,o,r;return Array.isArray(e)?(a=0,o=2,r=e):Array.isArray(n)?(a=e,o=2,r=n):Array.isArray(i)&&(a=e,o=n,r=i),[...t,...r,54,o,...en(a)]}i32_store16(t,e,n,i){let a,o,r;return Array.isArray(e)?(a=0,o=1,r=e):Array.isArray(n)?(a=e,o=1,r=n):Array.isArray(i)&&(a=e,o=n,r=i),[...t,...r,59,o,...en(a)]}i32_store8(t,e,n,i){let a,o,r;return Array.isArray(e)?(a=0,o=0,r=e):Array.isArray(n)?(a=e,o=0,r=n):Array.isArray(i)&&(a=e,o=n,r=i),[...t,...r,58,o,...en(a)]}call(t,...e){const n=this.module.functionIdxByName[t];if(void 0===n)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...e),16,...en(n)]}call_indirect(t,...e){return[...[].concat(...e),...t,17,0,0]}if(t,e,n){return n?[...t,4,64,...e,5,...n,11]:[...t,4,64,...e,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,e){return[...e,13,...en(t)]}br(t){return[12,...en(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...tn(t)]}i32_const(t){return[65,...Xe(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,e){return[...t,...e,81]}i64_ne(t,e){return[...t,...e,82]}i64_lt_s(t,e){return[...t,...e,83]}i64_lt_u(t,e){return[...t,...e,84]}i64_gt_s(t,e){return[...t,...e,85]}i64_gt_u(t,e){return[...t,...e,86]}i64_le_s(t,e){return[...t,...e,87]}i64_le_u(t,e){return[...t,...e,88]}i64_ge_s(t,e){return[...t,...e,89]}i64_ge_u(t,e){return[...t,...e,90]}i64_add(t,e){return[...t,...e,124]}i64_sub(t,e){return[...t,...e,125]}i64_mul(t,e){return[...t,...e,126]}i64_div_s(t,e){return[...t,...e,127]}i64_div_u(t,e){return[...t,...e,128]}i64_rem_s(t,e){return[...t,...e,129]}i64_rem_u(t,e){return[...t,...e,130]}i64_and(t,e){return[...t,...e,131]}i64_or(t,e){return[...t,...e,132]}i64_xor(t,e){return[...t,...e,133]}i64_shl(t,e){return[...t,...e,134]}i64_shr_s(t,e){return[...t,...e,135]}i64_shr_u(t,e){return[...t,...e,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,e){return[...t,...e,70]}i32_ne(t,e){return[...t,...e,71]}i32_lt_s(t,e){return[...t,...e,72]}i32_lt_u(t,e){return[...t,...e,73]}i32_gt_s(t,e){return[...t,...e,74]}i32_gt_u(t,e){return[...t,...e,75]}i32_le_s(t,e){return[...t,...e,76]}i32_le_u(t,e){return[...t,...e,77]}i32_ge_s(t,e){return[...t,...e,78]}i32_ge_u(t,e){return[...t,...e,79]}i32_add(t,e){return[...t,...e,106]}i32_sub(t,e){return[...t,...e,107]}i32_mul(t,e){return[...t,...e,108]}i32_div_s(t,e){return[...t,...e,109]}i32_div_u(t,e){return[...t,...e,110]}i32_rem_s(t,e){return[...t,...e,111]}i32_rem_u(t,e){return[...t,...e,112]}i32_and(t,e){return[...t,...e,113]}i32_or(t,e){return[...t,...e,114]}i32_xor(t,e){return[...t,...e,115]}i32_shl(t,e){return[...t,...e,116]}i32_shr_s(t,e){return[...t,...e,117]}i32_shr_u(t,e){return[...t,...e,118]}i32_rotl(t,e){return[...t,...e,119]}i32_rotr(t,e){return[...t,...e,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}}const on={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};class rn{constructor(t,e,n,i,a){if("import"==n)this.fnType="import",this.moduleName=i,this.fieldName=a;else{if("internal"!=n)throw new Error("Invalid function fnType: "+n);this.fnType="internal"}this.module=t,this.fnName=e,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,e){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);const n=this.nextLocal++;this.localIdxByName[t]=n,this.params.push({type:e})}addLocal(t,e,n){const i=n||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);const a=this.nextLocal++;this.localIdxByName[t]=a,this.locals.push({type:e,length:i})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){return[96,...en(this.params.length),...this.params.map((t=>on[t.type])),...this.returnType?[1,on[this.returnType]]:[0]]}getBody(){const t=this.locals.map((t=>[...en(t.length),on[t.type]])),e=[...en(this.locals.length),...[].concat(...t),...this.code,11];return[...en(e.length),...e]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new an(this)}}class sn{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...Ye(1836278016),...Ye(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(void 0!==this.functionIdxByName[t])throw new Error(`Function already defined: ${t}`);const e=this.functions.length;return this.functionIdxByName[t]=e,this.functions.push(new rn(this,t,"internal")),this.nInternalFunctions++,this.functions[e]}addIimportFunction(t,e,n){if(void 0!==this.functionIdxByName[t])throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&"internal"==this.functions[this.functions.length-1].type)throw new Error(`Import functions must be declared before internal: ${t}`);let i=n||t;const a=this.functions.length;return this.functionIdxByName[t]=a,this.functions.push(new rn(this,t,"import",e,i)),this.nImportFunctions++,this.functions[a]}setMemory(t,e,n){this.memory={pagesSize:t,moduleName:e||"env",fieldName:n||"memory"}}exportFunction(t,e){const n=e||t;if(void 0===this.functionIdxByName[t])throw new Error(`Function not defined: ${t}`);const i=this.functionIdxByName[t];n!=t&&(this.functionIdxByName[n]=i),this.exports.push({exportName:n,idx:i})}addFunctionToTable(t){const e=this.functionIdxByName[t];this.functionsTable.push(e)}addData(t,e){this.datas.push({offset:t,bytes:e})}alloc(t,e){let n,i;(Array.isArray(t)||ArrayBuffer.isView(t))&&void 0===e?(n=t.length,i=t):(n=t,i=e),n=1+(n-1>>3)<<3;const a=this.free;return this.free+=n,i&&this.addData(a,i),a}allocString(t){const e=(new globalThis.TextEncoder).encode(t);return this.alloc([...e,0])}_setSignatures(){this.signatures=[];const t={};if(this.functionsTable.length>0){const e=this.functions[this.functionsTable[0]].getSignature();t["s_"+nn(e)]=0,this.signatures.push(e)}for(let e=0;e<this.functions.length;e++){const n=this.functions[e].getSignature(),i="s_"+nn(n);void 0===t[i]&&(t[i]=this.signatures.length,this.signatures.push(n)),this.functions[e].signatureIdx=t[i]}}_buildSection(t,e){return[t,...en(e.length),...e]}_buildType(){return this._buildSection(1,[...en(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){const t=[];t.push([...Je(this.memory.moduleName),...Je(this.memory.fieldName),2,0,...en(this.memory.pagesSize)]);for(let e=0;e<this.nImportFunctions;e++)t.push([...Je(this.functions[e].moduleName),...Je(this.functions[e].fieldName),0,...en(this.functions[e].signatureIdx)]);return this._buildSection(2,en(t.length).concat(...t))}_buildFunctionDeclarations(){const t=[];for(let e=this.nImportFunctions;e<this.nImportFunctions+this.nInternalFunctions;e++)t.push(...en(this.functions[e].signatureIdx));return this._buildSection(3,[...en(t.length),...t])}_buildFunctionsTable(){return 0==this.functionsTable.length?[]:this._buildSection(4,[...en(1),112,0,...en(this.functionsTable.length)])}_buildElements(){if(0==this.functionsTable.length)return[];const t=[];for(let e=0;e<this.functionsTable.length;e++)t.push(...en(this.functionsTable[e]));return this._buildSection(9,[...en(1),...en(0),65,...Xe(0),11,...en(this.functionsTable.length),...t])}_buildExports(){const t=[];for(let e=0;e<this.exports.length;e++)t.push([...Je(this.exports[e].exportName),0,...en(this.exports[e].idx)]);return this._buildSection(7,en(t.length).concat(...t))}_buildCode(){const t=[];for(let e=this.nImportFunctions;e<this.nImportFunctions+this.nInternalFunctions;e++)t.push(this.functions[e].getBody());return this._buildSection(10,en(t.length).concat(...t))}_buildData(){const t=[];t.push([0,65,0,11,4,...Ye(this.free)]);for(let e=0;e<this.datas.length;e++)t.push([0,65,...Xe(this.datas[e].offset),11,...en(this.datas[e].bytes.length),...this.datas[e].bytes]);return this._buildSection(11,en(t.length).concat(...t))}}async function cn(t,e){if(!t&&globalThis.curve_bn128)return globalThis.curve_bn128;const n=new sn;n.setMemory(25),Le(n),e&&e(n);const i={};i.code=n.build(),i.pq=n.modules.f1m.pq,i.pr=n.modules.frm.pq,i.pG1gen=n.modules.bn128.pG1gen,i.pG1zero=n.modules.bn128.pG1zero,i.pG1b=n.modules.bn128.pG1b,i.pG2gen=n.modules.bn128.pG2gen,i.pG2zero=n.modules.bn128.pG2zero,i.pG2b=n.modules.bn128.pG2b,i.pOneT=n.modules.bn128.pOneT,i.prePSize=n.modules.bn128.prePSize,i.preQSize=n.modules.bn128.preQSize,i.n8q=32,i.n8r=32,i.q=n.modules.bn128.q,i.r=n.modules.bn128.r;const o={name:"bn128",wasm:i,q:a("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:a("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:a("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!t},r=await Ve(o);return r.terminate=async function(){o.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},t||(globalThis.curve_bn128=r),r}async function ln(t,e){if(!t&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const n=new sn;n.setMemory(25),ye(n),e&&e(n);const i={};i.code=n.build(),i.pq=n.modules.f1m.pq,i.pr=n.modules.frm.pq,i.pG1gen=n.modules.bls12381.pG1gen,i.pG1zero=n.modules.bls12381.pG1zero,i.pG1b=n.modules.bls12381.pG1b,i.pG2gen=n.modules.bls12381.pG2gen,i.pG2zero=n.modules.bls12381.pG2zero,i.pG2b=n.modules.bls12381.pG2b,i.pOneT=n.modules.bls12381.pOneT,i.prePSize=n.modules.bls12381.prePSize,i.preQSize=n.modules.bls12381.preQSize,i.n8q=48,i.n8r=32,i.q=n.modules.bls12381.q,i.r=n.modules.bls12381.r;const o={name:"bls12381",wasm:i,q:a("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:a("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:a("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:a("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!t},r=await Ve(o);return r.terminate=async function(){o.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},t||(globalThis.curve_bls12381=r),r}globalThis.curve_bn128=null,globalThis.curve_bls12381=null,a("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),a("21888242871839275222246405745257275088548364400416034343698204186575808495617"),a("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),a("21888242871839275222246405745257275088696311157297823662689037894645226208583");const dn=Q,un=Fe;var gn={};async function fn(t,e,n,i){if(n=n||262144,"number"!=typeof e&&["w+","wx+","r","ax+","a+"].indexOf(e)<0)throw new Error("Invalid open option");const a=await gn.promises.open(t,e),o=await a.stat();return new hn(a,o,n,i,t)}class hn{constructor(t,e,n,i,a){for(this.fileName=a,this.fd=t,this.pos=0,this.pageSize=i||256;this.pageSize<e.blksize;)this.pageSize*=2;this.totalSize=e.size,this.totalPages=Math.floor((e.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(n/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(t){const e=this,n=new Promise(((n,i)=>{e.pendingLoads.push({page:t,resolve:n,reject:i})}));return e.__statusPage("After Load request: ",t),n}__statusPage(t,e){const n=[],i=this;if(!i.logHistory)return;n.push("=="+t+" "+e);let a="";for(let t=0;t<i.pendingLoads.length;t++)i.pendingLoads[t].page==e&&(a=a+" "+t);if(a&&n.push("Pending loads:"+a),void 0!==i.pages[e]){const t=i.pages[e];n.push("Loaded"),n.push("pendingOps: "+t.pendingOps),t.loading&&n.push("loading: "+t.loading),t.writing&&n.push("writing"),t.dirty&&n.push("dirty")}n.push("=="),i.history[e]||(i.history[e]=[]),i.history[e].push(n)}__printHistory(t){const e=this;e.history[t]||console.log("Empty History ",t),console.log("History "+t);for(let n=0;n<e.history[t].length;n++)for(let i=0;i<e.history[t][n].length;i++)console.log("-> "+e.history[t][n][i])}_triggerLoad(){const t=this;if(t.reading)return;if(0==t.pendingLoads.length)return;const e=Object.keys(t.pages),n=[];for(let i=0;i<e.length;i++){const a=t.pages[parseInt(e[i])];0!=a.dirty||0!=a.pendingOps||a.writing||a.loading||n.push(parseInt(e[i]))}let i=t.maxPagesLoaded-e.length;const a=[];for(;t.pendingLoads.length>0&&(void 0!==t.pages[t.pendingLoads[0].page]||i>0||n.length>0);){const e=t.pendingLoads.shift();if(void 0!==t.pages[e.page]){t.pages[e.page].pendingOps++;const i=n.indexOf(e.page);i>=0&&n.splice(i,1),t.pages[e.page].loading?t.pages[e.page].loading.push(e):e.resolve(),t.__statusPage("After Load (cached): ",e.page)}else{if(i)i--;else{const e=n.shift();t.__statusPage("Before Unload: ",e),t.avBuffs.unshift(t.pages[e]),delete t.pages[e],t.__statusPage("After Unload: ",e)}e.page>=t.totalPages?(t.pages[e.page]=o(),e.resolve(),t.__statusPage("After Load (new): ",e.page)):(t.reading=!0,t.pages[e.page]=o(),t.pages[e.page].loading=[e],a.push(t.fd.read(t.pages[e.page].buff,0,t.pageSize,e.page*t.pageSize).then((n=>{t.pages[e.page].size=n.bytesRead;const i=t.pages[e.page].loading;delete t.pages[e.page].loading;for(let t=0;t<i.length;t++)i[t].resolve();return t.__statusPage("After Load (loaded): ",e.page),n}),(t=>{e.reject(t)}))),t.__statusPage("After Load (loading): ",e.page))}}function o(){if(t.avBuffs.length>0){const e=t.avBuffs.shift();return e.dirty=!1,e.pendingOps=1,e.size=0,e}return{dirty:!1,buff:new Uint8Array(t.pageSize),pendingOps:1,size:0}}Promise.all(a).then((()=>{t.reading=!1,t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t)),t._tryClose()}))}_triggerWrite(){const t=this;if(t.writing)return;const e=Object.keys(t.pages),n=[];for(let i=0;i<e.length;i++){const a=t.pages[parseInt(e[i])];a.dirty&&(a.dirty=!1,a.writing=!0,t.writing=!0,n.push(t.fd.write(a.buff,0,a.size,parseInt(e[i])*t.pageSize).then((()=>{a.writing=!1}),(e=>{console.log("ERROR Writing: "+e),t.error=e,t._tryClose()}))))}t.writing&&Promise.all(n).then((()=>{t.writing=!1,setImmediate(t._triggerWrite.bind(t)),t._tryClose(),t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t))}))}_getDirtyPage(){for(let t in this.pages)if(this.pages[t].dirty)return t;return-1}async write(t,e){if(0==t.byteLength)return;const n=this;if(void 0===e&&(e=n.pos),n.pos=e+t.byteLength,n.totalSize<e+t.byteLength&&(n.totalSize=e+t.byteLength),n.pendingClose)throw new Error("Writing a closing file");const i=Math.floor(e/n.pageSize),a=Math.floor((e+t.byteLength-1)/n.pageSize),o=[];for(let t=i;t<=a;t++)o.push(n._loadPage(t));n._triggerLoad();let r=i,s=e%n.pageSize,c=t.byteLength;for(;c>0;){await o[r-i];const e=s+c>n.pageSize?n.pageSize-s:c,a=t.slice(t.byteLength-c,t.byteLength-c+e);new Uint8Array(n.pages[r].buff.buffer,s,e).set(a),n.pages[r].dirty=!0,n.pages[r].pendingOps--,n.pages[r].size=Math.max(s+e,n.pages[r].size),r>=n.totalPages&&(n.totalPages=r+1),c-=e,r++,s=0,n.writing||setImmediate(n._triggerWrite.bind(n))}}async read(t,e){let n=new Uint8Array(t);return await this.readToBuffer(n,0,t,e),n}async readToBuffer(t,e,n,i){if(0==n)return;const a=this;if(n>a.pageSize*a.maxPagesLoaded*.8){const t=Math.floor(1.1*n);this.maxPagesLoaded=Math.floor(t/a.pageSize)+1}if(void 0===i&&(i=a.pos),a.pos=i+n,a.pendingClose)throw new Error("Reading a closing file");const o=Math.floor(i/a.pageSize),r=Math.floor((i+n-1)/a.pageSize),s=[];for(let t=o;t<=r;t++)s.push(a._loadPage(t));a._triggerLoad();let c=o,l=i%a.pageSize,d=i+n>a.totalSize?n-(i+n-a.totalSize):n;for(;d>0;){await s[c-o],a.__statusPage("After Await (read): ",c);const i=l+d>a.pageSize?a.pageSize-l:d,r=new Uint8Array(a.pages[c].buff.buffer,a.pages[c].buff.byteOffset+l,i);t.set(r,e+n-d),a.pages[c].pendingOps--,a.__statusPage("After Op done: ",c),d-=i,c++,l=0,a.pendingLoads.length>0&&setImmediate(a._triggerLoad.bind(a))}this.pos=i+n}_tryClose(){const t=this;t.pendingClose&&(t.error&&t.pendingCloseReject(t.error),t._getDirtyPage()>=0||t.writing||t.reading||t.pendingLoads.length>0||t.pendingClose())}close(){const t=this;if(t.pendingClose)throw new Error("Closing the file twice");return new Promise(((e,n)=>{t.pendingClose=e,t.pendingCloseReject=n,t._tryClose()})).then((()=>{t.fd.close()}),(e=>{throw t.fd.close(),e}))}async discard(){await this.close(),await gn.promises.unlink(this.fileName)}async writeULE32(t,e){const n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,t,!0),await this.write(n,e)}async writeUBE32(t,e){const n=new Uint8Array(4);new DataView(n.buffer).setUint32(0,t,!1),await this.write(n,e)}async writeULE64(t,e){const n=new Uint8Array(8),i=new DataView(n.buffer);i.setUint32(0,4294967295&t,!0),i.setUint32(4,Math.floor(t/4294967296),!0),await this.write(n,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),n=new Uint32Array(e.buffer);return 4294967296*n[1]+n[0]}async readString(t){const e=this;if(e.pendingClose)throw new Error("Reading a closing file");let n=void 0===t?e.pos:t,i=Math.floor(n/e.pageSize),a=!1,o="";for(;!a;){let t=e._loadPage(i);e._triggerLoad(),await t,e.__statusPage("After Await (read): ",i);let r=n%e.pageSize;const s=new Uint8Array(e.pages[i].buff.buffer,e.pages[i].buff.byteOffset+r,e.pageSize-r);let c=s.findIndex((t=>0===t));a=-1!==c,a?(o+=(new TextDecoder).decode(s.slice(0,c)),e.pos=i*this.pageSize+r+c+1):(o+=(new TextDecoder).decode(s),e.pos=i*this.pageSize+r+s.length),e.pages[i].pendingOps--,e.__statusPage("After Op done: ",i),n=e.pos,i++,e.pendingLoads.length>0&&setImmediate(e._triggerLoad.bind(e))}return o}}const _n=new Uint8Array(4),pn=new DataView(_n.buffer),mn=new Uint8Array(8),Ln=new DataView(mn.buffer);class yn{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t>this.allocSize){const e=Math.max(this.allocSize+(1<<20),Math.floor(1.1*this.allocSize),t),n=new Uint8Array(e);n.set(this.o.data),this.o.data=n,this.allocSize=e}}async write(t,e){if(void 0===e&&(e=this.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(e+t.byteLength),this.o.data.set(t.slice(),e),e+t.byteLength>this.totalSize&&(this.totalSize=e+t.byteLength),this.pos=e+t.byteLength}async readToBuffer(t,e,n,i){if(void 0===i&&(i=this.pos),this.readOnly&&i+n>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(i+n);const a=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+i,n);t.set(a,e),this.pos=i+n}async read(t,e){const n=new Uint8Array(t);return await this.readToBuffer(n,0,t,e),n}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(t,e){pn.setUint32(0,t,!0),await this.write(_n,e)}async writeUBE32(t,e){pn.setUint32(0,t,!1),await this.write(_n,e)}async writeULE64(t,e){Ln.setUint32(0,4294967295&t,!0),Ln.setUint32(4,Math.floor(t/4294967296),!0),await this.write(mn,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),n=new Uint32Array(e.buffer);return 4294967296*n[1]+n[0]}async readString(t){const e=this;let n=void 0===t?e.pos:t;if(n>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}const i=new Uint8Array(e.o.data.buffer,n,this.totalSize-n);let a=i.findIndex((t=>0===t)),o="";return-1!==a?(o=(new TextDecoder).decode(i.slice(0,a)),e.pos=n+a+1):e.pos=n,o}}const An=1<<22,bn=new Uint8Array(4),In=new DataView(bn.buffer),wn=new Uint8Array(8),Cn=new DataView(wn.buffer);class xn{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t<=this.totalSize)return;if(this.readOnly)throw new Error("Reading out of file bounds");const e=Math.floor((t-1)/An)+1;for(let n=Math.max(this.o.data.length-1,0);n<e;n++){const i=new Uint8Array(n<e-1?An:t-(e-1)*An);n==this.o.data.length-1&&i.set(this.o.data[n]),this.o.data[n]=i}this.totalSize=t}async write(t,e){const n=this;if(void 0===e&&(e=n.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(e+t.byteLength);let i=Math.floor(e/An),a=e%An,o=t.byteLength;for(;o>0;){const e=a+o>An?An-a:o,r=t.slice(t.byteLength-o,t.byteLength-o+e);new Uint8Array(n.o.data[i].buffer,a,e).set(r),o-=e,i++,a=0}this.pos=e+t.byteLength}async readToBuffer(t,e,n,i){const a=this;if(void 0===i&&(i=a.pos),this.readOnly&&i+n>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(i+n);let o=Math.floor(i/An),r=i%An,s=n;for(;s>0;){const i=r+s>An?An-r:s,c=new Uint8Array(a.o.data[o].buffer,r,i);t.set(c,e+n-s),s-=i,o++,r=0}this.pos=i+n}async read(t,e){const n=new Uint8Array(t);return await this.readToBuffer(n,0,t,e),n}close(){}async discard(){}async writeULE32(t,e){In.setUint32(0,t,!0),await this.write(bn,e)}async writeUBE32(t,e){In.setUint32(0,t,!1),await this.write(bn,e)}async writeULE64(t,e){Cn.setUint32(0,4294967295&t,!0),Cn.setUint32(4,Math.floor(t/4294967296),!0),await this.write(wn,e)}async readULE32(t){const e=await this.read(4,t);return new Uint32Array(e.buffer)[0]}async readUBE32(t){const e=await this.read(4,t);return new DataView(e.buffer).getUint32(0,!1)}async readULE64(t){const e=await this.read(8,t),n=new Uint32Array(e.buffer);return 4294967296*n[1]+n[0]}async readString(t){const e=this;let n=void 0===t?e.pos:t;if(n>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}let i=!1,a="";for(;!i;){let t=Math.floor(n/An),o=n%An;if(void 0===e.o.data[t])throw new Error("ERROR");let r=Math.min(2048,e.o.data[t].length-o);const s=new Uint8Array(e.o.data[t].buffer,o,r);let c=s.findIndex((t=>0===t));i=-1!==c,i?(a+=(new TextDecoder).decode(s.slice(0,c)),e.pos=t*An+o+c+1):(a+=(new TextDecoder).decode(s),e.pos=t*An+o+s.length),n=e.pos}return a}}const En=1024,Bn=512,Fn=2,vn=0,Pn=65536,On=8192;async function Sn(t,e,n){if("string"==typeof t&&(t={type:"file",fileName:t,cacheSize:e||Pn,pageSize:n||On}),"file"==t.type)return await fn(t.fileName,En|Bn|Fn,t.cacheSize,t.pageSize);if("mem"==t.type)return function(t){const e=t.initialSize||1<<20,n=new yn;return n.o=t,n.o.data=new Uint8Array(e),n.allocSize=e,n.totalSize=0,n.readOnly=!1,n.pos=0,n}(t);if("bigMem"==t.type)return function(t){const e=t.initialSize||0,n=new xn;n.o=t;const i=e?Math.floor((e-1)/An)+1:0;n.o.data=[];for(let t=0;t<i-1;t++)n.o.data.push(new Uint8Array(An));return i&&n.o.data.push(new Uint8Array(e-An*(i-1))),n.totalSize=0,n.readOnly=!1,n.pos=0,n}(t);throw new Error("Invalid FastFile type: "+t.type)}async function Un(t,e,n){if(t instanceof Uint8Array&&(t={type:"mem",data:t}),"string"==typeof t&&(t={type:"mem",data:await fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return new Uint8Array(t)}))}),"file"==t.type)return await fn(t.fileName,vn,t.cacheSize,t.pageSize);if("mem"==t.type)return await function(t){const e=new yn;return e.o=t,e.allocSize=t.data.byteLength,e.totalSize=t.data.byteLength,e.readOnly=!0,e.pos=0,e}(t);if("bigMem"==t.type)return await function(t){const e=new xn;return e.o=t,e.totalSize=(t.data.length-1)*An+t.data[t.data.length-1].byteLength,e.readOnly=!0,e.pos=0,e}(t);throw new Error("Invalid FastFile type: "+t.type)}async function Qn(t,e,n,i,a){const o=await Un(t),r=await o.read(4);let s="";for(let t=0;t<4;t++)s+=String.fromCharCode(r[t]);if(s!=e)throw new Error(t+": Invalid File format");if(await o.readULE32()>n)throw new Error("Version not supported");const c=await o.readULE32();let l=[];for(let t=0;t<c;t++){let t=await o.readULE32(),e=await o.readULE64();void 0===l[t]&&(l[t]=[]),l[t].push({p:o.pos,size:e}),o.pos+=e}return{fd:o,sections:l}}async function kn(t,e){if(void 0!==t.writingSection)throw new Error("Already writing a section");await t.writeULE32(e),t.writingSection={pSectionSize:t.pos},await t.writeULE64(0)}async function Tn(t){if(void 0===t.writingSection)throw new Error("Not writing a section");const e=t.pos-t.writingSection.pSectionSize-8,n=t.pos;t.pos=t.writingSection.pSectionSize,await t.writeULE64(e),t.pos=n,delete t.writingSection}async function Nn(t,e,n){if(void 0!==t.readingSection)throw new Error("Already reading a section");if(!e[n])throw new Error(t.fileName+": Missing section "+n);if(e[n].length>1)throw new Error(t.fileName+": Section Duplicated "+n);t.pos=e[n][0].p,t.readingSection=e[n][0]}async function qn(t,e){if(void 0===t.readingSection)throw new Error("Not reading a section");if(!e&&t.pos-t.readingSection.p!=t.readingSection.size)throw new Error("Invalid section size reading");delete t.readingSection}async function Mn(t,e,n){const i=await t.read(e,n);return dn.fromRprLE(i,0,e)}async function Dn(t,e,n,i,a){if((i=void 0===i?0:i)+(a=void 0===a?e[n][0].size-i:a)>e[n][0].size)throw new Error("Reading out of the range of the section");let o;return o=a<1<<30?new Uint8Array(a):new Pe(a),await t.readToBuffer(o,0,a,e[n][0].p+i),o}dn.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),dn.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const Rn=dn.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),zn=dn.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function Gn(t){let e;if(dn.eq(t,zn))e=await cn();else{if(!dn.eq(t,Rn))throw new Error(`Curve not supported: ${dn.toString(t)}`);e=await ln()}return e}var jn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Vn={exports:{}};class Kn extends Error{}Kn.prototype.name="AssertionError";var Hn={exports:{}};function $n(t){return t.length}var Yn={byteLength:$n,toString:function(t){const e=t.byteLength;let n="";for(let i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n},write:function(t,e,n=0,i=$n(e)){const a=Math.min(i,t.byteLength-n);for(let i=0;i<a;i++)t[n+i]=e.charCodeAt(i);return a}};const Jn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wn=new Uint8Array(256);for(let t=0;t<64;t++)Wn[Jn.charCodeAt(t)]=t;function Zn(t){let e=t.length;return 61===t.charCodeAt(e-1)&&e--,e>1&&61===t.charCodeAt(e-1)&&e--,3*e>>>2}Wn[45]=62,Wn[95]=63;var Xn={byteLength:Zn,toString:function(t){const e=t.byteLength;let n="";for(let i=0;i<e;i+=3)n+=Jn[t[i]>>2]+Jn[(3&t[i])<<4|t[i+1]>>4]+Jn[(15&t[i+1])<<2|t[i+2]>>6]+Jn[63&t[i+2]];return e%3==2?n=n.substring(0,n.length-1)+"=":e%3==1&&(n=n.substring(0,n.length-2)+"=="),n},write:function(t,e,n=0,i=Zn(e)){const a=Math.min(i,t.byteLength-n);for(let n=0,i=0;i<a;n+=4){const a=Wn[e.charCodeAt(n)],o=Wn[e.charCodeAt(n+1)],r=Wn[e.charCodeAt(n+2)],s=Wn[e.charCodeAt(n+3)];t[i++]=a<<2|o>>4,t[i++]=(15&o)<<4|r>>2,t[i++]=(3&r)<<6|63&s}return a}};function ti(t){return t.length>>>1}var ei={byteLength:ti,toString:function(t){const e=t.byteLength;t=new DataView(t.buffer,t.byteOffset,e);let n="",i=0;for(let a=e-e%4;i<a;i+=4)n+=t.getUint32(i).toString(16).padStart(8,"0");for(;i<e;i++)n+=t.getUint8(i).toString(16).padStart(2,"0");return n},write:function(t,e,n=0,i=ti(e)){const a=Math.min(i,t.byteLength-n);for(let i=0;i<a;i++){const a=ni(e.charCodeAt(2*i)),o=ni(e.charCodeAt(2*i+1));if(void 0===a||void 0===o)return t.subarray(0,i);t[n+i]=a<<4|o}return a}};function ni(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-65+10:t>=97&&t<=102?t-97+10:void 0}function ii(t){let e=0;for(let n=0,i=t.length;n<i;n++){const a=t.charCodeAt(n);if(a>=55296&&a<=56319&&n+1<i){const i=t.charCodeAt(n+1);if(i>=56320&&i<=57343){e+=4,n++;continue}}e+=a<=127?1:a<=2047?2:3}return e}let ai,oi;if("undefined"!=typeof TextDecoder){const t=new TextDecoder;ai=function(e){return t.decode(e)}}else ai=function(t){const e=t.byteLength;let n="",i=0;for(;i<e;){let a=t[i];if(a<=127){n+=String.fromCharCode(a),i++;continue}let o=0,r=0;if(a<=223?(o=1,r=31&a):a<=239?(o=2,r=15&a):a<=244&&(o=3,r=7&a),e-i-o>0){let e=0;for(;e<o;)a=t[i+e+1],r=r<<6|63&a,e+=1}else r=65533,o=e-i;n+=String.fromCodePoint(r),i+=o+1}return n};if("undefined"!=typeof TextEncoder){const t=new TextEncoder;oi=function(e,n,i=0,a=ii(n)){const o=Math.min(a,e.byteLength-i);return t.encodeInto(n,e.subarray(i,i+o)),o}}else oi=function(t,e,n=0,i=ii(e)){const a=Math.min(i,t.byteLength-n);t=t.subarray(n,n+a);let o=0,r=0;for(;o<e.length;){const n=e.codePointAt(o);if(n<=127){t[r++]=n,o++;continue}let i=0,a=0;for(n<=2047?(i=6,a=192):n<=65535?(i=12,a=224):n<=2097151&&(i=18,a=240),t[r++]=a|n>>i,i-=6;i>=0;)t[r++]=128|n>>i&63,i-=6;o+=n>=65536?2:1}return a};var ri={byteLength:ii,toString:ai,write:oi};function si(t){return 2*t.length}var ci,li,di={byteLength:si,toString:function(t){const e=t.byteLength;let n="";for(let i=0;i<e-1;i+=2)n+=String.fromCharCode(t[i]+256*t[i+1]);return n},write:function(t,e,n=0,i=si(e)){const a=Math.min(i,t.byteLength-n);let o=a;for(let i=0;i<e.length&&!((o-=2)<0);++i){const a=e.charCodeAt(i),o=a>>8,r=a%256;t[n+2*i]=r,t[n+2*i+1]=o}return a}};!function(t,e){const n=Yn,i=Xn,a=ei,o=ri,r=di,s=255===new Uint8Array(Uint16Array.of(255).buffer)[0];function c(t){switch(t){case"ascii":return n;case"base64":return i;case"hex":return a;case"utf8":case"utf-8":case void 0:return o;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r;default:throw new Error(`Unknown encoding: ${t}`)}}function l(t){return t instanceof Uint8Array}function d(t,e,n){return"string"==typeof t?function(t,e){const n=c(e),i=new Uint8Array(n.byteLength(t));return n.write(i,t,0,i.byteLength),i}(t,e):Array.isArray(t)?function(t){const e=new Uint8Array(t.length);return e.set(t),e}(t):ArrayBuffer.isView(t)?function(t){const e=new Uint8Array(t.byteLength);return e.set(t),e}(t):function(t,e,n){return new Uint8Array(t,e,n)}(t,e,n)}function u(t,e,n,i,a){if(0===t.byteLength)return-1;if("string"==typeof n?(i=n,n=0):void 0===n?n=a?0:t.length-1:n<0&&(n+=t.byteLength),n>=t.byteLength){if(a)return-1;n=t.byteLength-1}else if(n<0){if(!a)return-1;n=0}if("string"==typeof e)e=d(e,i);else if("number"==typeof e)return e&=255,a?t.indexOf(e,n):t.lastIndexOf(e,n);if(0===e.byteLength)return-1;if(a){let i=-1;for(let a=n;a<t.byteLength;a++)if(t[a]===e[-1===i?0:a-i]){if(-1===i&&(i=a),a-i+1===e.byteLength)return i}else-1!==i&&(a-=a-i),i=-1}else{n+e.byteLength>t.byteLength&&(n=t.byteLength-e.byteLength);for(let i=n;i>=0;i--){let n=!0;for(let a=0;a<e.byteLength;a++)if(t[i+a]!==e[a]){n=!1;break}if(n)return i}}return-1}function g(t,e,n,i){return u(t,e,n,i,!0)}function f(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}t.exports=e={isBuffer:l,isEncoding:function(t){try{return c(t),!0}catch{return!1}},alloc:function(t,n,i){const a=new Uint8Array(t);return void 0!==n&&e.fill(a,n,0,a.byteLength,i),a},allocUnsafe:function(t){return new Uint8Array(t)},allocUnsafeSlow:function(t){return new Uint8Array(t)},byteLength:function(t,e){return c(e).byteLength(t)},compare:function(t,e){if(t===e)return 0;const n=Math.min(t.byteLength,e.byteLength);t=new DataView(t.buffer,t.byteOffset,t.byteLength),e=new DataView(e.buffer,e.byteOffset,e.byteLength);let i=0;for(let a=n-n%4;i<a&&t.getUint32(i,s)===e.getUint32(i,s);i+=4);for(;i<n;i++){const n=t.getUint8(i),a=e.getUint8(i);if(n<a)return-1;if(n>a)return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0},concat:function(t,e){void 0===e&&(e=t.reduce(((t,e)=>t+e.byteLength),0));const n=new Uint8Array(e);let i=0;for(const e of t){if(i+e.byteLength>n.byteLength){const t=e.subarray(0,n.byteLength-i);return n.set(t,i),n}n.set(e,i),i+=e.byteLength}return n},copy:function(t,e,n=0,i=0,a=t.byteLength){if(a>0&&a<i)return 0;if(a===i)return 0;if(0===t.byteLength||0===e.byteLength)return 0;if(n<0)throw new RangeError("targetStart is out of range");if(i<0||i>=t.byteLength)throw new RangeError("sourceStart is out of range");if(a<0)throw new RangeError("sourceEnd is out of range");n>=e.byteLength&&(n=e.byteLength),a>t.byteLength&&(a=t.byteLength),e.byteLength-n<a-i&&(a=e.length-n+i);const o=a-i;return t===e?e.copyWithin(n,i,a):e.set(t.subarray(i,a),n),o},equals:function(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;const n=t.byteLength;t=new DataView(t.buffer,t.byteOffset,t.byteLength),e=new DataView(e.buffer,e.byteOffset,e.byteLength);let i=0;for(let a=n-n%4;i<a;i+=4)if(t.getUint32(i,s)!==e.getUint32(i,s))return!1;for(;i<n;i++)if(t.getUint8(i)!==e.getUint8(i))return!1;return!0},fill:function(t,e,n,i,a){if("string"==typeof e?"string"==typeof n?(a=n,n=0,i=t.byteLength):"string"==typeof i&&(a=i,i=t.byteLength):"number"==typeof e?e&=255:"boolean"==typeof e&&(e=+e),n<0||t.byteLength<n||t.byteLength<i)throw new RangeError("Out of range index");if(void 0===n&&(n=0),void 0===i&&(i=t.byteLength),i<=n)return t;if(e||(e=0),"number"==typeof e)for(let a=n;a<i;++a)t[a]=e;else{const o=(e=l(e)?e:d(e,a)).byteLength;for(let a=0;a<i-n;++a)t[a+n]=e[a%o]}return t},from:d,includes:function(t,e,n,i){return-1!==g(t,e,n,i)},indexOf:g,lastIndexOf:function(t,e,n,i){return u(t,e,n,i,!1)},swap16:function(t){const e=t.byteLength;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<e;n+=2)f(t,n,n+1);return t},swap32:function(t){const e=t.byteLength;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<e;n+=4)f(t,n,n+3),f(t,n+1,n+2);return t},swap64:function(t){const e=t.byteLength;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<e;n+=8)f(t,n,n+7),f(t,n+1,n+6),f(t,n+2,n+5),f(t,n+3,n+4);return t},toBuffer:function(t){return t},toString:function(t,e,n=0,i=t.byteLength){const a=t.byteLength;return n>=a||i<=n?"":(n<0&&(n=0),i>a&&(i=a),(0!==n||i<a)&&(t=t.subarray(n,i)),c(e).toString(t))},write:function(t,e,n,i,a){return void 0===n?a="utf8":void 0===i&&"string"==typeof n?(a=n,n=void 0):void 0===a&&"string"==typeof i&&(a=i,i=void 0),c(a).write(t,e,n,i)},writeDoubleLE:function(t,e,n){return void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(n,e,!0),n+8},writeFloatLE:function(t,e,n){return void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(n,e,!0),n+4},writeUInt32LE:function(t,e,n){return void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setUint32(n,e,!0),n+4},writeInt32LE:function(t,e,n){return void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setInt32(n,e,!0),n+4},readDoubleLE:function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat64(e,!0)},readFloatLE:function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat32(e,!0)},readUInt32LE:function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getUint32(e,!0)},readInt32LE:function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getInt32(e,!0)}}}(Hn,Hn.exports);var ui=function t(e,n){if(!e){var i=new Kn(n);throw Error.captureStackTrace&&Error.captureStackTrace(i,t),i}},gi=Hn.exports,fi=null,hi="undefined"!=typeof WebAssembly&&function(){if(li)return ci;li=1;var t=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var n=e.length,i=new Uint8Array(3*(n-("="==e[n-1])-("="==e[n-2]))/4|0),a=0,o=0;a<n;){var r=t[e.charCodeAt(a++)],s=t[e.charCodeAt(a++)],c=t[e.charCodeAt(a++)],l=t[e.charCodeAt(a++)];i[o++]=r<<2|s>>4,i[o++]=s<<4|c>>2,i[o++]=c<<6|l}return i}})(),e=((t,e)=>function(){return e||(0,t[Object.keys(t)[0]])((e={exports:{}}).exports,e),e.exports})({"wasm-binary:./blake2b.wat"(e,n){n.exports=t("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMKvz8EwAIAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCAAQgA3AyAgAEIANwMoIABCADcDMCAAQgA3AzggAEIANwNAIABCADcDSCAAQgA3A1AgAEIANwNYIABCADcDYCAAQgA3A2ggAEIANwNwIABCADcDeCAAQoiS853/zPmE6gBBACkDAIU3A4ABIABCu86qptjQ67O7f0EIKQMAhTcDiAEgAEKr8NP0r+68tzxBECkDAIU3A5ABIABC8e30+KWn/aelf0EYKQMAhTcDmAEgAELRhZrv+s+Uh9EAQSApAwCFNwOgASAAQp/Y+dnCkdqCm39BKCkDAIU3A6gBIABC6/qG2r+19sEfQTApAwCFNwOwASAAQvnC+JuRo7Pw2wBBOCkDAIU3A7gBIABCADcDwAEgAEIANwPIASAAQgA3A9ABC20BA38gAEHAAWohAyAAQcgBaiEEIAQpAwCnIQUCQANAIAEgAkYNASAFQYABRgRAIAMgAykDACAFrXw3AwBBACEFIAAQAwsgACAFaiABLQAAOgAAIAVBAWohBSABQQFqIQEMAAsLIAQgBa03AwALYQEDfyAAQcABaiEBIABByAFqIQIgASABKQMAIAIpAwB8NwMAIABCfzcD0AEgAikDAKchAwJAA0AgA0GAAUYNASAAIANqQQA6AAAgA0EBaiEDDAALCyACIAOtNwMAIAAQAwuqOwIgfgl/IABBgAFqISEgAEGIAWohIiAAQZABaiEjIABBmAFqISQgAEGgAWohJSAAQagBaiEmIABBsAFqIScgAEG4AWohKCAhKQMAIQEgIikDACECICMpAwAhAyAkKQMAIQQgJSkDACEFICYpAwAhBiAnKQMAIQcgKCkDACEIQoiS853/zPmE6gAhCUK7zqqm2NDrs7t/IQpCq/DT9K/uvLc8IQtC8e30+KWn/aelfyEMQtGFmu/6z5SH0QAhDUKf2PnZwpHagpt/IQ5C6/qG2r+19sEfIQ9C+cL4m5Gjs/DbACEQIAApAwAhESAAKQMIIRIgACkDECETIAApAxghFCAAKQMgIRUgACkDKCEWIAApAzAhFyAAKQM4IRggACkDQCEZIAApA0ghGiAAKQNQIRsgACkDWCEcIAApA2AhHSAAKQNoIR4gACkDcCEfIAApA3ghICANIAApA8ABhSENIA8gACkD0AGFIQ8gASAFIBF8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSASfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgE3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBR8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAVfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgFnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBd8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAYfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgGXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBp8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAbfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgHHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIB18fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAefHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgH3x8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFICB8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAffHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgG3x8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBV8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAZfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgGnx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHICB8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAefHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggF3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBJ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAdfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgEXx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBN8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAcfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGHx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBZ8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAUfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgHHx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBl8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAdfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgEXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBZ8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByATfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggIHx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIB58fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAbfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgH3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBR8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAXfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggGHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBJ8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAafHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFXx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBh8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAafHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgFHx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBJ8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAefHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHXx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBx8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAffHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgE3x8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBd8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAWfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgG3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBV8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCARfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgIHx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBl8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAafHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEXx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBZ8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAYfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgE3x8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBV8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAbfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggIHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIB98fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiASfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgHHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIB18fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAXfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBR8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAefHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgE3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIB18fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAXfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgG3x8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBF8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAcfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggGXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBR8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAVfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBh8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAWfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggIHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIB98fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSASfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgGnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIB18fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAWfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgEnx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGICB8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAffHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBV8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAbfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgEXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBh8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAXfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgFHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBp8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCATfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgGXx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBx8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAefHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgHHx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBh8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAffHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgHXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBJ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAUfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGnx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBZ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiARfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgIHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBV8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAZfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggF3x8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBN8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAbfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgF3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFICB8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAffHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGnx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBx8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAUfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggEXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBl8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAdfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgE3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIB58fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAYfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggEnx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBV8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAbfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBt8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSATfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgGXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBV8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAYfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgF3x8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBJ8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAWfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgIHx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBx8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAafHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgH3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBR8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAdfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgHnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBF8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSARfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBN8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAUfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgFXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBZ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAXfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBl8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAafHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgG3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBx8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAdfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHnx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB98fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAgfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgH3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBt8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAVfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBp8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAgfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggHnx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBd8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiASfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBF8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByATfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBh8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAWfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgISAhKQMAIAEgCYWFNwMAICIgIikDACACIAqFhTcDACAjICMpAwAgAyALhYU3AwAgJCAkKQMAIAQgDIWFNwMAICUgJSkDACAFIA2FhTcDACAmICYpAwAgBiAOhYU3AwAgJyAnKQMAIAcgD4WFNwMAICggKCkDACAIIBCFhTcDAAs=")}}),n=e(),i=WebAssembly.compile(n);return ci=async t=>(await WebAssembly.instantiate(await i,t)).exports}()().then((t=>{fi=t})),_i=64,pi=[];Vn.exports=wi;var mi=Vn.exports.BYTES_MIN=16,Li=Vn.exports.BYTES_MAX=64;Vn.exports.BYTES=32;var yi=Vn.exports.KEYBYTES_MIN=16,Ai=Vn.exports.KEYBYTES_MAX=64;Vn.exports.KEYBYTES=32;var bi=Vn.exports.SALTBYTES=16,Ii=Vn.exports.PERSONALBYTES=16;function wi(t,e,n,i,a){if(!(this instanceof wi))return new wi(t,e,n,i,a);if(!fi)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");t||(t=32),!0!==a&&(ui(t>=mi,"digestLength must be at least "+mi+", was given "+t),ui(t<=Li,"digestLength must be at most "+Li+", was given "+t),null!=e&&(ui(e instanceof Uint8Array,"key must be Uint8Array or Buffer"),ui(e.length>=yi,"key must be at least "+yi+", was given "+e.length),ui(e.length<=Ai,"key must be at least "+Ai+", was given "+e.length)),null!=n&&(ui(n instanceof Uint8Array,"salt must be Uint8Array or Buffer"),ui(n.length===bi,"salt must be exactly "+bi+", was given "+n.length)),null!=i&&(ui(i instanceof Uint8Array,"personal must be Uint8Array or Buffer"),ui(i.length===Ii,"personal must be exactly "+Ii+", was given "+i.length))),pi.length||(pi.push(_i),_i+=216),this.digestLength=t,this.finalized=!1,this.pointer=pi.pop(),this._memory=new Uint8Array(fi.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=e?e.length:0,this._memory[2]=1,this._memory[3]=1,n&&this._memory.set(n,32),i&&this._memory.set(i,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),fi.blake2b_init(this.pointer,this.digestLength),e&&(this.update(e),this._memory.fill(0,_i,_i+e.length),this._memory[this.pointer+200]=128)}function Ci(){}function xi(t){return(4294901760&t?(t&=4294901760,16):0)|(4278255360&t?(t&=4278255360,8):0)|(4042322160&t?(t&=4042322160,4):0)|(3435973836&t?(t&=3435973836,2):0)|!!(2863311530&t)}wi.prototype._realloc=function(t){fi.memory.grow(Math.max(0,Math.ceil(Math.abs(t-this._memory.length)/65536))),this._memory=new Uint8Array(fi.memory.buffer)},wi.prototype.update=function(t){return ui(!1===this.finalized,"Hash instance finalized"),ui(t instanceof Uint8Array,"input must be Uint8Array or Buffer"),_i+t.length>this._memory.length&&this._realloc(_i+t.length),this._memory.set(t,_i),fi.blake2b_update(this.pointer,_i,_i+t.length),this},wi.prototype.digest=function(t){if(ui(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,pi.push(this.pointer),fi.blake2b_final(this.pointer),!t||"binary"===t)return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if("string"==typeof t)return gi.toString(this._memory,t,this.pointer+128,this.pointer+128+this.digestLength);ui(t instanceof Uint8Array&&t.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var e=0;e<this.digestLength;e++)t[e]=this._memory[this.pointer+128+e];return t},wi.prototype.final=wi.prototype.digest,wi.WASM=fi,wi.SUPPORTED="undefined"!=typeof WebAssembly,wi.ready=function(t){return t||(t=Ci),hi?hi.then((()=>t()),t):t(new Error("WebAssembly not supported"))},wi.prototype.ready=wi.ready,wi.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)},wi.prototype.setPartialHash=function(t){this._memory.set(t,this.pointer)};const Ei=1,Bi=2,Fi=10,vi=2;async function Pi(t,e,n){const i=await t.read(2*e.G1.F.n8),a=e.G1.fromRprLEM(i,0);return n?e.G1.toObject(a):a}async function Oi(t,e,n){const i=await t.read(2*e.G2.F.n8),a=e.G2.fromRprLEM(i,0);return n?e.G2.toObject(a):a}const{stringifyBigInts:Si}=un;async function Ui(t,e,n){const{fd:i,sections:a}=await Qn(e,"wtns",2),o=await async function(t,e){await Nn(t,e,1);const n=await t.readULE32(),i=await Mn(t,n),a=await t.readULE32();return await qn(t),{n8:n,q:i,nWitness:a}}(i,a),{fd:r,sections:s}=await Qn(t,"zkey",2),c=await async function(t,e,n){await Nn(t,e,1);const i=await t.readULE32();if(await qn(t),i===Ei)return await async function(t,e,n){const i={protocol:"groth16"};await Nn(t,e,2);const a=await t.readULE32();i.n8q=a,i.q=await Mn(t,a);const o=await t.readULE32();return i.n8r=o,i.r=await Mn(t,o),i.curve=await Gn(i.q),i.nVars=await t.readULE32(),i.nPublic=await t.readULE32(),i.domainSize=await t.readULE32(),i.power=xi(i.domainSize),i.vk_alpha_1=await Pi(t,i.curve,n),i.vk_beta_1=await Pi(t,i.curve,n),i.vk_beta_2=await Oi(t,i.curve,n),i.vk_gamma_2=await Oi(t,i.curve,n),i.vk_delta_1=await Pi(t,i.curve,n),i.vk_delta_2=await Oi(t,i.curve,n),await qn(t),i}(t,e,n);if(i===Bi)return await async function(t,e,n){const i={protocol:"plonk"};await Nn(t,e,2);const a=await t.readULE32();i.n8q=a,i.q=await Mn(t,a);const o=await t.readULE32();return i.n8r=o,i.r=await Mn(t,o),i.curve=await Gn(i.q),i.nVars=await t.readULE32(),i.nPublic=await t.readULE32(),i.domainSize=await t.readULE32(),i.power=xi(i.domainSize),i.nAdditions=await t.readULE32(),i.nConstraints=await t.readULE32(),i.k1=await t.read(o),i.k2=await t.read(o),i.Qm=await Pi(t,i.curve,n),i.Ql=await Pi(t,i.curve,n),i.Qr=await Pi(t,i.curve,n),i.Qo=await Pi(t,i.curve,n),i.Qc=await Pi(t,i.curve,n),i.S1=await Pi(t,i.curve,n),i.S2=await Pi(t,i.curve,n),i.S3=await Pi(t,i.curve,n),i.X_2=await Oi(t,i.curve,n),await qn(t),i}(t,e,n);if(i===Fi)return await async function(t,e,n){const i={protocol:"fflonk"};i.protocolId=Fi,await Nn(t,e,vi);const a=await t.readULE32();i.n8q=a,i.q=await Mn(t,a),i.curve=await Gn(i.q);const o=await t.readULE32();return i.n8r=o,i.r=await Mn(t,o),i.nVars=await t.readULE32(),i.nPublic=await t.readULE32(),i.domainSize=await t.readULE32(),i.power=xi(i.domainSize),i.nAdditions=await t.readULE32(),i.nConstraints=await t.readULE32(),i.k1=await t.read(o),i.k2=await t.read(o),i.w3=await t.read(o),i.w4=await t.read(o),i.w8=await t.read(o),i.wr=await t.read(o),i.X_2=await Oi(t,i.curve,n),i.C0=await Pi(t,i.curve,n),await qn(t),i}(t,e,n);throw new Error("Protocol not supported: ")}(r,s);if("groth16"!=c.protocol)throw new Error("zkey file is not groth16");if(!dn.eq(c.r,o.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(o.nWitness!=c.nVars)throw new Error(`Invalid witness length. Circuit: ${c.nVars}, witness: ${o.nWitness}`);const l=c.curve,d=l.Fr,u=l.G1,g=l.G2,f=xi(c.domainSize);n&&n.debug("Reading Wtns");const h=await Dn(i,a,2);n&&n.debug("Reading Coeffs");const _=await Dn(r,s,4);n&&n.debug("Building ABC");const[p,m,L]=await async function(t,e,n,i,a){const o=t.Fr.n8,r=12+e.n8r,s=(i.byteLength-4)/r,c=new Pe(e.domainSize*o),l=new Pe(e.domainSize*o),d=new Pe(e.domainSize*o),u=[c,l];for(let e=0;e<s;e++){a&&e%1e6==0&&a.debug(`QAP AB: ${e}/${s}`);const c=i.slice(4+e*r,4+e*r+r),l=new DataView(c.buffer),d=l.getUint32(0,!0),g=l.getUint32(4,!0),f=l.getUint32(8,!0),h=c.slice(12,12+o);u[d].set(t.Fr.add(u[d].slice(g*o,g*o+o),t.Fr.mul(h,n.slice(f*o,f*o+o))),g*o)}for(let n=0;n<e.domainSize;n++)a&&n%1e6==0&&a.debug(`QAP C: ${n}/${e.domainSize}`),d.set(t.Fr.mul(c.slice(n*o,n*o+o),l.slice(n*o,n*o+o)),n*o);return[c,l,d]}(l,c,h,_,n),y=f==d.s?l.Fr.shift:l.Fr.w[f+1],A=await d.ifft(p,"","",n,"IFFT_A"),b=await d.batchApplyKey(A,d.e(1),y),I=await d.fft(b,"","",n,"FFT_A"),w=await d.ifft(m,"","",n,"IFFT_B"),C=await d.batchApplyKey(w,d.e(1),y),x=await d.fft(C,"","",n,"FFT_B"),E=await d.ifft(L,"","",n,"IFFT_C"),B=await d.batchApplyKey(E,d.e(1),y),F=await d.fft(B,"","",n,"FFT_C");n&&n.debug("Join ABC");const v=await async function(t,e,n,i,a,o){const r=1<<22,s=t.Fr.n8,c=Math.floor(n.byteLength/t.Fr.n8),l=[];for(let e=0;e<c;e+=r){o&&o.debug(`JoinABC: ${e}/${c}`);const d=Math.min(c-e,r),u=[],g=n.slice(e*s,(e+d)*s),f=i.slice(e*s,(e+d)*s),h=a.slice(e*s,(e+d)*s);u.push({cmd:"ALLOCSET",var:0,buff:g}),u.push({cmd:"ALLOCSET",var:1,buff:f}),u.push({cmd:"ALLOCSET",var:2,buff:h}),u.push({cmd:"ALLOC",var:3,len:d*s}),u.push({cmd:"CALL",fnName:"qap_joinABC",params:[{var:0},{var:1},{var:2},{val:d},{var:3}]}),u.push({cmd:"CALL",fnName:"frm_batchFromMontgomery",params:[{var:3},{val:d},{var:3}]}),u.push({cmd:"GET",out:0,var:3,len:d*s}),l.push(t.tm.queueAction(u))}const d=await Promise.all(l);let u;u=n instanceof Pe?new Pe(n.byteLength):new Uint8Array(n.byteLength);let g=0;for(let t=0;t<d.length;t++)u.set(d[t][0],g),g+=d[t][0].byteLength;return u}(l,0,I,x,F,n);let P={};n&&n.debug("Reading A Points");const O=await Dn(r,s,5);P.pi_a=await l.G1.multiExpAffine(O,h,n,"multiexp A"),n&&n.debug("Reading B1 Points");const S=await Dn(r,s,6);let U=await l.G1.multiExpAffine(S,h,n,"multiexp B1");n&&n.debug("Reading B2 Points");const Q=await Dn(r,s,7);P.pi_b=await l.G2.multiExpAffine(Q,h,n,"multiexp B2"),n&&n.debug("Reading C Points");const k=await Dn(r,s,8);P.pi_c=await l.G1.multiExpAffine(k,h.slice((c.nPublic+1)*l.Fr.n8),n,"multiexp C"),n&&n.debug("Reading H Points");const T=await Dn(r,s,9),N=await l.G1.multiExpAffine(T,v,n,"multiexp H"),q=l.Fr.random(),M=l.Fr.random();P.pi_a=u.add(P.pi_a,c.vk_alpha_1),P.pi_a=u.add(P.pi_a,u.timesFr(c.vk_delta_1,q)),P.pi_b=g.add(P.pi_b,c.vk_beta_2),P.pi_b=g.add(P.pi_b,g.timesFr(c.vk_delta_2,M)),U=u.add(U,c.vk_beta_1),U=u.add(U,u.timesFr(c.vk_delta_1,M)),P.pi_c=u.add(P.pi_c,N),P.pi_c=u.add(P.pi_c,u.timesFr(P.pi_a,M)),P.pi_c=u.add(P.pi_c,u.timesFr(U,q)),P.pi_c=u.add(P.pi_c,u.timesFr(c.vk_delta_1,d.neg(d.mul(q,M))));let D=[];for(let t=1;t<=c.nPublic;t++){const e=h.slice(t*d.n8,t*d.n8+d.n8);D.push(dn.fromRprLE(e))}return P.pi_a=u.toObject(u.toAffine(P.pi_a)),P.pi_b=g.toObject(g.toAffine(P.pi_b)),P.pi_c=u.toObject(u.toAffine(P.pi_c)),P.protocol="groth16",P.curve=l.name,await r.close(),await i.close(),P=Si(P),D=Si(D),{proof:P,publicSignals:D}}function Qi(t){var e=[];return function t(e,n){if(Array.isArray(n))for(let i=0;i<n.length;i++)t(e,n[i]);else e.push(n)}(e,t),e}function ki(t,e){let n=BigInt(t)%e;return n<0&&(n+=e),n}function Ti(t){const e=BigInt(2)**BigInt(64);let n=BigInt("0xCBF29CE484222325");for(var i=0;i<t.length;i++)n^=BigInt(t[i].charCodeAt()),n*=BigInt(1099511628211),n%=e;let a=n.toString(16),o=16-a.length;return a="0".repeat(o).concat(a),a}function Ni(t,e){const n=[];let i=BigInt(t);const a=BigInt(4294967296);for(;i;)n.unshift(Number(i%a)),i/=a;if(e)for(var o=e-n.length;o>0;)n.unshift(0),o--;return n}class qi{constructor(t,e,n){this.memory=t,this.i32=new Uint32Array(t.buffer),this.instance=e,this.n32=(this.instance.exports.getFrLen()>>2)-2;const i=this.instance.exports.getPRawPrime(),a=new Array(this.n32);for(let t=0;t<this.n32;t++)a[this.n32-1-t]=this.i32[(i>>2)+t];this.prime=dn.fromArray(a,4294967296),this.Fr=new K(this.prime),this.mask32=dn.fromString("FFFFFFFF",16),this.NVars=this.instance.exports.getNVars(),this.n64=Math.floor((this.Fr.bitLength-1)/64)+1,this.R=this.Fr.e(dn.shiftLeft(1,64*this.n64)),this.RInv=this.Fr.inv(this.R),this.sanityCheck=n}circom_version(){return 1}async _doCalculateWitness(t,e){this.instance.exports.init(this.sanityCheck||e?1:0);const n=this.allocInt(),i=this.allocFr();Object.keys(t).forEach((e=>{const a=Ti(e),o=parseInt(a.slice(0,8),16),r=parseInt(a.slice(8,16),16);try{this.instance.exports.getSignalOffset32(n,0,o,r)}catch(t){throw new Error(`Signal ${e} is not an input of the circuit.`)}const s=this.getInt(n),c=Qi(t[e]);for(let t=0;t<c.length;t++)this.setFr(i,c[t]),this.instance.exports.setSignal(0,0,s+t,i)}))}async calculateWitness(t,e){const n=this,i=n.i32[0],a=[];await n._doCalculateWitness(t,e);for(let t=0;t<n.NVars;t++){const e=n.instance.exports.getPWitness(t);a.push(n.getFr(e))}return n.i32[0]=i,a}async calculateBinWitness(t,e){const n=this,i=n.i32[0];await n._doCalculateWitness(t,e);const a=n.instance.exports.getWitnessBuffer();n.i32[0]=i;const o=n.memory.buffer.slice(a,a+n.NVars*n.n64*8);return new Uint8Array(o)}allocInt(){const t=this.i32[0];return this.i32[0]=t+8,t}allocFr(){const t=this.i32[0];return this.i32[0]=t+4*this.n32+8,t}getInt(t){return this.i32[t>>2]}setInt(t,e){this.i32[t>>2]=e}getFr(t){const e=this,n=t>>2;if(2147483648&e.i32[n+1]){const t=new Array(e.n32);for(let i=0;i<e.n32;i++)t[e.n32-1-i]=e.i32[n+2+i];const i=e.Fr.e(dn.fromArray(t,4294967296));return 1073741824&e.i32[n+1]?function(t){return e.Fr.mul(e.RInv,t)}(i):i}return 2147483648&e.i32[n]?e.Fr.e(e.i32[n]-4294967296):e.Fr.e(e.i32[n])}setFr(t,e){const n=this;e=n.Fr.e(e);const i=n.Fr.neg(n.Fr.e("80000000",16)),a=n.Fr.e("7FFFFFFF",16);if(n.Fr.geq(e,i)&&n.Fr.leq(e,a)){let a;return n.Fr.geq(e,n.Fr.zero)?a=dn.toNumber(e):(a=dn.toNumber(n.Fr.sub(e,i)),a-=2147483648,a=4294967296+a),n.i32[t>>2]=a,void(n.i32[1+(t>>2)]=0)}n.i32[t>>2]=0,n.i32[1+(t>>2)]=2147483648;const o=dn.toArray(e,4294967296);for(let e=0;e<n.n32;e++){const i=o.length-1-e;n.i32[2+(t>>2)+e]=i>=0?o[i]:0}}}class Mi{constructor(t,e){this.instance=t,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();const n=new Uint32Array(this.n32);for(let t=0;t<this.n32;t++)n[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);this.prime=dn.fromArray(n,4294967296),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=e}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(t,e){this.instance.exports.init(this.sanityCheck||e?1:0);const n=Object.keys(t);var i=0;if(n.forEach((e=>{const n=Ti(e),a=parseInt(n.slice(0,8),16),o=parseInt(n.slice(8,16),16),r=Qi(t[e]);if("function"==typeof this.instance.exports.getInputSignalSize){let t=this.instance.exports.getInputSignalSize(a,o);if(t<0)throw new Error(`Signal ${e} not found\n`);if(r.length<t)throw new Error(`Not enough values for input signal ${e}\n`);if(r.length>t)throw new Error(`Too many values for input signal ${e}\n`)}for(let t=0;t<r.length;t++){const e=Ni(ki(r[t],this.prime),this.n32);for(let t=0;t<this.n32;t++)this.instance.exports.writeSharedRWMemory(t,e[this.n32-1-t]);try{this.instance.exports.setInputSignal(a,o,t),i++}catch(t){throw new Error(t)}}})),i<this.instance.exports.getInputSize())throw new Error(`Not all inputs have been set. Only ${i} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(t,e){const n=[];await this._doCalculateWitness(t,e);for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);const e=new Uint32Array(this.n32);for(let t=0;t<this.n32;t++)e[this.n32-1-t]=this.instance.exports.readSharedRWMemory(t);n.push(dn.fromArray(e,4294967296))}return n}async calculateWTNSBin(t,e){const n=new Uint32Array(this.witnessSize*this.n32+this.n32+11),i=new Uint8Array(n.buffer);await this._doCalculateWitness(t,e),i[0]="w".charCodeAt(0),i[1]="t".charCodeAt(0),i[2]="n".charCodeAt(0),i[3]="s".charCodeAt(0),n[1]=2,n[2]=2,n[3]=1;const a=4*this.n32,o=(8+a).toString(16);n[4]=parseInt(o.slice(0,8),16),n[5]=parseInt(o.slice(8,16),16),n[6]=a,this.instance.exports.getRawPrime();var r=7;for(let t=0;t<this.n32;t++)n[r+t]=this.instance.exports.readSharedRWMemory(t);n[r+=this.n32]=this.witnessSize,n[++r]=2,r++;const s=(a*this.witnessSize).toString(16);n[r]=parseInt(s.slice(0,8),16),n[r+1]=parseInt(s.slice(8,16),16),r+=2;for(let t=0;t<this.witnessSize;t++){this.instance.exports.getWitness(t);for(let t=0;t<this.n32;t++)n[r+t]=this.instance.exports.readSharedRWMemory(t);r+=this.n32}return i}}const{unstringifyBigInts:Di}=un;async function Ri(t,e,n,i){const a=Di(t),o=await Un(e),r=await o.read(o.totalSize);await o.close();const s=await async function(t,e){e=e||{};let n,i=32767,a=!1;for(;!a;)try{n=new WebAssembly.Memory({initial:i}),a=!0}catch(t){if(1===i)throw t;console.warn("Could not allocate "+1024*i*64+" bytes. This may cause severe instability. Trying with "+1024*i*64/2+" bytes"),i=Math.floor(i/2)}const o=await WebAssembly.compile(t);let r,s="",c="",l=1,d=0,u=0;const g=await WebAssembly.instantiate(o,{env:{memory:n},runtime:{exceptionHandler:function(t){let e;throw e=1==t?"Signal not found. ":2==t?"Too many signals set. ":3==t?"Signal already set. ":4==t?"Assert Failed. ":5==t?"Not enough memory. ":6==t?"Input signal array access exceeds the size. ":"Unknown error. ",console.error("ERROR: ",t,s),new Error(e+s)},printErrorMessage:function(){s+=h()+"\n"},writeBufferMessage:function(){const t=h();"\n"===t?(console.log(c),c=""):(""!==c&&(c+=" "),c+=t)},showSharedRWMemory:function(){const t=g.exports.getFieldNumLen32(),e=new Uint32Array(t);for(let n=0;n<t;n++)e[t-1-n]=g.exports.readSharedRWMemory(n);if(l>=2&&(d>=1||u>=7)){""!==c&&(c+=" ");const t=dn.fromArray(e,4294967296).toString();c+=t}else console.log(dn.fromArray(e,4294967296))},error:function(t,n,i,a,o,s){let c;throw c=7==t?_(n)+" "+r.getFr(a).toString()+" != "+r.getFr(o).toString()+" "+_(s):9==t?_(n)+" "+r.getFr(a).toString()+" "+_(o):5==t&&e.sym?_(n)+" "+e.sym.labelIdx2Name[o]:_(n)+" "+i+" "+a+" "+o+" "+s,console.log("ERROR: ",t,c),new Error(c)},log:function(t){console.log(r.getFr(t).toString())},logGetSignal:function(t,n){e.logGetSignal&&e.logGetSignal(t,r.getFr(n))},logSetSignal:function(t,n){e.logSetSignal&&e.logSetSignal(t,r.getFr(n))},logStartComponent:function(t){e.logStartComponent&&e.logStartComponent(t)},logFinishComponent:function(t){e.logFinishComponent&&e.logFinishComponent(t)}}});"function"==typeof g.exports.getVersion&&(l=g.exports.getVersion()),"function"==typeof g.exports.getMinorVersion&&(d=g.exports.getMinorVersion()),"function"==typeof g.exports.getPatchVersion&&(u=g.exports.getPatchVersion());const f=e&&(e.sanityCheck||e.logGetSignal||e.logSetSignal||e.logStartComponent||e.logFinishComponent);return r=2===l?new Mi(g,f):new qi(n,g,f),r;function h(){for(var t="",e=g.exports.getMessageChar();0!=e;)t+=String.fromCharCode(e),e=g.exports.getMessageChar();return t}function _(t){const e=new Uint8Array(n.buffer),i=[];for(let n=0;e[t+n]>0;n++)i.push(e[t+n]);return String.fromCharCode.apply(null,i)}}(r);if(1==s.circom_version()){const t=await s.calculateBinWitness(a),e=await async function(t,e,n,i,a,o){const r=await Sn(t,a,o),s=new Uint8Array(4);for(let t=0;t<4;t++)s[t]=e.charCodeAt(t);return await r.write(s,0),await r.writeULE32(n),await r.writeULE32(i),r}(n,"wtns",2,2);await async function(t,e,n){await kn(t,1);const i=8*(Math.floor((dn.bitLength(n)-1)/64)+1);if(await t.writeULE32(i),await async function(t,e,n,i){const a=new Uint8Array(n);dn.toRprLE(a,0,e,n),await t.write(a,i)}(t,n,i),e.byteLength%i!=0)throw new Error("Invalid witness length");await t.writeULE32(e.byteLength/i),await Tn(t),await kn(t,2),await t.write(e),await Tn(t)}(e,t,s.prime),await e.close()}else{const t=await Sn(n),e=await s.calculateWTNSBin(a);await t.write(e),await t.close()}}const{unstringifyBigInts:zi}=un,{unstringifyBigInts:Gi}=un,{unstringifyBigInts:ji}=un;function Vi(t){let e=t.toString(16);for(;e.length<64;)e="0"+e;return e=`"0x${e}"`,e}var Ki=Object.freeze({__proto__:null,fullProve:async function(t,e,n,i){const a=zi(t),o={type:"mem"};return await Ri(a,e,o),await Ui(n,o,i)},prove:Ui,verify:async function(t,e,n,i){const a=Gi(t),o=Gi(n),r=Gi(e),s=await async function(t){let e;const n=function(t){return t.toUpperCase().match(/[A-Za-z0-9]+/g).join("")}(t);if(["BN128","BN254","ALTBN128"].indexOf(n)>=0)e=await cn();else{if(!(["BLS12381"].indexOf(n)>=0))throw new Error(`Curve not supported: ${t}`);e=await ln()}return e}(a.curve),c=s.G1.fromObject(a.IC[0]),l=new Uint8Array(2*s.G1.F.n8*r.length),d=new Uint8Array(s.Fr.n8*r.length);if(!function(t,e){for(let n=0;n<e.length;n++)if(!dn.lt(e[n],t.r))return!1;return!0}(s,r))return i&&i.error("Public inputs are not valid."),!1;for(let t=0;t<r.length;t++){const e=s.G1.fromObject(a.IC[t+1]);l.set(e,t*s.G1.F.n8*2),dn.toRprLE(d,s.Fr.n8*t,r[t],s.Fr.n8)}let u=await s.G1.multiExpAffine(l,d);u=s.G1.add(u,c);const g=s.G1.fromObject(o.pi_a),f=s.G2.fromObject(o.pi_b),h=s.G1.fromObject(o.pi_c);if(!function(t,e){const n=t.G1,i=t.G2;return n.isValid(e.pi_a)&&i.isValid(e.pi_b)&&n.isValid(e.pi_c)}(s,{pi_a:g,pi_b:f,pi_c:h}))return i&&i.error("Proof commitments are not valid."),!1;const _=s.G2.fromObject(a.vk_gamma_2),p=s.G2.fromObject(a.vk_delta_2),m=s.G1.fromObject(a.vk_alpha_1),L=s.G2.fromObject(a.vk_beta_2);return await s.pairingEq(s.G1.neg(g),f,u,_,h,p,m,L)?(i&&i.info("OK!"),!0):(i&&i.error("Invalid proof"),!1)},exportSolidityCallData:async function(t,e){const n=ji(t),i=ji(e);let a,o="";for(let t=0;t<i.length;t++)""!=o&&(o+=","),o+=Vi(i[t]);return a=`[${Vi(n.pi_a[0])}, ${Vi(n.pi_a[1])}],[[${Vi(n.pi_b[0][1])}, ${Vi(n.pi_b[0][0])}],[${Vi(n.pi_b[1][1])}, ${Vi(n.pi_b[1][0])}]],[${Vi(n.pi_c[0])}, ${Vi(n.pi_c[1])}],[${o}]`,a}});dn.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),dn.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const{unstringifyBigInts:Hi}=un,{stringifyBigInts:$i}=un,{unstringifyBigInts:Yi,stringifyBigInts:Ji}=un;var Wi,Zi={exports:{}};Wi=Zi,function(){var t="input is invalid type",e="object"==typeof window,n=e?window:{};n.JS_SHA3_NO_WINDOW&&(e=!1);var i=!e&&"object"==typeof self;!n.JS_SHA3_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node?n=jn:i&&(n=self);var a=!n.JS_SHA3_NO_COMMON_JS&&Wi.exports,o=!n.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,r="0123456789abcdef".split(""),s=[4,1024,262144,67108864],c=[0,8,16,24],l=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],d=[224,256,384,512],u=[128,256],g=["hex","buffer","arrayBuffer","array","digest"],f={128:168,256:136};!n.JS_SHA3_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!o||!n.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"==typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});for(var h=function(t,e,n){return function(i){return new v(t,e,t).update(i)[n]()}},_=function(t,e,n){return function(i,a){return new v(t,e,a).update(i)[n]()}},p=function(t,e,n){return function(e,i,a,o){return b["cshake"+t].update(e,i,a,o)[n]()}},m=function(t,e,n){return function(e,i,a,o){return b["kmac"+t].update(e,i,a,o)[n]()}},L=function(t,e,n,i){for(var a=0;a<g.length;++a){var o=g[a];t[o]=e(n,i,o)}return t},y=function(t,e){var n=h(t,e,"hex");return n.create=function(){return new v(t,e,t)},n.update=function(t){return n.create().update(t)},L(n,h,t,e)},A=[{name:"keccak",padding:[1,256,65536,16777216],bits:d,createMethod:y},{name:"sha3",padding:[6,1536,393216,100663296],bits:d,createMethod:y},{name:"shake",padding:[31,7936,2031616,520093696],bits:u,createMethod:function(t,e){var n=_(t,e,"hex");return n.create=function(n){return new v(t,e,n)},n.update=function(t,e){return n.create(e).update(t)},L(n,_,t,e)}},{name:"cshake",padding:s,bits:u,createMethod:function(t,e){var n=f[t],i=p(t,0,"hex");return i.create=function(i,a,o){return a||o?new v(t,e,i).bytepad([a,o],n):b["shake"+t].create(i)},i.update=function(t,e,n,a){return i.create(e,n,a).update(t)},L(i,p,t,e)}},{name:"kmac",padding:s,bits:u,createMethod:function(t,e){var n=f[t],i=m(t,0,"hex");return i.create=function(i,a,o){return new P(t,e,a).bytepad(["KMAC",o],n).bytepad([i],n)},i.update=function(t,e,n,a){return i.create(t,n,a).update(e)},L(i,m,t,e)}}],b={},I=[],w=0;w<A.length;++w)for(var C=A[w],x=C.bits,E=0;E<x.length;++E){var B=C.name+"_"+x[E];if(I.push(B),b[B]=C.createMethod(x[E],C.padding),"sha3"!==C.name){var F=C.name+x[E];I.push(F),b[F]=b[B]}}function v(t,e,n){this.blocks=[],this.s=[],this.padding=e,this.outputBits=n,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(t<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=n>>5,this.extraBytes=(31&n)>>3;for(var i=0;i<50;++i)this.s[i]=0}function P(t,e,n){v.call(this,t,e,n)}v.prototype.update=function(e){if(this.finalized)throw new Error("finalize already called");var n,i=typeof e;if("string"!==i){if("object"!==i)throw new Error(t);if(null===e)throw new Error(t);if(o&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||o&&ArrayBuffer.isView(e)))throw new Error(t);n=!0}for(var a,r,s=this.blocks,l=this.byteCount,d=e.length,u=this.blockCount,g=0,f=this.s;g<d;){if(this.reset)for(this.reset=!1,s[0]=this.block,a=1;a<u+1;++a)s[a]=0;if(n)for(a=this.start;g<d&&a<l;++g)s[a>>2]|=e[g]<<c[3&a++];else for(a=this.start;g<d&&a<l;++g)(r=e.charCodeAt(g))<128?s[a>>2]|=r<<c[3&a++]:r<2048?(s[a>>2]|=(192|r>>6)<<c[3&a++],s[a>>2]|=(128|63&r)<<c[3&a++]):r<55296||r>=57344?(s[a>>2]|=(224|r>>12)<<c[3&a++],s[a>>2]|=(128|r>>6&63)<<c[3&a++],s[a>>2]|=(128|63&r)<<c[3&a++]):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++g)),s[a>>2]|=(240|r>>18)<<c[3&a++],s[a>>2]|=(128|r>>12&63)<<c[3&a++],s[a>>2]|=(128|r>>6&63)<<c[3&a++],s[a>>2]|=(128|63&r)<<c[3&a++]);if(this.lastByteIndex=a,a>=l){for(this.start=a-l,this.block=s[u],a=0;a<u;++a)f[a]^=s[a];O(f),this.reset=!0}else this.start=a}return this},v.prototype.encode=function(t,e){var n=255&t,i=1,a=[n];for(n=255&(t>>=8);n>0;)a.unshift(n),n=255&(t>>=8),++i;return e?a.push(i):a.unshift(i),this.update(a),a.length},v.prototype.encodeString=function(e){var n,i=typeof e;if("string"!==i){if("object"!==i)throw new Error(t);if(null===e)throw new Error(t);if(o&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||o&&ArrayBuffer.isView(e)))throw new Error(t);n=!0}var a=0,r=e.length;if(n)a=r;else for(var s=0;s<e.length;++s){var c=e.charCodeAt(s);c<128?a+=1:c<2048?a+=2:c<55296||c>=57344?a+=3:(c=65536+((1023&c)<<10|1023&e.charCodeAt(++s)),a+=4)}return a+=this.encode(8*a),this.update(e),a},v.prototype.bytepad=function(t,e){for(var n=this.encode(e),i=0;i<t.length;++i)n+=this.encodeString(t[i]);var a=e-n%e,o=[];return o.length=a,this.update(o),this},v.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex,n=this.blockCount,i=this.s;if(t[e>>2]|=this.padding[3&e],this.lastByteIndex===this.byteCount)for(t[0]=t[n],e=1;e<n+1;++e)t[e]=0;for(t[n-1]|=2147483648,e=0;e<n;++e)i[e]^=t[e];O(i)}},v.prototype.toString=v.prototype.hex=function(){this.finalize();for(var t,e=this.blockCount,n=this.s,i=this.outputBlocks,a=this.extraBytes,o=0,s=0,c="";s<i;){for(o=0;o<e&&s<i;++o,++s)t=n[o],c+=r[t>>4&15]+r[15&t]+r[t>>12&15]+r[t>>8&15]+r[t>>20&15]+r[t>>16&15]+r[t>>28&15]+r[t>>24&15];s%e==0&&(O(n),o=0)}return a&&(t=n[o],c+=r[t>>4&15]+r[15&t],a>1&&(c+=r[t>>12&15]+r[t>>8&15]),a>2&&(c+=r[t>>20&15]+r[t>>16&15])),c},v.prototype.arrayBuffer=function(){this.finalize();var t,e=this.blockCount,n=this.s,i=this.outputBlocks,a=this.extraBytes,o=0,r=0,s=this.outputBits>>3;t=a?new ArrayBuffer(i+1<<2):new ArrayBuffer(s);for(var c=new Uint32Array(t);r<i;){for(o=0;o<e&&r<i;++o,++r)c[r]=n[o];r%e==0&&O(n)}return a&&(c[o]=n[o],t=t.slice(0,s)),t},v.prototype.buffer=v.prototype.arrayBuffer,v.prototype.digest=v.prototype.array=function(){this.finalize();for(var t,e,n=this.blockCount,i=this.s,a=this.outputBlocks,o=this.extraBytes,r=0,s=0,c=[];s<a;){for(r=0;r<n&&s<a;++r,++s)t=s<<2,e=i[r],c[t]=255&e,c[t+1]=e>>8&255,c[t+2]=e>>16&255,c[t+3]=e>>24&255;s%n==0&&O(i)}return o&&(t=s<<2,e=i[r],c[t]=255&e,o>1&&(c[t+1]=e>>8&255),o>2&&(c[t+2]=e>>16&255)),c},P.prototype=new v,P.prototype.finalize=function(){return this.encode(this.outputBits,!0),v.prototype.finalize.call(this)};var O=function(t){var e,n,i,a,o,r,s,c,d,u,g,f,h,_,p,m,L,y,A,b,I,w,C,x,E,B,F,v,P,O,S,U,Q,k,T,N,q,M,D,R,z,G,j,V,K,H,$,Y,J,W,Z,X,tt,et,nt,it,at,ot,rt,st,ct,lt,dt;for(i=0;i<48;i+=2)a=t[0]^t[10]^t[20]^t[30]^t[40],o=t[1]^t[11]^t[21]^t[31]^t[41],r=t[2]^t[12]^t[22]^t[32]^t[42],s=t[3]^t[13]^t[23]^t[33]^t[43],c=t[4]^t[14]^t[24]^t[34]^t[44],d=t[5]^t[15]^t[25]^t[35]^t[45],u=t[6]^t[16]^t[26]^t[36]^t[46],g=t[7]^t[17]^t[27]^t[37]^t[47],e=(f=t[8]^t[18]^t[28]^t[38]^t[48])^(r<<1|s>>>31),n=(h=t[9]^t[19]^t[29]^t[39]^t[49])^(s<<1|r>>>31),t[0]^=e,t[1]^=n,t[10]^=e,t[11]^=n,t[20]^=e,t[21]^=n,t[30]^=e,t[31]^=n,t[40]^=e,t[41]^=n,e=a^(c<<1|d>>>31),n=o^(d<<1|c>>>31),t[2]^=e,t[3]^=n,t[12]^=e,t[13]^=n,t[22]^=e,t[23]^=n,t[32]^=e,t[33]^=n,t[42]^=e,t[43]^=n,e=r^(u<<1|g>>>31),n=s^(g<<1|u>>>31),t[4]^=e,t[5]^=n,t[14]^=e,t[15]^=n,t[24]^=e,t[25]^=n,t[34]^=e,t[35]^=n,t[44]^=e,t[45]^=n,e=c^(f<<1|h>>>31),n=d^(h<<1|f>>>31),t[6]^=e,t[7]^=n,t[16]^=e,t[17]^=n,t[26]^=e,t[27]^=n,t[36]^=e,t[37]^=n,t[46]^=e,t[47]^=n,e=u^(a<<1|o>>>31),n=g^(o<<1|a>>>31),t[8]^=e,t[9]^=n,t[18]^=e,t[19]^=n,t[28]^=e,t[29]^=n,t[38]^=e,t[39]^=n,t[48]^=e,t[49]^=n,_=t[0],p=t[1],H=t[11]<<4|t[10]>>>28,$=t[10]<<4|t[11]>>>28,v=t[20]<<3|t[21]>>>29,P=t[21]<<3|t[20]>>>29,st=t[31]<<9|t[30]>>>23,ct=t[30]<<9|t[31]>>>23,G=t[40]<<18|t[41]>>>14,j=t[41]<<18|t[40]>>>14,k=t[2]<<1|t[3]>>>31,T=t[3]<<1|t[2]>>>31,m=t[13]<<12|t[12]>>>20,L=t[12]<<12|t[13]>>>20,Y=t[22]<<10|t[23]>>>22,J=t[23]<<10|t[22]>>>22,O=t[33]<<13|t[32]>>>19,S=t[32]<<13|t[33]>>>19,lt=t[42]<<2|t[43]>>>30,dt=t[43]<<2|t[42]>>>30,et=t[5]<<30|t[4]>>>2,nt=t[4]<<30|t[5]>>>2,N=t[14]<<6|t[15]>>>26,q=t[15]<<6|t[14]>>>26,y=t[25]<<11|t[24]>>>21,A=t[24]<<11|t[25]>>>21,W=t[34]<<15|t[35]>>>17,Z=t[35]<<15|t[34]>>>17,U=t[45]<<29|t[44]>>>3,Q=t[44]<<29|t[45]>>>3,x=t[6]<<28|t[7]>>>4,E=t[7]<<28|t[6]>>>4,it=t[17]<<23|t[16]>>>9,at=t[16]<<23|t[17]>>>9,M=t[26]<<25|t[27]>>>7,D=t[27]<<25|t[26]>>>7,b=t[36]<<21|t[37]>>>11,I=t[37]<<21|t[36]>>>11,X=t[47]<<24|t[46]>>>8,tt=t[46]<<24|t[47]>>>8,V=t[8]<<27|t[9]>>>5,K=t[9]<<27|t[8]>>>5,B=t[18]<<20|t[19]>>>12,F=t[19]<<20|t[18]>>>12,ot=t[29]<<7|t[28]>>>25,rt=t[28]<<7|t[29]>>>25,R=t[38]<<8|t[39]>>>24,z=t[39]<<8|t[38]>>>24,w=t[48]<<14|t[49]>>>18,C=t[49]<<14|t[48]>>>18,t[0]=_^~m&y,t[1]=p^~L&A,t[10]=x^~B&v,t[11]=E^~F&P,t[20]=k^~N&M,t[21]=T^~q&D,t[30]=V^~H&Y,t[31]=K^~$&J,t[40]=et^~it&ot,t[41]=nt^~at&rt,t[2]=m^~y&b,t[3]=L^~A&I,t[12]=B^~v&O,t[13]=F^~P&S,t[22]=N^~M&R,t[23]=q^~D&z,t[32]=H^~Y&W,t[33]=$^~J&Z,t[42]=it^~ot&st,t[43]=at^~rt&ct,t[4]=y^~b&w,t[5]=A^~I&C,t[14]=v^~O&U,t[15]=P^~S&Q,t[24]=M^~R&G,t[25]=D^~z&j,t[34]=Y^~W&X,t[35]=J^~Z&tt,t[44]=ot^~st&lt,t[45]=rt^~ct&dt,t[6]=b^~w&_,t[7]=I^~C&p,t[16]=O^~U&x,t[17]=S^~Q&E,t[26]=R^~G&k,t[27]=z^~j&T,t[36]=W^~X&V,t[37]=Z^~tt&K,t[46]=st^~lt&et,t[47]=ct^~dt&nt,t[8]=w^~_&m,t[9]=C^~p&L,t[18]=U^~x&B,t[19]=Q^~E&F,t[28]=G^~k&N,t[29]=j^~T&q,t[38]=X^~V&H,t[39]=tt^~K&$,t[48]=lt^~et&it,t[49]=dt^~nt&at,t[0]^=l[i],t[1]^=l[i+1]};if(a)Wi.exports=b;else for(w=0;w<I.length;++w)n[I[w]]=b[I[w]]}();var Xi=Zi.exports;const{keccak256:ta}=Xi,{stringifyBigInts:ea}=un,{unstringifyBigInts:na}=un,{unstringifyBigInts:ia}=un,{unstringifyBigInts:aa}=un,{stringifyBigInts:oa}=un,{unstringifyBigInts:ra}=un,{unstringifyBigInts:sa}=un,{unstringifyBigInts:ca}=un,la="6.13.1";function da(t,e,n){const i=e.split("|").map((t=>t.trim()));for(let n=0;n<i.length;n++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof t===e)return}const a=new Error(`invalid value for type ${e}`);throw a.code="INVALID_ARGUMENT",a.argument=`value.${n}`,a.value=t,a}async function ua(t){const e=Object.keys(t);return(await Promise.all(e.map((e=>Promise.resolve(t[e]))))).reduce(((t,n,i)=>(t[e[i]]=n,t)),{})}function ga(t,e,n){for(let i in e){let a=e[i];const o=n?n[i]:null;o&&da(a,o,i),Object.defineProperty(t,i,{enumerable:!0,value:a,writable:!1})}}function fa(t){if(null==t)return"null";if(Array.isArray(t))return"[ "+t.map(fa).join(", ")+" ]";if(t instanceof Uint8Array){const e="0123456789abcdef";let n="0x";for(let i=0;i<t.length;i++)n+=e[t[i]>>4],n+=e[15&t[i]];return n}if("object"==typeof t&&"function"==typeof t.toJSON)return fa(t.toJSON());switch(typeof t){case"boolean":case"symbol":case"number":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const e=Object.keys(t);return e.sort(),"{ "+e.map((e=>`${fa(e)}: ${fa(t[e])}`)).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function ha(t,e){return t&&t.code===e}function _a(t){return ha(t,"CALL_EXCEPTION")}function pa(t,e,n){let i,a=t;{const i=[];if(n){if("message"in n||"code"in n||"name"in n)throw new Error(`value will overwrite populated values: ${fa(n)}`);for(const t in n){if("shortMessage"===t)continue;const e=n[t];i.push(t+"="+fa(e))}}i.push(`code=${e}`),i.push(`version=${la}`),i.length&&(t+=" ("+i.join(", ")+")")}switch(e){case"INVALID_ARGUMENT":i=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":i=new RangeError(t);break;default:i=new Error(t)}return ga(i,{code:e}),n&&Object.assign(i,n),null==i.shortMessage&&ga(i,{shortMessage:a}),i}function ma(t,e,n,i){if(!t)throw pa(e,n,i)}function La(t,e,n,i){ma(t,e,"INVALID_ARGUMENT",{argument:n,value:i})}function ya(t,e,n){null==n&&(n=""),n&&(n=": "+n),ma(t>=e,"missing arguemnt"+n,"MISSING_ARGUMENT",{count:t,expectedCount:e}),ma(t<=e,"too many arguments"+n,"UNEXPECTED_ARGUMENT",{count:t,expectedCount:e})}const Aa=["NFD","NFC","NFKD","NFKC"].reduce(((t,e)=>{try{if("test"!=="test".normalize(e))throw new Error("bad");if("NFD"===e){if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken")}t.push(e)}catch(t){}return t}),[]);function ba(t,e,n){if(null==n&&(n=""),t!==e){let t=n,e="new";n&&(t+=".",e+=" "+n),ma(!1,`private constructor; use ${t}from* methods`,"UNSUPPORTED_OPERATION",{operation:e})}}const Ia={};function wa(t,e){let n=!1;return e<0&&(n=!0,e*=-1),new Ea(Ia,`${n?"":"u"}int${e}`,t,{signed:n,width:e})}function Ca(t,e){return new Ea(Ia,`bytes${e||""}`,t,{size:e})}const xa=Symbol.for("_ethers_typed");class Ea{type;value;#t;_typedSymbol;constructor(t,e,n,i){null==i&&(i=null),ba(Ia,t,"Typed"),ga(this,{_typedSymbol:xa,type:e,value:n}),this.#t=i,this.format()}format(){if("array"===this.type)throw new Error("");if("dynamicArray"===this.type)throw new Error("");return"tuple"===this.type?`tuple(${this.value.map((t=>t.format())).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return"string"===this.type}get tupleName(){if("tuple"!==this.type)throw TypeError("not a tuple");return this.#t}get arrayLength(){if("array"!==this.type)throw TypeError("not an array");return!0===this.#t?-1:!1===this.#t?this.value.length:null}static from(t,e){return new Ea(Ia,t,e)}static uint8(t){return wa(t,8)}static uint16(t){return wa(t,16)}static uint24(t){return wa(t,24)}static uint32(t){return wa(t,32)}static uint40(t){return wa(t,40)}static uint48(t){return wa(t,48)}static uint56(t){return wa(t,56)}static uint64(t){return wa(t,64)}static uint72(t){return wa(t,72)}static uint80(t){return wa(t,80)}static uint88(t){return wa(t,88)}static uint96(t){return wa(t,96)}static uint104(t){return wa(t,104)}static uint112(t){return wa(t,112)}static uint120(t){return wa(t,120)}static uint128(t){return wa(t,128)}static uint136(t){return wa(t,136)}static uint144(t){return wa(t,144)}static uint152(t){return wa(t,152)}static uint160(t){return wa(t,160)}static uint168(t){return wa(t,168)}static uint176(t){return wa(t,176)}static uint184(t){return wa(t,184)}static uint192(t){return wa(t,192)}static uint200(t){return wa(t,200)}static uint208(t){return wa(t,208)}static uint216(t){return wa(t,216)}static uint224(t){return wa(t,224)}static uint232(t){return wa(t,232)}static uint240(t){return wa(t,240)}static uint248(t){return wa(t,248)}static uint256(t){return wa(t,256)}static uint(t){return wa(t,256)}static int8(t){return wa(t,-8)}static int16(t){return wa(t,-16)}static int24(t){return wa(t,-24)}static int32(t){return wa(t,-32)}static int40(t){return wa(t,-40)}static int48(t){return wa(t,-48)}static int56(t){return wa(t,-56)}static int64(t){return wa(t,-64)}static int72(t){return wa(t,-72)}static int80(t){return wa(t,-80)}static int88(t){return wa(t,-88)}static int96(t){return wa(t,-96)}static int104(t){return wa(t,-104)}static int112(t){return wa(t,-112)}static int120(t){return wa(t,-120)}static int128(t){return wa(t,-128)}static int136(t){return wa(t,-136)}static int144(t){return wa(t,-144)}static int152(t){return wa(t,-152)}static int160(t){return wa(t,-160)}static int168(t){return wa(t,-168)}static int176(t){return wa(t,-176)}static int184(t){return wa(t,-184)}static int192(t){return wa(t,-192)}static int200(t){return wa(t,-200)}static int208(t){return wa(t,-208)}static int216(t){return wa(t,-216)}static int224(t){return wa(t,-224)}static int232(t){return wa(t,-232)}static int240(t){return wa(t,-240)}static int248(t){return wa(t,-248)}static int256(t){return wa(t,-256)}static int(t){return wa(t,-256)}static bytes1(t){return Ca(t,1)}static bytes2(t){return Ca(t,2)}static bytes3(t){return Ca(t,3)}static bytes4(t){return Ca(t,4)}static bytes5(t){return Ca(t,5)}static bytes6(t){return Ca(t,6)}static bytes7(t){return Ca(t,7)}static bytes8(t){return Ca(t,8)}static bytes9(t){return Ca(t,9)}static bytes10(t){return Ca(t,10)}static bytes11(t){return Ca(t,11)}static bytes12(t){return Ca(t,12)}static bytes13(t){return Ca(t,13)}static bytes14(t){return Ca(t,14)}static bytes15(t){return Ca(t,15)}static bytes16(t){return Ca(t,16)}static bytes17(t){return Ca(t,17)}static bytes18(t){return Ca(t,18)}static bytes19(t){return Ca(t,19)}static bytes20(t){return Ca(t,20)}static bytes21(t){return Ca(t,21)}static bytes22(t){return Ca(t,22)}static bytes23(t){return Ca(t,23)}static bytes24(t){return Ca(t,24)}static bytes25(t){return Ca(t,25)}static bytes26(t){return Ca(t,26)}static bytes27(t){return Ca(t,27)}static bytes28(t){return Ca(t,28)}static bytes29(t){return Ca(t,29)}static bytes30(t){return Ca(t,30)}static bytes31(t){return Ca(t,31)}static bytes32(t){return Ca(t,32)}static address(t){return new Ea(Ia,"address",t)}static bool(t){return new Ea(Ia,"bool",!!t)}static bytes(t){return new Ea(Ia,"bytes",t)}static string(t){return new Ea(Ia,"string",t)}static array(t,e){throw new Error("not implemented yet")}static tuple(t,e){throw new Error("not implemented yet")}static overrides(t){return new Ea(Ia,"overrides",Object.assign({},t))}static isTyped(t){return t&&"object"==typeof t&&"_typedSymbol"in t&&t._typedSymbol===xa}static dereference(t,e){if(Ea.isTyped(t)){if(t.type!==e)throw new Error(`invalid type: expecetd ${e}, got ${t.type}`);return t.value}return t}}function Ba(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Fa(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function va(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}const Pa=BigInt(2**32-1),Oa=BigInt(32);function Sa(t,e=!1){return e?{h:Number(t&Pa),l:Number(t>>Oa&Pa)}:{h:0|Number(t>>Oa&Pa),l:0|Number(t&Pa)}}function Ua(t,e=!1){let n=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let a=0;a<t.length;a++){const{h:o,l:r}=Sa(t[a],e);[n[a],i[a]]=[o,r]}return[n,i]}if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function Qa(t){if("string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),!(t instanceof Uint8Array))throw new Error("expected Uint8Array, got "+typeof t);return t}class ka{clone(){return this._cloneInto()}}const[Ta,Na,qa]=[[],[],[]],Ma=BigInt(0),Da=BigInt(1),Ra=BigInt(2),za=BigInt(7),Ga=BigInt(256),ja=BigInt(113);for(let t=0,e=Da,n=1,i=0;t<24;t++){[n,i]=[i,(2*n+3*i)%5],Ta.push(2*(5*i+n)),Na.push((t+1)*(t+2)/2%64);let a=Ma;for(let t=0;t<7;t++)e=(e<<Da^(e>>za)*ja)%Ga,e&Ra&&(a^=Da<<(Da<<BigInt(t))-Da);qa.push(a)}const[Va,Ka]=Ua(qa,!0),Ha=(t,e,n)=>n>32?((t,e,n)=>e<<n-32|t>>>64-n)(t,e,n):((t,e,n)=>t<<n|e>>>32-n)(t,e,n),$a=(t,e,n)=>n>32?((t,e,n)=>t<<n-32|e>>>64-n)(t,e,n):((t,e,n)=>e<<n|t>>>32-n)(t,e,n);class Ya extends ka{constructor(t,e,n,i=!1,a=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=n,this.enableXOF=i,this.rounds=a,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Ba(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");var o;this.state=new Uint8Array(200),this.state32=(o=this.state,new Uint32Array(o.buffer,o.byteOffset,Math.floor(o.byteLength/4)))}keccak(){!function(t,e=24){const n=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let e=0;e<10;e++)n[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){const i=(e+8)%10,a=(e+2)%10,o=n[a],r=n[a+1],s=Ha(o,r,1)^n[i],c=$a(o,r,1)^n[i+1];for(let n=0;n<50;n+=10)t[e+n]^=s,t[e+n+1]^=c}let e=t[2],a=t[3];for(let n=0;n<24;n++){const i=Na[n],o=Ha(e,a,i),r=$a(e,a,i),s=Ta[n];e=t[s],a=t[s+1],t[s]=o,t[s+1]=r}for(let e=0;e<50;e+=10){for(let i=0;i<10;i++)n[i]=t[e+i];for(let i=0;i<10;i++)t[e+i]^=~n[(i+2)%10]&n[(i+4)%10]}t[0]^=Va[i],t[1]^=Ka[i]}n.fill(0)}(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){va(this);const{blockLen:e,state:n}=this,i=(t=Qa(t)).length;for(let a=0;a<i;){const o=Math.min(e-this.pos,i-a);for(let e=0;e<o;e++)n[this.pos++]^=t[a++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:n,blockLen:i}=this;t[n]^=e,128&e&&n===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){va(this,!1),Fa(t),this.finish();const e=this.state,{blockLen:n}=this;for(let i=0,a=t.length;i<a;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,a-i);t.set(e.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Ba(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(function(t,e){Fa(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:e,suffix:n,outputLen:i,rounds:a,enableXOF:o}=this;return t||(t=new Ya(e,n,i,o,a)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=a,t.suffix=n,t.outputLen=i,t.enableXOF=o,t.destroyed=this.destroyed,t}}const Ja=((t,e,n)=>function(t){const e=e=>t().update(Qa(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}((()=>new Ya(e,t,n))))(1,136,32);function Wa(t,e,n){if(t instanceof Uint8Array)return n?new Uint8Array(t):t;if("string"==typeof t&&t.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const e=new Uint8Array((t.length-2)/2);let n=2;for(let i=0;i<e.length;i++)e[i]=parseInt(t.substring(n,n+2),16),n+=2;return e}La(!1,"invalid BytesLike value",e||"value",t)}function Za(t,e){return Wa(t,e,!1)}function Xa(t,e){return Wa(t,e,!0)}function to(t,e){return!("string"!=typeof t||!t.match(/^0x[0-9A-Fa-f]*$/)||"number"==typeof e&&t.length!==2+2*e||!0===e&&t.length%2!=0)}const eo="0123456789abcdef";function no(t){const e=Za(t);let n="0x";for(let t=0;t<e.length;t++){const i=e[t];n+=eo[(240&i)>>4]+eo[15&i]}return n}function io(t){return"0x"+t.map((t=>no(t).substring(2))).join("")}function ao(t,e,n){const i=Za(t);return null!=n&&n>i.length&&ma(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:i,length:i.length,offset:n}),no(i.slice(null==e?0:e,null==n?i.length:n))}function oo(t,e,n){const i=Za(t);ma(e>=i.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(i),length:e,offset:e+1});const a=new Uint8Array(e);return a.fill(0),n?a.set(i,e-i.length):a.set(i,0),no(a)}let ro=!1;const so=function(t){return Ja(t)};let co=so;function lo(t){const e=Za(t,"data");return no(co(e))}function uo(t,e,n,i,a){if("BAD_PREFIX"===t||"UNEXPECTED_CONTINUE"===t){let t=0;for(let i=e+1;i<n.length&&n[i]>>6==2;i++)t++;return t}return"OVERRUN"===t?n.length-e-1:0}lo._=so,lo.lock=function(){ro=!0},lo.register=function(t){if(ro)throw new TypeError("keccak256 is locked");co=t},Object.freeze(lo);const go=Object.freeze({error:function(t,e,n,i,a){La(!1,`invalid codepoint at offset ${e}; ${t}`,"bytes",n)},ignore:uo,replace:function(t,e,n,i,a){return"OVERLONG"===t?(La("number"==typeof a,"invalid bad code point for replacement","badCodepoint",a),i.push(a),0):(i.push(65533),uo(t,e,n))}});function fo(t,e){La("string"==typeof t,"invalid string value","str",t),null!=e&&(function(t){ma(Aa.indexOf(t)>=0,"platform missing String.prototype.normalize","UNSUPPORTED_OPERATION",{operation:"String.prototype.normalize",info:{form:t}})}(e),t=t.normalize(e));let n=[];for(let e=0;e<t.length;e++){const i=t.charCodeAt(e);if(i<128)n.push(i);else if(i<2048)n.push(i>>6|192),n.push(63&i|128);else if(55296==(64512&i)){e++;const a=t.charCodeAt(e);La(e<t.length&&56320==(64512&a),"invalid surrogate pair","str",t);const o=65536+((1023&i)<<10)+(1023&a);n.push(o>>18|240),n.push(o>>12&63|128),n.push(o>>6&63|128),n.push(63&o|128)}else n.push(i>>12|224),n.push(i>>6&63|128),n.push(63&i|128)}return new Uint8Array(n)}function ho(t,e){return function(t,e){null==e&&(e=go.error);const n=Za(t,"bytes"),i=[];let a=0;for(;a<n.length;){const t=n[a++];if(!(t>>7)){i.push(t);continue}let o=null,r=null;if(192==(224&t))o=1,r=127;else if(224==(240&t))o=2,r=2047;else{if(240!=(248&t)){a+=e(128==(192&t)?"UNEXPECTED_CONTINUE":"BAD_PREFIX",a-1,n,i);continue}o=3,r=65535}if(a-1+o>=n.length){a+=e("OVERRUN",a-1,n,i);continue}let s=t&(1<<8-o-1)-1;for(let t=0;t<o;t++){let t=n[a];if(128!=(192&t)){a+=e("MISSING_CONTINUE",a,n,i),s=null;break}s=s<<6|63&t,a++}null!==s&&(s>1114111?a+=e("OUT_OF_RANGE",a-1-o,n,i,s):s>=55296&&s<=57343?a+=e("UTF16_SURROGATE",a-1-o,n,i,s):s<=r?a+=e("OVERLONG",a-1-o,n,i,s):i.push(s))}return i}(t,e).map((t=>t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10&1023),56320+(1023&t))))).join("")}function _o(t){return lo(fo(t))}const po=BigInt(0),mo=BigInt(1),Lo=9007199254740991;function yo(t,e){const n=bo(t,"value"),i=BigInt(Co(e,"bits"));return n&(mo<<i)-mo}function Ao(t,e){switch(typeof t){case"bigint":return t;case"number":return La(Number.isInteger(t),"underflow",e||"value",t),La(t>=-Lo&&t<=Lo,"overflow",e||"value",t),BigInt(t);case"string":try{if(""===t)throw new Error("empty string");return"-"===t[0]&&"-"!==t[1]?-BigInt(t.substring(1)):BigInt(t)}catch(n){La(!1,`invalid BigNumberish string: ${n.message}`,e||"value",t)}}La(!1,"invalid BigNumberish value",e||"value",t)}function bo(t,e){const n=Ao(t,e);return ma(n>=po,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),n}const Io="0123456789abcdef";function wo(t){if(t instanceof Uint8Array){let e="0x0";for(const n of t)e+=Io[n>>4],e+=Io[15&n];return BigInt(e)}return Ao(t)}function Co(t,e){switch(typeof t){case"bigint":return La(t>=-Lo&&t<=Lo,"overflow",e||"value",t),Number(t);case"number":return La(Number.isInteger(t),"underflow",e||"value",t),La(t>=-Lo&&t<=Lo,"overflow",e||"value",t),t;case"string":try{if(""===t)throw new Error("empty string");return Co(BigInt(t),e)}catch(n){La(!1,`invalid numeric string: ${n.message}`,e||"value",t)}}La(!1,"invalid numeric value",e||"value",t)}function xo(t,e){let n=bo(t,"value").toString(16);if(null==e)n.length%2&&(n="0"+n);else{const i=Co(e,"width");for(ma(2*i>=n.length,`value exceeds width (${i} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:t});n.length<2*i;)n="0"+n}return"0x"+n}const Eo=32,Bo=new Uint8Array(Eo),Fo=["then"],vo={},Po=new WeakMap;function Oo(t){return Po.get(t)}function So(t,e){Po.set(t,e)}function Uo(t,e){const n=new Error(`deferred error during ABI decoding triggered accessing ${t}`);throw n.error=e,n}function Qo(t,e,n){return t.indexOf(null)>=0?e.map(((t,e)=>t instanceof ko?Qo(Oo(t),t,n):t)):t.reduce(((t,i,a)=>{let o=e.getValue(i);return i in t||(n&&o instanceof ko&&(o=Qo(Oo(o),o,n)),t[i]=o),t}),{})}class ko extends Array{#e;constructor(...t){const e=t[0];let n=t[1],i=(t[2]||[]).slice(),a=!0;e!==vo&&(n=t,i=[],a=!1),super(n.length),n.forEach(((t,e)=>{this[e]=t}));const o=i.reduce(((t,e)=>("string"==typeof e&&t.set(e,(t.get(e)||0)+1),t)),new Map);if(So(this,Object.freeze(n.map(((t,e)=>{const n=i[e];return null!=n&&1===o.get(n)?n:null})))),this.#e=[],null==this.#e&&this.#e,!a)return;Object.freeze(this);const r=new Proxy(this,{get:(t,e,n)=>{if("string"==typeof e){if(e.match(/^[0-9]+$/)){const n=Co(e,"%index");if(n<0||n>=this.length)throw new RangeError("out of result range");const i=t[n];return i instanceof Error&&Uo(`index ${n}`,i),i}if(Fo.indexOf(e)>=0)return Reflect.get(t,e,n);const i=t[e];if(i instanceof Function)return function(...e){return i.apply(this===n?t:this,e)};if(!(e in t))return t.getValue.apply(this===n?t:this,[e])}return Reflect.get(t,e,n)}});return So(r,Oo(this)),r}toArray(t){const e=[];return this.forEach(((n,i)=>{n instanceof Error&&Uo(`index ${i}`,n),t&&n instanceof ko&&(n=n.toArray(t)),e.push(n)})),e}toObject(t){const e=Oo(this);return e.reduce(((n,i,a)=>(ma(null!=i,`value at index ${a} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),Qo(e,this,t))),{})}slice(t,e){null==t&&(t=0),t<0&&(t+=this.length)<0&&(t=0),null==e&&(e=this.length),e<0&&(e+=this.length)<0&&(e=0),e>this.length&&(e=this.length);const n=Oo(this),i=[],a=[];for(let o=t;o<e;o++)i.push(this[o]),a.push(n[o]);return new ko(vo,i,a)}filter(t,e){const n=Oo(this),i=[],a=[];for(let o=0;o<this.length;o++){const r=this[o];r instanceof Error&&Uo(`index ${o}`,r),t.call(e,r,o,this)&&(i.push(r),a.push(n[o]))}return new ko(vo,i,a)}map(t,e){const n=[];for(let i=0;i<this.length;i++){const a=this[i];a instanceof Error&&Uo(`index ${i}`,a),n.push(t.call(e,a,i,this))}return n}getValue(t){const e=Oo(this).indexOf(t);if(-1===e)return;const n=this[e];return n instanceof Error&&Uo(`property ${JSON.stringify(t)}`,n.error),n}static fromItems(t,e){return new ko(vo,t,e)}}function To(t){let e=function(t){const e=bo(t,"value");if(e===po)return new Uint8Array([]);let n=e.toString(16);n.length%2&&(n="0"+n);const i=new Uint8Array(n.length/2);for(let t=0;t<i.length;t++){const e=2*t;i[t]=parseInt(n.substring(e,e+2),16)}return i}(t);return ma(e.length<=Eo,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:Eo,offset:e.length}),e.length!==Eo&&(e=Xa(io([Bo.slice(e.length%Eo),e]))),e}class No{name;type;localName;dynamic;constructor(t,e,n,i){ga(this,{name:t,type:e,localName:n,dynamic:i},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(t,e){La(!1,t,this.localName,e)}}class qo{#n;#i;constructor(){this.#n=[],this.#i=0}get data(){return io(this.#n)}get length(){return this.#i}#a(t){return this.#n.push(t),this.#i+=t.length,t.length}appendWriter(t){return this.#a(Xa(t.data))}writeBytes(t){let e=Xa(t);const n=e.length%Eo;return n&&(e=Xa(io([e,Bo.slice(n)]))),this.#a(e)}writeValue(t){return this.#a(To(t))}writeUpdatableValue(){const t=this.#n.length;return this.#n.push(Bo),this.#i+=Eo,e=>{this.#n[t]=To(e)}}}class Mo{allowLoose;#n;#o;#r;#s;#c;constructor(t,e,n){ga(this,{allowLoose:!!e}),this.#n=Xa(t),this.#r=0,this.#s=null,this.#c=null!=n?n:1024,this.#o=0}get data(){return no(this.#n)}get dataLength(){return this.#n.length}get consumed(){return this.#o}get bytes(){return new Uint8Array(this.#n)}#l(t){if(this.#s)return this.#s.#l(t);this.#r+=t,ma(this.#c<1||this.#r<=this.#c*this.dataLength,`compressed ABI data exceeds inflation ratio of ${this.#c} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:Xa(this.#n),offset:this.#o,length:t,info:{bytesRead:this.#r,dataLength:this.dataLength}})}#d(t,e,n){let i=Math.ceil(e/Eo)*Eo;return this.#o+i>this.#n.length&&(this.allowLoose&&n&&this.#o+e<=this.#n.length?i=e:ma(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:Xa(this.#n),length:this.#n.length,offset:this.#o+i})),this.#n.slice(this.#o,this.#o+i)}subReader(t){const e=new Mo(this.#n.slice(this.#o+t),this.allowLoose,this.#c);return e.#s=this,e}readBytes(t,e){let n=this.#d(0,t,!!e);return this.#l(t),this.#o+=n.length,n.slice(0,t)}readValue(){return wo(this.readBytes(Eo))}readIndex(){return Co(wo(this.readBytes(Eo)))}}const Do=BigInt(0),Ro=BigInt(36);function zo(t){const e=(t=t.toLowerCase()).substring(2).split(""),n=new Uint8Array(40);for(let t=0;t<40;t++)n[t]=e[t].charCodeAt(0);const i=Za(lo(n));for(let t=0;t<40;t+=2)i[t>>1]>>4>=8&&(e[t]=e[t].toUpperCase()),(15&i[t>>1])>=8&&(e[t+1]=e[t+1].toUpperCase());return"0x"+e.join("")}const Go={};for(let t=0;t<10;t++)Go[String(t)]=String(t);for(let t=0;t<26;t++)Go[String.fromCharCode(65+t)]=String(10+t);const jo=15;const Vo=function(){const t={};for(let e=0;e<36;e++)t["0123456789abcdefghijklmnopqrstuvwxyz"[e]]=BigInt(e);return t}();function Ko(t){if(La("string"==typeof t,"invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);const e=zo(t);return La(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){La(t.substring(2,4)===function(t){let e=(t=(t=t.toUpperCase()).substring(4)+t.substring(0,2)+"00").split("").map((t=>Go[t])).join("");for(;e.length>=jo;){let t=e.substring(0,jo);e=parseInt(t,10)%97+e.substring(t.length)}let n=String(98-parseInt(e,10)%97);for(;n.length<2;)n="0"+n;return n}(t),"bad icap checksum","address",t);let e=function(t){t=t.toLowerCase();let e=Do;for(let n=0;n<t.length;n++)e=e*Ro+Vo[t[n]];return e}(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return zo("0x"+e)}La(!1,"invalid address","address",t)}class Ho extends No{constructor(t){super("address","address",t,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(t,e){let n=Ea.dereference(e,"string");try{n=Ko(n)}catch(t){return this._throwError(t.message,e)}return t.writeValue(n)}decode(t){return Ko(xo(t.readValue(),20))}}class $o extends No{coder;constructor(t){super(t.name,t.type,"_",t.dynamic),this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,e){return this.coder.encode(t,e)}decode(t){return this.coder.decode(t)}}function Yo(t,e,n){let i=[];if(Array.isArray(n))i=n;else if(n&&"object"==typeof n){let t={};i=e.map((e=>{const i=e.localName;return ma(i,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:e},value:n}),ma(!t[i],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:e},value:n}),t[i]=!0,n[i]}))}else La(!1,"invalid tuple value","tuple",n);La(e.length===i.length,"types/value length mismatch","tuple",n);let a=new qo,o=new qo,r=[];e.forEach(((t,e)=>{let n=i[e];if(t.dynamic){let e=o.length;t.encode(o,n);let i=a.writeUpdatableValue();r.push((t=>{i(t+e)}))}else t.encode(a,n)})),r.forEach((t=>{t(a.length)}));let s=t.appendWriter(a);return s+=t.appendWriter(o),s}function Jo(t,e){let n=[],i=[],a=t.subReader(0);return e.forEach((e=>{let o=null;if(e.dynamic){let n=t.readIndex(),i=a.subReader(n);try{o=e.decode(i)}catch(t){if(ha(t,"BUFFER_OVERRUN"))throw t;o=t,o.baseType=e.name,o.name=e.localName,o.type=e.type}}else try{o=e.decode(t)}catch(t){if(ha(t,"BUFFER_OVERRUN"))throw t;o=t,o.baseType=e.name,o.name=e.localName,o.type=e.type}if(null==o)throw new Error("investigate");n.push(o),i.push(e.localName||null)})),ko.fromItems(n,i)}class Wo extends No{coder;length;constructor(t,e,n){super("array",t.type+"["+(e>=0?e:"")+"]",n,-1===e||t.dynamic),ga(this,{coder:t,length:e})}defaultValue(){const t=this.coder.defaultValue(),e=[];for(let n=0;n<this.length;n++)e.push(t);return e}encode(t,e){const n=Ea.dereference(e,"array");Array.isArray(n)||this._throwError("expected array value",n);let i=this.length;-1===i&&(i=n.length,t.writeValue(n.length)),ya(n.length,i,"coder array"+(this.localName?" "+this.localName:""));let a=[];for(let t=0;t<n.length;t++)a.push(this.coder);return Yo(t,a,n)}decode(t){let e=this.length;-1===e&&(e=t.readIndex(),ma(e*Eo<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:e*Eo,length:t.dataLength}));let n=[];for(let t=0;t<e;t++)n.push(new $o(this.coder));return Jo(t,n)}}class Zo extends No{constructor(t){super("bool","bool",t,!1)}defaultValue(){return!1}encode(t,e){const n=Ea.dereference(e,"bool");return t.writeValue(n?1:0)}decode(t){return!!t.readValue()}}class Xo extends No{constructor(t,e){super(t,t,e,!0)}defaultValue(){return"0x"}encode(t,e){e=Xa(e);let n=t.writeValue(e.length);return n+=t.writeBytes(e),n}decode(t){return t.readBytes(t.readIndex(),!0)}}class tr extends Xo{constructor(t){super("bytes",t)}decode(t){return no(super.decode(t))}}class er extends No{size;constructor(t,e){let n="bytes"+String(t);super(n,n,e,!1),ga(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+2*this.size)}encode(t,e){let n=Xa(Ea.dereference(e,this.type));return n.length!==this.size&&this._throwError("incorrect data length",e),t.writeBytes(n)}decode(t){return no(t.readBytes(this.size))}}const nr=new Uint8Array([]);class ir extends No{constructor(t){super("null","",t,!1)}defaultValue(){return null}encode(t,e){return null!=e&&this._throwError("not null",e),t.writeBytes(nr)}decode(t){return t.readBytes(0),null}}const ar=BigInt(0),or=BigInt(1),rr=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class sr extends No{size;signed;constructor(t,e,n){const i=(e?"int":"uint")+8*t;super(i,i,n,!1),ga(this,{size:t,signed:e},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,e){let n=Ao(Ea.dereference(e,this.type)),i=yo(rr,256);if(this.signed){let t=yo(i,8*this.size-1);(n>t||n<-(t+or))&&this._throwError("value out-of-bounds",e),n=function(t,e){let n=Ao(t,"value");const i=BigInt(Co(256,"width")),a=mo<<i-mo;return n<po?(n=-n,ma(n<=a,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t}),(~n&(mo<<i)-mo)+mo):(ma(n<a,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t}),n)}(n)}else(n<ar||n>yo(i,8*this.size))&&this._throwError("value out-of-bounds",e);return t.writeValue(n)}decode(t){let e=yo(t.readValue(),8*this.size);return this.signed&&(e=function(t,e){const n=bo(t,"value"),i=BigInt(Co(e,"width"));return ma(n>>i===po,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:t}),n>>i-mo?-((~n&(mo<<i)-mo)+mo):n}(e,8*this.size)),e}}class cr extends Xo{constructor(t){super("string",t)}defaultValue(){return""}encode(t,e){return super.encode(t,fo(Ea.dereference(e,"string")))}decode(t){return ho(super.decode(t))}}class lr extends No{coders;constructor(t,e){let n=!1;const i=[];t.forEach((t=>{t.dynamic&&(n=!0),i.push(t.type)})),super("tuple","tuple("+i.join(",")+")",e,n),ga(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach((e=>{t.push(e.defaultValue())}));const e=this.coders.reduce(((t,e)=>{const n=e.localName;return n&&(t[n]||(t[n]=0),t[n]++),t}),{});return this.coders.forEach(((n,i)=>{let a=n.localName;a&&1===e[a]&&("length"===a&&(a="_length"),null==t[a]&&(t[a]=t[i]))})),Object.freeze(t)}encode(t,e){const n=Ea.dereference(e,"tuple");return Yo(t,this.coders,n)}decode(t){return Jo(t,this.coders)}}function dr(t){const e=new Set;return t.forEach((t=>e.add(t))),Object.freeze(e)}const ur=dr("external public payable override".split(" ")),gr="constant external internal payable private public pure view override",fr=dr(gr.split(" ")),hr="constructor error event fallback function receive struct",_r=dr(hr.split(" ")),pr="calldata memory storage payable indexed",mr=dr(pr.split(" ")),Lr=dr([hr,pr,"tuple returns",gr].join(" ").split(" ")),yr={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},Ar=new RegExp("^(\\s*)"),br=new RegExp("^([0-9]+)"),Ir=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),wr=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),Cr=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");class xr{#o;#u;get offset(){return this.#o}get length(){return this.#u.length-this.#o}constructor(t){this.#o=0,this.#u=t.slice()}clone(){return new xr(this.#u)}reset(){this.#o=0}#g(t=0,e=0){return new xr(this.#u.slice(t,e).map((e=>Object.freeze(Object.assign({},e,{match:e.match-t,linkBack:e.linkBack-t,linkNext:e.linkNext-t})))))}popKeyword(t){const e=this.peek();if("KEYWORD"!==e.type||!t.has(e.text))throw new Error(`expected keyword ${e.text}`);return this.pop().text}popType(t){if(this.peek().type!==t){const e=this.peek();throw new Error(`expected ${t}; got ${e.type} ${JSON.stringify(e.text)}`)}return this.pop().text}popParen(){const t=this.peek();if("OPEN_PAREN"!==t.type)throw new Error("bad start");const e=this.#g(this.#o+1,t.match+1);return this.#o=t.match+1,e}popParams(){const t=this.peek();if("OPEN_PAREN"!==t.type)throw new Error("bad start");const e=[];for(;this.#o<t.match-1;){const t=this.peek().linkNext;e.push(this.#g(this.#o+1,t)),this.#o=t}return this.#o=t.match+1,e}peek(){if(this.#o>=this.#u.length)throw new Error("out-of-bounds");return this.#u[this.#o]}peekKeyword(t){const e=this.peekType("KEYWORD");return null!=e&&t.has(e)?e:null}peekType(t){if(0===this.length)return null;const e=this.peek();return e.type===t?e.text:null}pop(){const t=this.peek();return this.#o++,t}toString(){const t=[];for(let e=this.#o;e<this.#u.length;e++){const n=this.#u[e];t.push(`${n.type}:${n.text}`)}return`<TokenString ${t.join(" ")}>`}}function Er(t){const e=[],n=e=>{const n=o<t.length?JSON.stringify(t[o]):"$EOI";throw new Error(`invalid token ${n} at ${o}: ${e}`)};let i=[],a=[],o=0;for(;o<t.length;){let r=t.substring(o),s=r.match(Ar);s&&(o+=s[1].length,r=t.substring(o));const c={depth:i.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:o,value:-1};e.push(c);let l=yr[r[0]]||"";if(l){if(c.type=l,c.text=r[0],o++,"OPEN_PAREN"===l)i.push(e.length-1),a.push(e.length-1);else if("CLOSE_PAREN"==l)0===i.length&&n("no matching open bracket"),c.match=i.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=a.pop(),e[c.linkBack].linkNext=e.length-1;else if("COMMA"===l)c.linkBack=a.pop(),e[c.linkBack].linkNext=e.length-1,a.push(e.length-1);else if("OPEN_BRACKET"===l)c.type="BRACKET";else if("CLOSE_BRACKET"===l){let t=e.pop().text;if(e.length>0&&"NUMBER"===e[e.length-1].type){const n=e.pop().text;t=n+t,e[e.length-1].value=Co(n)}if(0===e.length||"BRACKET"!==e[e.length-1].type)throw new Error("missing opening bracket");e[e.length-1].text+=t}}else if(s=r.match(Ir),s){if(c.text=s[1],o+=c.text.length,Lr.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(Cr)){c.type="TYPE";continue}c.type="ID"}else{if(s=r.match(br),!s)throw new Error(`unexpected token ${JSON.stringify(r[0])} at position ${o}`);c.text=s[1],c.type="NUMBER",o+=c.text.length}}return new xr(e.map((t=>Object.freeze(t))))}function Br(t,e){let n=[];for(const i in e.keys())t.has(i)&&n.push(i);if(n.length>1)throw new Error(`conflicting types: ${n.join(", ")}`)}function Fr(t,e){if(e.peekKeyword(_r)){const n=e.pop().text;if(n!==t)throw new Error(`expected ${t}, got ${n}`)}return e.popType("ID")}function vr(t,e){const n=new Set;for(;;){const i=t.peekType("KEYWORD");if(null==i||e&&!e.has(i))break;if(t.pop(),n.has(i))throw new Error(`duplicate keywords: ${JSON.stringify(i)}`);n.add(i)}return Object.freeze(n)}function Pr(t){let e=vr(t,fr);return Br(e,dr("constant payable nonpayable".split(" "))),Br(e,dr("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function Or(t,e){return t.popParams().map((t=>Vr.from(t,e)))}function Sr(t){if(t.peekType("AT")){if(t.pop(),t.peekType("NUMBER"))return Ao(t.pop().text);throw new Error("invalid gas")}return null}function Ur(t){if(t.length)throw new Error(`unexpected tokens at offset ${t.offset}: ${t.toString()}`)}const Qr=new RegExp(/^(.*)\[([0-9]*)\]$/);function kr(t){const e=t.match(Cr);if(La(e,"invalid type","type",t),"uint"===t)return"uint256";if("int"===t)return"int256";if(e[2]){const n=parseInt(e[2]);La(0!==n&&n<=32,"invalid bytes length","type",t)}else if(e[3]){const n=parseInt(e[3]);La(0!==n&&n<=256&&n%8==0,"invalid numeric width","type",t)}return t}const Tr={},Nr=Symbol.for("_ethers_internal"),qr="_ParamTypeInternal",Mr="_ErrorInternal",Dr="_EventInternal",Rr="_ConstructorInternal",zr="_FallbackInternal",Gr="_FunctionInternal",jr="_StructInternal";class Vr{name;type;baseType;indexed;components;arrayLength;arrayChildren;constructor(t,e,n,i,a,o,r,s){if(ba(t,Tr,"ParamType"),Object.defineProperty(this,Nr,{value:qr}),o&&(o=Object.freeze(o.slice())),"array"===i){if(null==r||null==s)throw new Error("")}else if(null!=r||null!=s)throw new Error("");if("tuple"===i){if(null==o)throw new Error("")}else if(null!=o)throw new Error("");ga(this,{name:e,type:n,baseType:i,indexed:a,components:o,arrayLength:r,arrayChildren:s})}format(t){if(null==t&&(t="sighash"),"json"===t){const e=this.name||"";if(this.isArray()){const t=JSON.parse(this.arrayChildren.format("json"));return t.name=e,t.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(t)}const n={type:"tuple"===this.baseType?"tuple":this.type,name:e};return"boolean"==typeof this.indexed&&(n.indexed=this.indexed),this.isTuple()&&(n.components=this.components.map((e=>JSON.parse(e.format(t))))),JSON.stringify(n)}let e="";return this.isArray()?(e+=this.arrayChildren.format(t),e+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?e+="("+this.components.map((e=>e.format(t))).join("full"===t?", ":",")+")":e+=this.type,"sighash"!==t&&(!0===this.indexed&&(e+=" indexed"),"full"===t&&this.name&&(e+=" "+this.name)),e}isArray(){return"array"===this.baseType}isTuple(){return"tuple"===this.baseType}isIndexable(){return null!=this.indexed}walk(t,e){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(-1!==this.arrayLength&&t.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return t.map((t=>n.arrayChildren.walk(t,e)))}if(this.isTuple()){if(!Array.isArray(t))throw new Error("invalid tuple value");if(t.length!==this.components.length)throw new Error("array is wrong length");const n=this;return t.map(((t,i)=>n.components[i].walk(t,e)))}return e(this.type,t)}#f(t,e,n,i){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(-1!==this.arrayLength&&e.length!==this.arrayLength)throw new Error("array is wrong length");const a=this.arrayChildren,o=e.slice();return o.forEach(((e,i)=>{a.#f(t,e,n,(t=>{o[i]=t}))})),void i(o)}if(this.isTuple()){const a=this.components;let o;if(Array.isArray(e))o=e.slice();else{if(null==e||"object"!=typeof e)throw new Error("invalid tuple value");o=a.map((t=>{if(!t.name)throw new Error("cannot use object value with unnamed components");if(!(t.name in e))throw new Error(`missing value for component ${t.name}`);return e[t.name]}))}if(o.length!==this.components.length)throw new Error("array is wrong length");return o.forEach(((e,i)=>{a[i].#f(t,e,n,(t=>{o[i]=t}))})),void i(o)}const a=n(this.type,e);a.then?t.push(async function(){i(await a)}()):i(a)}async walkAsync(t,e){const n=[],i=[t];return this.#f(n,t,e,(t=>{i[0]=t})),n.length&&await Promise.all(n),i[0]}static from(t,e){if(Vr.isParamType(t))return t;if("string"==typeof t)try{return Vr.from(Er(t),e)}catch(e){La(!1,"invalid param type","obj",t)}else if(t instanceof xr){let n="",i="",a=null;vr(t,dr(["tuple"])).has("tuple")||t.peekType("OPEN_PAREN")?(i="tuple",a=t.popParams().map((t=>Vr.from(t))),n=`tuple(${a.map((t=>t.format())).join(",")})`):(n=kr(t.popType("TYPE")),i=n);let o=null,r=null;for(;t.length&&t.peekType("BRACKET");){const e=t.pop();o=new Vr(Tr,"",n,i,null,a,r,o),r=e.value,n+=e.text,i="array",a=null}let s=null;if(vr(t,mr).has("indexed")){if(!e)throw new Error("");s=!0}const c=t.peekType("ID")?t.pop().text:"";if(t.length)throw new Error("leftover tokens");return new Vr(Tr,c,n,i,s,a,r,o)}const n=t.name;La(!n||"string"==typeof n&&n.match(wr),"invalid name","obj.name",n);let i=t.indexed;null!=i&&(La(e,"parameter cannot be indexed","obj.indexed",t.indexed),i=!!i);let a=t.type,o=a.match(Qr);if(o){const e=parseInt(o[2]||"-1"),r=Vr.from({type:o[1],components:t.components});return new Vr(Tr,n||"",a,"array",i,null,e,r)}if("tuple"===a||a.startsWith("tuple(")||a.startsWith("(")){const e=null!=t.components?t.components.map((t=>Vr.from(t))):null;return new Vr(Tr,n||"",a,"tuple",i,e,null,null)}return a=kr(t.type),new Vr(Tr,n||"",a,a,i,null,null,null)}static isParamType(t){return t&&t[Nr]===qr}}class Kr{type;inputs;constructor(t,e,n){ba(t,Tr,"Fragment"),ga(this,{type:e,inputs:n=Object.freeze(n.slice())})}static from(t){if("string"==typeof t){try{Kr.from(JSON.parse(t))}catch(t){}return Kr.from(Er(t))}if(t instanceof xr)switch(t.peekKeyword(_r)){case"constructor":return Wr.from(t);case"error":return Yr.from(t);case"event":return Jr.from(t);case"fallback":case"receive":return Zr.from(t);case"function":return Xr.from(t);case"struct":return ts.from(t)}else if("object"==typeof t){switch(t.type){case"constructor":return Wr.from(t);case"error":return Yr.from(t);case"event":return Jr.from(t);case"fallback":case"receive":return Zr.from(t);case"function":return Xr.from(t);case"struct":return ts.from(t)}ma(!1,`unsupported type: ${t.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}La(!1,"unsupported frgament object","obj",t)}static isConstructor(t){return Wr.isFragment(t)}static isError(t){return Yr.isFragment(t)}static isEvent(t){return Jr.isFragment(t)}static isFunction(t){return Xr.isFragment(t)}static isStruct(t){return ts.isFragment(t)}}class Hr extends Kr{name;constructor(t,e,n,i){super(t,e,i),La("string"==typeof n&&n.match(wr),"invalid identifier","name",n),i=Object.freeze(i.slice()),ga(this,{name:n})}}function $r(t,e){return"("+e.map((e=>e.format(t))).join("full"===t?", ":",")+")"}class Yr extends Hr{constructor(t,e,n){super(t,"error",e,n),Object.defineProperty(this,Nr,{value:Mr})}get selector(){return _o(this.format("sighash")).substring(0,10)}format(t){if(null==t&&(t="sighash"),"json"===t)return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map((e=>JSON.parse(e.format(t))))});const e=[];return"sighash"!==t&&e.push("error"),e.push(this.name+$r(t,this.inputs)),e.join(" ")}static from(t){if(Yr.isFragment(t))return t;if("string"==typeof t)return Yr.from(Er(t));if(t instanceof xr){const e=Fr("error",t),n=Or(t);return Ur(t),new Yr(Tr,e,n)}return new Yr(Tr,t.name,t.inputs?t.inputs.map(Vr.from):[])}static isFragment(t){return t&&t[Nr]===Mr}}class Jr extends Hr{anonymous;constructor(t,e,n,i){super(t,"event",e,n),Object.defineProperty(this,Nr,{value:Dr}),ga(this,{anonymous:i})}get topicHash(){return _o(this.format("sighash"))}format(t){if(null==t&&(t="sighash"),"json"===t)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map((e=>JSON.parse(e.format(t))))});const e=[];return"sighash"!==t&&e.push("event"),e.push(this.name+$r(t,this.inputs)),"sighash"!==t&&this.anonymous&&e.push("anonymous"),e.join(" ")}static getTopicHash(t,e){return e=(e||[]).map((t=>Vr.from(t))),new Jr(Tr,t,e,!1).topicHash}static from(t){if(Jr.isFragment(t))return t;if("string"==typeof t)try{return Jr.from(Er(t))}catch(e){La(!1,"invalid event fragment","obj",t)}else if(t instanceof xr){const e=Fr("event",t),n=Or(t,!0),i=!!vr(t,dr(["anonymous"])).has("anonymous");return Ur(t),new Jr(Tr,e,n,i)}return new Jr(Tr,t.name,t.inputs?t.inputs.map((t=>Vr.from(t,!0))):[],!!t.anonymous)}static isFragment(t){return t&&t[Nr]===Dr}}class Wr extends Kr{payable;gas;constructor(t,e,n,i,a){super(t,e,n),Object.defineProperty(this,Nr,{value:Rr}),ga(this,{payable:i,gas:a})}format(t){if(ma(null!=t&&"sighash"!==t,"cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),"json"===t)return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:null!=this.gas?this.gas:void 0,inputs:this.inputs.map((e=>JSON.parse(e.format(t))))});const e=[`constructor${$r(t,this.inputs)}`];return this.payable&&e.push("payable"),null!=this.gas&&e.push(`@${this.gas.toString()}`),e.join(" ")}static from(t){if(Wr.isFragment(t))return t;if("string"==typeof t)try{return Wr.from(Er(t))}catch(e){La(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof xr){vr(t,dr(["constructor"]));const e=Or(t),n=!!vr(t,ur).has("payable"),i=Sr(t);return Ur(t),new Wr(Tr,"constructor",e,n,i)}return new Wr(Tr,"constructor",t.inputs?t.inputs.map(Vr.from):[],!!t.payable,null!=t.gas?t.gas:null)}static isFragment(t){return t&&t[Nr]===Rr}}class Zr extends Kr{payable;constructor(t,e,n){super(t,"fallback",e),Object.defineProperty(this,Nr,{value:zr}),ga(this,{payable:n})}format(t){const e=0===this.inputs.length?"receive":"fallback";if("json"===t){const t=this.payable?"payable":"nonpayable";return JSON.stringify({type:e,stateMutability:t})}return`${e}()${this.payable?" payable":""}`}static from(t){if(Zr.isFragment(t))return t;if("string"==typeof t)try{return Zr.from(Er(t))}catch(e){La(!1,"invalid fallback fragment","obj",t)}else if(t instanceof xr){const e=t.toString();if(La(t.peekKeyword(dr(["fallback","receive"])),"type must be fallback or receive","obj",e),"receive"===t.popKeyword(dr(["fallback","receive"]))){const e=Or(t);return La(0===e.length,"receive cannot have arguments","obj.inputs",e),vr(t,dr(["payable"])),Ur(t),new Zr(Tr,[],!0)}let n=Or(t);n.length?La(1===n.length&&"bytes"===n[0].type,"invalid fallback inputs","obj.inputs",n.map((t=>t.format("minimal"))).join(", ")):n=[Vr.from("bytes")];const i=Pr(t);if(La("nonpayable"===i||"payable"===i,"fallback cannot be constants","obj.stateMutability",i),vr(t,dr(["returns"])).has("returns")){const e=Or(t);La(1===e.length&&"bytes"===e[0].type,"invalid fallback outputs","obj.outputs",e.map((t=>t.format("minimal"))).join(", "))}return Ur(t),new Zr(Tr,n,"payable"===i)}if("receive"===t.type)return new Zr(Tr,[],!0);if("fallback"===t.type){const e=[Vr.from("bytes")],n="payable"===t.stateMutability;return new Zr(Tr,e,n)}La(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[Nr]===zr}}class Xr extends Hr{constant;outputs;stateMutability;payable;gas;constructor(t,e,n,i,a,o){super(t,"function",e,i),Object.defineProperty(this,Nr,{value:Gr}),ga(this,{constant:"view"===n||"pure"===n,gas:o,outputs:a=Object.freeze(a.slice()),payable:"payable"===n,stateMutability:n})}get selector(){return _o(this.format("sighash")).substring(0,10)}format(t){if(null==t&&(t="sighash"),"json"===t)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:null!=this.gas?this.gas:void 0,inputs:this.inputs.map((e=>JSON.parse(e.format(t)))),outputs:this.outputs.map((e=>JSON.parse(e.format(t))))});const e=[];return"sighash"!==t&&e.push("function"),e.push(this.name+$r(t,this.inputs)),"sighash"!==t&&("nonpayable"!==this.stateMutability&&e.push(this.stateMutability),this.outputs&&this.outputs.length&&(e.push("returns"),e.push($r(t,this.outputs))),null!=this.gas&&e.push(`@${this.gas.toString()}`)),e.join(" ")}static getSelector(t,e){return e=(e||[]).map((t=>Vr.from(t))),new Xr(Tr,t,"view",e,[],null).selector}static from(t){if(Xr.isFragment(t))return t;if("string"==typeof t)try{return Xr.from(Er(t))}catch(e){La(!1,"invalid function fragment","obj",t)}else if(t instanceof xr){const e=Fr("function",t),n=Or(t),i=Pr(t);let a=[];vr(t,dr(["returns"])).has("returns")&&(a=Or(t));const o=Sr(t);return Ur(t),new Xr(Tr,e,i,n,a,o)}let e=t.stateMutability;return null==e&&(e="payable","boolean"==typeof t.constant?(e="view",t.constant||(e="payable","boolean"!=typeof t.payable||t.payable||(e="nonpayable"))):"boolean"!=typeof t.payable||t.payable||(e="nonpayable")),new Xr(Tr,t.name,e,t.inputs?t.inputs.map(Vr.from):[],t.outputs?t.outputs.map(Vr.from):[],null!=t.gas?t.gas:null)}static isFragment(t){return t&&t[Nr]===Gr}}class ts extends Hr{constructor(t,e,n){super(t,"struct",e,n),Object.defineProperty(this,Nr,{value:jr})}format(){throw new Error("@TODO")}static from(t){if("string"==typeof t)try{return ts.from(Er(t))}catch(e){La(!1,"invalid struct fragment","obj",t)}else if(t instanceof xr){const e=Fr("struct",t),n=Or(t);return Ur(t),new ts(Tr,e,n)}return new ts(Tr,t.name,t.inputs?t.inputs.map(Vr.from):[])}static isFragment(t){return t&&t[Nr]===jr}}const es=new Map;es.set(0,"GENERIC_PANIC"),es.set(1,"ASSERT_FALSE"),es.set(17,"OVERFLOW"),es.set(18,"DIVIDE_BY_ZERO"),es.set(33,"ENUM_RANGE_ERROR"),es.set(34,"BAD_STORAGE_DATA"),es.set(49,"STACK_UNDERFLOW"),es.set(50,"ARRAY_RANGE_ERROR"),es.set(65,"OUT_OF_MEMORY"),es.set(81,"UNINITIALIZED_FUNCTION_CALL");const ns=new RegExp(/^bytes([0-9]*)$/),is=new RegExp(/^(u?int)([0-9]*)$/);let as=null,os=1024;class rs{#h(t){if(t.isArray())return new Wo(this.#h(t.arrayChildren),t.arrayLength,t.name);if(t.isTuple())return new lr(t.components.map((t=>this.#h(t))),t.name);switch(t.baseType){case"address":return new Ho(t.name);case"bool":return new Zo(t.name);case"string":return new cr(t.name);case"bytes":return new tr(t.name);case"":return new ir(t.name)}let e=t.type.match(is);if(e){let n=parseInt(e[2]||"256");return La(0!==n&&n<=256&&n%8==0,"invalid "+e[1]+" bit length","param",t),new sr(n/8,"int"===e[1],t.name)}if(e=t.type.match(ns),e){let n=parseInt(e[1]);return La(0!==n&&n<=32,"invalid bytes length","param",t),new er(n,t.name)}La(!1,"invalid type","type",t.type)}getDefaultValue(t){const e=t.map((t=>this.#h(Vr.from(t))));return new lr(e,"_").defaultValue()}encode(t,e){ya(e.length,t.length,"types/values length mismatch");const n=t.map((t=>this.#h(Vr.from(t)))),i=new lr(n,"_"),a=new qo;return i.encode(a,e),a.data}decode(t,e,n){const i=t.map((t=>this.#h(Vr.from(t))));return new lr(i,"_").decode(new Mo(e,n,os))}static _setDefaultMaxInflation(t){La("number"==typeof t&&Number.isInteger(t),"invalid defaultMaxInflation factor","value",t),os=t}static defaultAbiCoder(){return null==as&&(as=new rs),as}static getBuiltinCallException(t,e,n){return function(t,e,n,i){let a="missing revert data",o=null,r=null;if(n){a="execution reverted";const t=Za(n);if(n=no(n),0===t.length)a+=" (no data present; likely require(false) occurred",o="require(false)";else if(t.length%32!=4)a+=" (could not decode reason; invalid data length)";else if("0x08c379a0"===no(t.slice(0,4)))try{o=i.decode(["string"],t.slice(4))[0],r={signature:"Error(string)",name:"Error",args:[o]},a+=`: ${JSON.stringify(o)}`}catch(t){a+=" (could not decode reason; invalid string data)"}else if("0x4e487b71"===no(t.slice(0,4)))try{const e=Number(i.decode(["uint256"],t.slice(4))[0]);r={signature:"Panic(uint256)",name:"Panic",args:[e]},o=`Panic due to ${es.get(e)||"UNKNOWN"}(${e})`,a+=`: ${o}`}catch(t){a+=" (could not decode panic code)"}else a+=" (unknown custom error)"}const s={to:e.to?Ko(e.to):null,data:e.data||"0x"};return e.from&&(s.from=Ko(e.from)),pa(a,"CALL_EXCEPTION",{action:t,data:n,reason:o,transaction:s,invocation:null,revert:r})}(t,e,n,rs.defaultAbiCoder())}}class ss{fragment;name;signature;topic;args;constructor(t,e,n){const i=t.name,a=t.format();ga(this,{fragment:t,name:i,signature:a,topic:e,args:n})}}class cs{fragment;name;args;signature;selector;value;constructor(t,e,n,i){const a=t.name,o=t.format();ga(this,{fragment:t,name:a,args:n,signature:o,selector:e,value:i})}}class ls{fragment;name;args;signature;selector;constructor(t,e,n){const i=t.name,a=t.format();ga(this,{fragment:t,name:i,args:n,signature:a,selector:e})}}class ds{hash;_isIndexed;static isIndexed(t){return!(!t||!t._isIndexed)}constructor(t){ga(this,{hash:t,_isIndexed:!0})}}const us={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},gs={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:t=>`reverted with reason string ${JSON.stringify(t)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:t=>{let e="unknown panic code";return t>=0&&t<=255&&us[t.toString()]&&(e=us[t.toString()]),`reverted with panic code 0x${t.toString(16)} (${e})`}}};class fs{fragments;deploy;fallback;receive;#_;#p;#m;#L;constructor(t){let e=[];e="string"==typeof t?JSON.parse(t):t,this.#m=new Map,this.#_=new Map,this.#p=new Map;const n=[];for(const t of e)try{n.push(Kr.from(t))}catch(e){console.log(`[Warning] Invalid Fragment ${JSON.stringify(t)}:`,e.message)}ga(this,{fragments:Object.freeze(n)});let i=null,a=!1;this.#L=this.getAbiCoder(),this.fragments.forEach(((t,e)=>{let n;switch(t.type){case"constructor":return this.deploy?void console.log("duplicate definition - constructor"):void ga(this,{deploy:t});case"fallback":return void(0===t.inputs.length?a=!0:(La(!i||t.payable!==i.payable,"conflicting fallback fragments",`fragments[${e}]`,t),i=t,a=i.payable));case"function":n=this.#m;break;case"event":n=this.#p;break;case"error":n=this.#_;break;default:return}const o=t.format();n.has(o)||n.set(o,t)})),this.deploy||ga(this,{deploy:Wr.from("constructor()")}),ga(this,{fallback:i,receive:a})}format(t){const e=t?"minimal":"full";return this.fragments.map((t=>t.format(e)))}formatJson(){const t=this.fragments.map((t=>t.format("json")));return JSON.stringify(t.map((t=>JSON.parse(t))))}getAbiCoder(){return rs.defaultAbiCoder()}#y(t,e,n){if(to(t)){const e=t.toLowerCase();for(const t of this.#m.values())if(e===t.selector)return t;return null}if(-1===t.indexOf("(")){const i=[];for(const[e,n]of this.#m)e.split("(")[0]===t&&i.push(n);if(e){const t=e.length>0?e[e.length-1]:null;let n=e.length,a=!0;Ea.isTyped(t)&&"overrides"===t.type&&(a=!1,n--);for(let t=i.length-1;t>=0;t--){const e=i[t].inputs.length;e===n||a&&e===n-1||i.splice(t,1)}for(let t=i.length-1;t>=0;t--){const n=i[t].inputs;for(let a=0;a<e.length;a++)if(Ea.isTyped(e[a])){if(a>=n.length){if("overrides"===e[a].type)continue;i.splice(t,1);break}if(e[a].type!==n[a].baseType){i.splice(t,1);break}}}}if(1===i.length&&e&&e.length!==i[0].inputs.length){const t=e[e.length-1];(null==t||Array.isArray(t)||"object"!=typeof t)&&i.splice(0,1)}return 0===i.length?null:(i.length>1&&n&&La(!1,`ambiguous function description (i.e. matches ${i.map((t=>JSON.stringify(t.format()))).join(", ")})`,"key",t),i[0])}return this.#m.get(Xr.from(t).format())||null}getFunctionName(t){const e=this.#y(t,null,!1);return La(e,"no matching function","key",t),e.name}hasFunction(t){return!!this.#y(t,null,!1)}getFunction(t,e){return this.#y(t,e||null,!0)}forEachFunction(t){const e=Array.from(this.#m.keys());e.sort(((t,e)=>t.localeCompare(e)));for(let n=0;n<e.length;n++){const i=e[n];t(this.#m.get(i),n)}}#A(t,e,n){if(to(t)){const e=t.toLowerCase();for(const t of this.#p.values())if(e===t.topicHash)return t;return null}if(-1===t.indexOf("(")){const i=[];for(const[e,n]of this.#p)e.split("(")[0]===t&&i.push(n);if(e){for(let t=i.length-1;t>=0;t--)i[t].inputs.length<e.length&&i.splice(t,1);for(let t=i.length-1;t>=0;t--){const n=i[t].inputs;for(let a=0;a<e.length;a++)if(Ea.isTyped(e[a])&&e[a].type!==n[a].baseType){i.splice(t,1);break}}}return 0===i.length?null:(i.length>1&&n&&La(!1,`ambiguous event description (i.e. matches ${i.map((t=>JSON.stringify(t.format()))).join(", ")})`,"key",t),i[0])}return this.#p.get(Jr.from(t).format())||null}getEventName(t){const e=this.#A(t,null,!1);return La(e,"no matching event","key",t),e.name}hasEvent(t){return!!this.#A(t,null,!1)}getEvent(t,e){return this.#A(t,e||null,!0)}forEachEvent(t){const e=Array.from(this.#p.keys());e.sort(((t,e)=>t.localeCompare(e)));for(let n=0;n<e.length;n++){const i=e[n];t(this.#p.get(i),n)}}getError(t,e){if(to(t)){const e=t.toLowerCase();if(gs[e])return Yr.from(gs[e].signature);for(const t of this.#_.values())if(e===t.selector)return t;return null}if(-1===t.indexOf("(")){const e=[];for(const[n,i]of this.#_)n.split("(")[0]===t&&e.push(i);return 0===e.length?"Error"===t?Yr.from("error Error(string)"):"Panic"===t?Yr.from("error Panic(uint256)"):null:(e.length>1&&La(!1,`ambiguous error description (i.e. ${e.map((t=>JSON.stringify(t.format()))).join(", ")})`,"name",t),e[0])}if("Error(string)"===(t=Yr.from(t).format()))return Yr.from("error Error(string)");if("Panic(uint256)"===t)return Yr.from("error Panic(uint256)");return this.#_.get(t)||null}forEachError(t){const e=Array.from(this.#_.keys());e.sort(((t,e)=>t.localeCompare(e)));for(let n=0;n<e.length;n++){const i=e[n];t(this.#_.get(i),n)}}_decodeParams(t,e){return this.#L.decode(t,e)}_encodeParams(t,e){return this.#L.encode(t,e)}encodeDeploy(t){return this._encodeParams(this.deploy.inputs,t||[])}decodeErrorResult(t,e){if("string"==typeof t){const e=this.getError(t);La(e,"unknown error","fragment",t),t=e}return La(ao(e,0,4)===t.selector,`data signature does not match error ${t.name}.`,"data",e),this._decodeParams(t.inputs,ao(e,4))}encodeErrorResult(t,e){if("string"==typeof t){const e=this.getError(t);La(e,"unknown error","fragment",t),t=e}return io([t.selector,this._encodeParams(t.inputs,e||[])])}decodeFunctionData(t,e){if("string"==typeof t){const e=this.getFunction(t);La(e,"unknown function","fragment",t),t=e}return La(ao(e,0,4)===t.selector,`data signature does not match function ${t.name}.`,"data",e),this._decodeParams(t.inputs,ao(e,4))}encodeFunctionData(t,e){if("string"==typeof t){const e=this.getFunction(t);La(e,"unknown function","fragment",t),t=e}return io([t.selector,this._encodeParams(t.inputs,e||[])])}decodeFunctionResult(t,e){if("string"==typeof t){const e=this.getFunction(t);La(e,"unknown function","fragment",t),t=e}let n="invalid length for result data";const i=Xa(e);if(i.length%32==0)try{return this.#L.decode(t.outputs,i)}catch(t){n="could not decode result data"}ma(!1,n,"BAD_DATA",{value:no(i),info:{method:t.name,signature:t.format()}})}makeError(t,e){const n=Za(t,"data"),i=rs.getBuiltinCallException("call",e,n);if(i.message.startsWith("execution reverted (unknown custom error)")){const t=no(n.slice(0,4)),e=this.getError(t);if(e)try{const t=this.#L.decode(e.inputs,n.slice(4));i.revert={name:e.name,signature:e.format(),args:t},i.reason=i.revert.signature,i.message=`execution reverted: ${i.reason}`}catch(t){i.message="execution reverted (coult not decode custom error)"}}const a=this.parseTransaction(e);return a&&(i.invocation={method:a.name,signature:a.signature,args:a.args}),i}encodeFunctionResult(t,e){if("string"==typeof t){const e=this.getFunction(t);La(e,"unknown function","fragment",t),t=e}return no(this.#L.encode(t.outputs,e||[]))}encodeFilterTopics(t,e){if("string"==typeof t){const e=this.getEvent(t);La(e,"unknown event","eventFragment",t),t=e}ma(e.length<=t.inputs.length,`too many arguments for ${t.format()}`,"UNEXPECTED_ARGUMENT",{count:e.length,expectedCount:t.inputs.length});const n=[];t.anonymous||n.push(t.topicHash);const i=(t,e)=>"string"===t.type?_o(e):"bytes"===t.type?lo(no(e)):("bool"===t.type&&"boolean"==typeof e?e=e?"0x01":"0x00":t.type.match(/^u?int/)?e=xo(e):t.type.match(/^bytes/)?e=oo(e,32,!1):"address"===t.type&&this.#L.encode(["address"],[e]),oo(no(e),32,!0));for(e.forEach(((e,a)=>{const o=t.inputs[a];o.indexed?null==e?n.push(null):"array"===o.baseType||"tuple"===o.baseType?La(!1,"filtering with tuples or arrays not supported","contract."+o.name,e):Array.isArray(e)?n.push(e.map((t=>i(o,t)))):n.push(i(o,e)):La(null==e,"cannot filter non-indexed parameters; must be null","contract."+o.name,e)}));n.length&&null===n[n.length-1];)n.pop();return n}encodeEventLog(t,e){if("string"==typeof t){const e=this.getEvent(t);La(e,"unknown event","eventFragment",t),t=e}const n=[],i=[],a=[];return t.anonymous||n.push(t.topicHash),La(e.length===t.inputs.length,"event arguments/values mismatch","values",e),t.inputs.forEach(((t,o)=>{const r=e[o];if(t.indexed)if("string"===t.type)n.push(_o(r));else if("bytes"===t.type)n.push(lo(r));else{if("tuple"===t.baseType||"array"===t.baseType)throw new Error("not implemented");n.push(this.#L.encode([t.type],[r]))}else i.push(t),a.push(r)})),{data:this.#L.encode(i,a),topics:n}}decodeEventLog(t,e,n){if("string"==typeof t){const e=this.getEvent(t);La(e,"unknown event","eventFragment",t),t=e}if(null!=n&&!t.anonymous){const e=t.topicHash;La(to(n[0],32)&&n[0].toLowerCase()===e,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const i=[],a=[],o=[];t.inputs.forEach(((t,e)=>{t.indexed?"string"===t.type||"bytes"===t.type||"tuple"===t.baseType||"array"===t.baseType?(i.push(Vr.from({type:"bytes32",name:t.name})),o.push(!0)):(i.push(t),o.push(!1)):(a.push(t),o.push(!1))}));const r=null!=n?this.#L.decode(i,io(n)):null,s=this.#L.decode(a,e,!0),c=[],l=[];let d=0,u=0;return t.inputs.forEach(((t,e)=>{let n=null;if(t.indexed)if(null==r)n=new ds(null);else if(o[e])n=new ds(r[u++]);else try{n=r[u++]}catch(t){n=t}else try{n=s[d++]}catch(t){n=t}c.push(n),l.push(t.name||null)})),ko.fromItems(c,l)}parseTransaction(t){const e=Za(t.data,"tx.data"),n=Ao(null!=t.value?t.value:0,"tx.value"),i=this.getFunction(no(e.slice(0,4)));if(!i)return null;const a=this.#L.decode(i.inputs,e.slice(4));return new cs(i,i.selector,a,n)}parseCallResult(t){throw new Error("@TODO")}parseLog(t){const e=this.getEvent(t.topics[0]);return!e||e.anonymous?null:new ss(e,e.topicHash,this.decodeEventLog(e,t.data,t.topics))}parseError(t){const e=no(t),n=this.getError(ao(e,0,4));if(!n)return null;const i=this.#L.decode(n.inputs,ao(e,4));return new ls(n,n.selector,i)}static from(t){return t instanceof fs?t:"string"==typeof t?new fs(JSON.parse(t)):"function"==typeof t.formatJson?new fs(t.formatJson()):"function"==typeof t.format?new fs(t.format("json")):new fs(t)}}function hs(t){return t&&"function"==typeof t.getAddress}async function _s(t,e){const n=await e;return null!=n&&"0x0000000000000000000000000000000000000000"!==n||(ma("string"!=typeof t,"unconfigured name","UNCONFIGURED_NAME",{value:t}),La(!1,"invalid AddressLike value; did not resolve to a value address","target",t)),Ko(n)}function ps(t,e){return"string"==typeof t?t.match(/^0x[0-9a-f]{40}$/i)?Ko(t):(ma(null!=e,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),_s(t,e.resolveName(t))):hs(t)?_s(t,t.getAddress()):t&&"function"==typeof t.then?_s(t,t):void La(!1,"unsupported addressable value","target",t)}function ms(t,e){return{address:Ko(t),storageKeys:e.map(((t,e)=>(La(to(t,32),"invalid slot",`storageKeys[${e}]`,t),t.toLowerCase())))}}const Ls=BigInt(0);function ys(t){return null==t?null:t.toString()}Symbol.iterator;class As{provider;transactionHash;blockHash;blockNumber;removed;address;data;topics;index;transactionIndex;constructor(t,e){this.provider=e;const n=Object.freeze(t.topics.slice());ga(this,{transactionHash:t.transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,removed:t.removed,address:t.address,data:t.data,topics:n,index:t.index,transactionIndex:t.transactionIndex})}toJSON(){const{address:t,blockHash:e,blockNumber:n,data:i,index:a,removed:o,topics:r,transactionHash:s,transactionIndex:c}=this;return{_type:"log",address:t,blockHash:e,blockNumber:n,data:i,index:a,removed:o,topics:r,transactionHash:s,transactionIndex:c}}async getBlock(){const t=await this.provider.getBlock(this.blockHash);return ma(!!t,"failed to find transaction","UNKNOWN_ERROR",{}),t}async getTransaction(){const t=await this.provider.getTransaction(this.transactionHash);return ma(!!t,"failed to find transaction","UNKNOWN_ERROR",{}),t}async getTransactionReceipt(){const t=await this.provider.getTransactionReceipt(this.transactionHash);return ma(!!t,"failed to find transaction receipt","UNKNOWN_ERROR",{}),t}removedEvent(){return{orphan:"drop-log",log:{transactionHash:(t=this).transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,address:t.address,data:t.data,topics:Object.freeze(t.topics.slice()),index:t.index}};var t}}class bs{provider;to;from;contractAddress;hash;index;blockHash;blockNumber;logsBloom;gasUsed;blobGasUsed;cumulativeGasUsed;gasPrice;blobGasPrice;type;status;root;#b;constructor(t,e){this.#b=Object.freeze(t.logs.map((t=>new As(t,e))));let n=Ls;null!=t.effectiveGasPrice?n=t.effectiveGasPrice:null!=t.gasPrice&&(n=t.gasPrice),ga(this,{provider:e,to:t.to,from:t.from,contractAddress:t.contractAddress,hash:t.hash,index:t.index,blockHash:t.blockHash,blockNumber:t.blockNumber,logsBloom:t.logsBloom,gasUsed:t.gasUsed,cumulativeGasUsed:t.cumulativeGasUsed,blobGasUsed:t.blobGasUsed,gasPrice:n,blobGasPrice:t.blobGasPrice,type:t.type,status:t.status,root:t.root})}get logs(){return this.#b}toJSON(){const{to:t,from:e,contractAddress:n,hash:i,index:a,blockHash:o,blockNumber:r,logsBloom:s,logs:c,status:l,root:d}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:r,contractAddress:n,cumulativeGasUsed:ys(this.cumulativeGasUsed),from:e,gasPrice:ys(this.gasPrice),blobGasUsed:ys(this.blobGasUsed),blobGasPrice:ys(this.blobGasPrice),gasUsed:ys(this.gasUsed),hash:i,index:a,logs:c,logsBloom:s,root:d,status:l,to:t}}get length(){return this.logs.length}[Symbol.iterator](){let t=0;return{next:()=>t<this.length?{value:this.logs[t++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const t=await this.provider.getBlock(this.blockHash);if(null==t)throw new Error("TODO");return t}async getTransaction(){const t=await this.provider.getTransaction(this.hash);if(null==t)throw new Error("TODO");return t}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return Cs(this)}reorderedEvent(t){return ma(!t||t.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),ws(this,t)}}class Is{provider;blockNumber;blockHash;index;hash;type;to;from;nonce;gasLimit;gasPrice;maxPriorityFeePerGas;maxFeePerGas;maxFeePerBlobGas;data;value;chainId;signature;accessList;blobVersionedHashes;#I;constructor(t,e){this.provider=e,this.blockNumber=null!=t.blockNumber?t.blockNumber:null,this.blockHash=null!=t.blockHash?t.blockHash:null,this.hash=t.hash,this.index=t.index,this.type=t.type,this.from=t.from,this.to=t.to||null,this.gasLimit=t.gasLimit,this.nonce=t.nonce,this.data=t.data,this.value=t.value,this.gasPrice=t.gasPrice,this.maxPriorityFeePerGas=null!=t.maxPriorityFeePerGas?t.maxPriorityFeePerGas:null,this.maxFeePerGas=null!=t.maxFeePerGas?t.maxFeePerGas:null,this.maxFeePerBlobGas=null!=t.maxFeePerBlobGas?t.maxFeePerBlobGas:null,this.chainId=t.chainId,this.signature=t.signature,this.accessList=null!=t.accessList?t.accessList:null,this.blobVersionedHashes=null!=t.blobVersionedHashes?t.blobVersionedHashes:null,this.#I=-1}toJSON(){const{blockNumber:t,blockHash:e,index:n,hash:i,type:a,to:o,from:r,nonce:s,data:c,signature:l,accessList:d,blobVersionedHashes:u}=this;return{_type:"TransactionResponse",accessList:d,blockNumber:t,blockHash:e,blobVersionedHashes:u,chainId:ys(this.chainId),data:c,from:r,gasLimit:ys(this.gasLimit),gasPrice:ys(this.gasPrice),hash:i,maxFeePerGas:ys(this.maxFeePerGas),maxPriorityFeePerGas:ys(this.maxPriorityFeePerGas),maxFeePerBlobGas:ys(this.maxFeePerBlobGas),nonce:s,signature:l,to:o,index:n,type:a,value:ys(this.value)}}async getBlock(){let t=this.blockNumber;if(null==t){const e=await this.getTransaction();e&&(t=e.blockNumber)}if(null==t)return null;const e=this.provider.getBlock(t);if(null==e)throw new Error("TODO");return e}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(null==this.blockNumber){const{tx:t,blockNumber:e}=await ua({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return null==t||null==t.blockNumber?0:e-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(t,e){const n=null==t?1:t,i=null==e?0:e;let a=this.#I,o=-1,r=-1===a;const s=async()=>{if(r)return null;const{blockNumber:t,nonce:e}=await ua({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(e<this.nonce)return void(a=t);if(r)return null;const i=await this.getTransaction();if(!i||null==i.blockNumber)for(-1===o&&(o=a-3,o<this.#I&&(o=this.#I));o<=t;){if(r)return null;const e=await this.provider.getBlock(o,!0);if(null==e)return;for(const t of e)if(t===this.hash)return;for(let i=0;i<e.length;i++){const o=await e.getTransaction(i);if(o.from===this.from&&o.nonce===this.nonce){if(r)return null;const e=await this.provider.getTransactionReceipt(o.hash);if(null==e)return;if(t-e.blockNumber+1<n)return;let i="replaced";o.data===this.data&&o.to===this.to&&o.value===this.value?i="repriced":"0x"===o.data&&o.from===o.to&&o.value===Ls&&(i="cancelled"),ma(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:"replaced"===i||"cancelled"===i,reason:i,replacement:o.replaceableTransaction(a),hash:o.hash,receipt:e})}}o++}},c=t=>{if(null==t||0!==t.status)return t;ma(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:t.to,from:t.from,data:""},receipt:t})},l=await this.provider.getTransactionReceipt(this.hash);if(0===n)return c(l);if(l){if(await l.confirmations()>=n)return c(l)}else if(await s(),0===n)return null;const d=new Promise(((t,e)=>{const o=[],l=()=>{o.forEach((t=>t()))};if(o.push((()=>{r=!0})),i>0){const t=setTimeout((()=>{l(),e(pa("wait for transaction timeout","TIMEOUT"))}),i);o.push((()=>{clearTimeout(t)}))}const d=async i=>{if(await i.confirmations()>=n){l();try{t(c(i))}catch(t){e(t)}}};if(o.push((()=>{this.provider.off(this.hash,d)})),this.provider.on(this.hash,d),a>=0){const t=async()=>{try{await s()}catch(t){if(ha(t,"TRANSACTION_REPLACED"))return l(),void e(t)}r||this.provider.once("block",t)};o.push((()=>{this.provider.off("block",t)})),this.provider.once("block",t)}}));return await d}isMined(){return null!=this.blockHash}isLegacy(){return 0===this.type}isBerlin(){return 1===this.type}isLondon(){return 2===this.type}isCancun(){return 3===this.type}removedEvent(){return ma(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Cs(this)}reorderedEvent(t){return ma(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),ma(!t||t.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),ws(this,t)}replaceableTransaction(t){La(Number.isInteger(t)&&t>=0,"invalid startBlock","startBlock",t);const e=new Is(this,this.provider);return e.#I=t,e}}function ws(t,e){return{orphan:"reorder-transaction",tx:t,other:e}}function Cs(t){return{orphan:"drop-transaction",tx:t}}class xs{filter;emitter;#w;constructor(t,e,n){this.#w=e,ga(this,{emitter:t,filter:n})}async removeListener(){null!=this.#w&&await this.emitter.off(this.filter,this.#w)}}class Es extends As{interface;fragment;args;constructor(t,e,n){super(t,t.provider),ga(this,{args:e.decodeEventLog(n,t.data,t.topics),fragment:n,interface:e})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class Bs extends As{error;constructor(t,e){super(t,t.provider),ga(this,{error:e})}}class Fs extends bs{#C;constructor(t,e,n){super(n,e),this.#C=t}get logs(){return super.logs.map((t=>{const e=t.topics.length?this.#C.getEvent(t.topics[0]):null;if(e)try{return new Es(t,this.#C,e)}catch(e){return new Bs(t,e)}return t}))}}class vs extends Is{#C;constructor(t,e,n){super(n,e),this.#C=t}async wait(t,e){const n=await super.wait(t,e);return null==n?null:new Fs(this.#C,this.provider,n)}}class Ps extends xs{log;constructor(t,e,n,i){super(t,e,n),ga(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class Os extends Ps{constructor(t,e,n,i,a){super(t,e,n,new Es(a,t.interface,i)),ga(this,{args:t.interface.decodeEventLog(i,this.log.data,this.log.topics),fragment:i})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const Ss=BigInt(0);function Us(t){return t&&"function"==typeof t.call}function Qs(t){return t&&"function"==typeof t.estimateGas}function ks(t){return t&&"function"==typeof t.resolveName}function Ts(t){return t&&"function"==typeof t.sendTransaction}function Ns(t){if(null!=t){if(ks(t))return t;if(t.provider)return t.provider}}class qs{#x;fragment;constructor(t,e,n){if(ga(this,{fragment:e}),e.inputs.length<n.length)throw new Error("too many arguments");const i=Ms(t.runner,"resolveName"),a=ks(i)?i:null;this.#x=async function(){const i=await Promise.all(e.inputs.map(((t,e)=>null==n[e]?null:t.walkAsync(n[e],((t,e)=>"address"===t?Array.isArray(e)?Promise.all(e.map((t=>ps(t,a)))):ps(e,a):e)))));return t.interface.encodeFilterTopics(e,i)}()}getTopicFilter(){return this.#x}}function Ms(t,e){return null==t?null:"function"==typeof t[e]?t:t.provider&&"function"==typeof t.provider[e]?t.provider:null}function Ds(t){return null==t?null:t.provider||null}async function Rs(t,e){const n=Ea.dereference(t,"overrides");La("object"==typeof n,"invalid overrides parameter","overrides",t);const i=function(t){const e={};t.to&&(e.to=t.to),t.from&&(e.from=t.from),t.data&&(e.data=no(t.data));const n="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const i of n)i in t&&null!=t[i]&&(e[i]=Ao(t[i],`request.${i}`));const i="type,nonce".split(/,/);for(const n of i)n in t&&null!=t[n]&&(e[n]=Co(t[n],`request.${n}`));return t.accessList&&(e.accessList=function(t){if(Array.isArray(t))return t.map(((e,n)=>Array.isArray(e)?(La(2===e.length,"invalid slot set",`value[${n}]`,e),ms(e[0],e[1])):(La(null!=e&&"object"==typeof e,"invalid address-slot set","value",t),ms(e.address,e.storageKeys))));La(null!=t&&"object"==typeof t,"invalid access list","value",t);const e=Object.keys(t).map((e=>{const n=t[e].reduce(((t,e)=>(t[e]=!0,t)),{});return ms(e,Object.keys(n).sort())}));return e.sort(((t,e)=>t.address.localeCompare(e.address))),e}(t.accessList)),"blockTag"in t&&(e.blockTag=t.blockTag),"enableCcipRead"in t&&(e.enableCcipRead=!!t.enableCcipRead),"customData"in t&&(e.customData=t.customData),"blobVersionedHashes"in t&&t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.slice()),"kzg"in t&&(e.kzg=t.kzg),"blobs"in t&&t.blobs&&(e.blobs=t.blobs.map((t=>{return to(e=t,!0)||e instanceof Uint8Array?no(t):Object.assign({},t);var e}))),e}(n);return La(null==i.to||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",i.to),La(null==i.data||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",i.data),i.from&&(i.from=i.from),i}function zs(t){const e=async function(e){const n=await Rs(e,["data"]);n.to=await t.getAddress(),n.from&&(n.from=await ps(n.from,Ns(t.runner)));const i=t.interface,a=Ao(n.value||Ss,"overrides.value")===Ss,o="0x"===(n.data||"0x");return!i.fallback||i.fallback.payable||!i.receive||o||a||La(!1,"cannot send data to receive or send value to non-payable fallback","overrides",e),La(i.fallback||o,"cannot send data to receive-only contract","overrides.data",n.data),La(i.receive||i.fallback&&i.fallback.payable||a,"cannot send value to non-payable fallback","overrides.value",n.value),La(i.fallback||o,"cannot send data to receive-only contract","overrides.data",n.data),n},n=async function(n){const i=t.runner;ma(Ts(i),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const a=await i.sendTransaction(await e(n)),o=Ds(t.runner);return new vs(t.interface,o,a)},i=async t=>await n(t);return ga(i,{_contract:t,estimateGas:async function(n){const i=Ms(t.runner,"estimateGas");return ma(Qs(i),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await i.estimateGas(await e(n))},populateTransaction:e,send:n,staticCall:async function(n){const i=Ms(t.runner,"call");ma(Us(i),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const a=await e(n);try{return await i.call(a)}catch(e){if(_a(e)&&e.data)throw t.interface.makeError(e.data,a);throw e}}}),i}const Gs=Symbol.for("_ethersInternal_contract"),js=new WeakMap;function Vs(t){return js.get(t[Gs])}async function Ks(t,e){let n,i=null;if(Array.isArray(e)){const i=function(e){if(to(e,32))return e;const n=t.interface.getEvent(e);return La(n,"unknown fragment","name",e),n.topicHash};n=e.map((t=>null==t?null:Array.isArray(t)?t.map(i):i(t)))}else"*"===e?n=[null]:"string"==typeof e?to(e,32)?n=[e]:(i=t.interface.getEvent(e),La(i,"unknown fragment","event",e),n=[i.topicHash]):(a=e)&&"object"==typeof a&&"getTopicFilter"in a&&"function"==typeof a.getTopicFilter&&a.fragment?n=await e.getTopicFilter():"fragment"in e?(i=e.fragment,n=[i.topicHash]):La(!1,"unknown event name","event",e);var a;return n=n.map((t=>{if(null==t)return null;if(Array.isArray(t)){const e=Array.from(new Set(t.map((t=>t.toLowerCase()))).values());return 1===e.length?e[0]:(e.sort(),e)}return t.toLowerCase()})),{fragment:i,tag:n.map((t=>null==t?"null":Array.isArray(t)?t.join("|"):t)).join("&"),topics:n}}async function Hs(t,e){const{subs:n}=Vs(t);return n.get((await Ks(t,e)).tag)||null}async function $s(t,e,n){const i=Ds(t.runner);ma(i,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:a,tag:o,topics:r}=await Ks(t,n),{addr:s,subs:c}=Vs(t);let l=c.get(o);if(!l){const e={address:s||t,topics:r},d=e=>{let i=a;if(null==i)try{i=t.interface.getEvent(e.topics[0])}catch(t){}if(i){const o=i,r=a?t.interface.decodeEventLog(a,e.data,e.topics):[];Js(t,n,r,(i=>new Os(t,i,n,o,e)))}else Js(t,n,[],(i=>new Ps(t,i,n,e)))};let u=[];l={tag:o,listeners:[],start:()=>{u.length||u.push(i.on(e,d))},stop:async()=>{if(0==u.length)return;let t=u;u=[],await Promise.all(t),i.off(e,d)}},c.set(o,l)}return l}let Ys=Promise.resolve();async function Js(t,e,n,i){try{await Ys}catch(t){}const a=async function(t,e,n,i){await Ys;const a=await Hs(t,e);if(!a)return!1;const o=a.listeners.length;return a.listeners=a.listeners.filter((({listener:e,once:a})=>{const o=Array.from(n);i&&o.push(i(a?null:e));try{e.call(t,...o)}catch(t){}return!a})),0===a.listeners.length&&(a.stop(),Vs(t).subs.delete(a.tag)),o>0}(t,e,n,i);return Ys=a,await a}const Ws=["then"];class Zs{target;interface;runner;filters;[Gs];fallback;constructor(t,e,n,i){La("string"==typeof t||hs(t),"invalid value for Contract target","target",t),null==n&&(n=null);const a=fs.from(e);let o;ga(this,{target:t,runner:n,interface:a}),Object.defineProperty(this,Gs,{value:{}});let r=null,s=null;if(i){const t=Ds(n);s=new vs(this.interface,t,i)}let c=new Map;if("string"==typeof t)if(to(t))r=t,o=Promise.resolve(t);else{const e=Ms(n,"resolveName");if(!ks(e))throw pa("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=e.resolveName(t).then((e=>{if(null==e)throw pa("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:t});return Vs(this).addr=e,e}))}else o=t.getAddress().then((t=>{if(null==t)throw new Error("TODO");return Vs(this).addr=t,t}));var l;l={addrPromise:o,addr:r,deployTx:s,subs:c},js.set(this[Gs],l);const d=new Proxy({},{get:(t,e,n)=>{if("symbol"==typeof e||Ws.indexOf(e)>=0)return Reflect.get(t,e,n);try{return this.getEvent(e)}catch(t){if(!ha(t,"INVALID_ARGUMENT")||"key"!==t.argument)throw t}},has:(t,e)=>Ws.indexOf(e)>=0?Reflect.has(t,e):Reflect.has(t,e)||this.interface.hasEvent(String(e))});return ga(this,{filters:d}),ga(this,{fallback:a.receive||a.fallback?zs(this):null}),new Proxy(this,{get:(t,e,n)=>{if("symbol"==typeof e||e in t||Ws.indexOf(e)>=0)return Reflect.get(t,e,n);try{return t.getFunction(e)}catch(t){if(!ha(t,"INVALID_ARGUMENT")||"key"!==t.argument)throw t}},has:(t,e)=>"symbol"==typeof e||e in t||Ws.indexOf(e)>=0?Reflect.has(t,e):t.interface.hasFunction(e)})}connect(t){return new Zs(this.target,this.interface,t)}attach(t){return new Zs(t,this.interface,this.runner)}async getAddress(){return await Vs(this).addrPromise}async getDeployedCode(){const t=Ds(this.runner);ma(t,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const e=await t.getCode(await this.getAddress());return"0x"===e?null:e}async waitForDeployment(){const t=this.deploymentTransaction();if(t)return await t.wait(),this;if(null!=await this.getDeployedCode())return this;const e=Ds(this.runner);return ma(null!=e,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise(((t,n)=>{const i=async()=>{try{if(null!=await this.getDeployedCode())return t(this);e.once("block",i)}catch(t){n(t)}};i()}))}deploymentTransaction(){return Vs(this).deployTx}getFunction(t){return"string"!=typeof t&&(t=t.format()),function(t,e){const n=function(...n){const i=t.interface.getFunction(e,n);return ma(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:n}}),i},i=async function(...e){const i=n(...e);let a={};if(i.inputs.length+1===e.length&&(a=await Rs(e.pop()),a.from&&(a.from=await ps(a.from,Ns(t.runner)))),i.inputs.length!==e.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const o=await async function(t,e,n){const i=Ms(t,"resolveName"),a=ks(i)?i:null;return await Promise.all(e.map(((t,e)=>t.walkAsync(n[e],((t,e)=>(e=Ea.dereference(e,t),"address"===t?ps(e,a):e))))))}(t.runner,i.inputs,e);return Object.assign({},a,await ua({to:t.getAddress(),data:t.interface.encodeFunctionData(i,o)}))},a=async function(...t){const e=await r(...t);return 1===e.length?e[0]:e},o=async function(...e){const n=t.runner;ma(Ts(n),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const a=await n.sendTransaction(await i(...e)),o=Ds(t.runner);return new vs(t.interface,o,a)},r=async function(...e){const a=Ms(t.runner,"call");ma(Us(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const o=await i(...e);let r="0x";try{r=await a.call(o)}catch(e){if(_a(e)&&e.data)throw t.interface.makeError(e.data,o);throw e}const s=n(...e);return t.interface.decodeFunctionResult(s,r)},s=async(...t)=>n(...t).constant?await a(...t):await o(...t);return ga(s,{name:t.interface.getFunctionName(e),_contract:t,_key:e,getFragment:n,estimateGas:async function(...e){const n=Ms(t.runner,"estimateGas");return ma(Qs(n),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await n.estimateGas(await i(...e))},populateTransaction:i,send:o,staticCall:a,staticCallResult:r}),Object.defineProperty(s,"fragment",{configurable:!1,enumerable:!0,get:()=>{const n=t.interface.getFunction(e);return ma(n,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),n}}),s}(this,t)}getEvent(t){return"string"!=typeof t&&(t=t.format()),function(t,e){const n=function(...n){const i=t.interface.getEvent(e,n);return ma(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:n}}),i},i=function(...e){return new qs(t,n(...e),e)};return ga(i,{name:t.interface.getEventName(e),_contract:t,_key:e,getFragment:n}),Object.defineProperty(i,"fragment",{configurable:!1,enumerable:!0,get:()=>{const n=t.interface.getEvent(e);return ma(n,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),n}}),i}(this,t)}async queryTransaction(t){throw new Error("@TODO")}async queryFilter(t,e,n){null==e&&(e=0),null==n&&(n="latest");const{addr:i,addrPromise:a}=Vs(this),o=i||await a,{fragment:r,topics:s}=await Ks(this,t),c={address:o,topics:s,fromBlock:e,toBlock:n},l=Ds(this.runner);return ma(l,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await l.getLogs(c)).map((t=>{let e=r;if(null==e)try{e=this.interface.getEvent(t.topics[0])}catch(t){}if(e)try{return new Es(t,this.interface,e)}catch(e){return new Bs(t,e)}return new As(t,l)}))}async on(t,e){const n=await $s(this,"on",t);return n.listeners.push({listener:e,once:!1}),n.start(),this}async once(t,e){const n=await $s(this,"once",t);return n.listeners.push({listener:e,once:!0}),n.start(),this}async emit(t,...e){return await Js(this,t,e,null)}async listenerCount(t){if(t){const e=await Hs(this,t);return e?e.listeners.length:0}const{subs:e}=Vs(this);let n=0;for(const{listeners:t}of e.values())n+=t.length;return n}async listeners(t){if(t){const e=await Hs(this,t);return e?e.listeners.map((({listener:t})=>t)):[]}const{subs:e}=Vs(this);let n=[];for(const{listeners:t}of e.values())n=n.concat(t.map((({listener:t})=>t)));return n}async off(t,e){const n=await Hs(this,t);if(!n)return this;if(e){const t=n.listeners.map((({listener:t})=>t)).indexOf(e);t>=0&&n.listeners.splice(t,1)}return null!=e&&0!==n.listeners.length||(n.stop(),Vs(this).subs.delete(n.tag)),this}async removeAllListeners(t){if(t){const e=await Hs(this,t);if(!e)return this;e.stop(),Vs(this).subs.delete(e.tag)}else{const{subs:t}=Vs(this);for(const{tag:e,stop:n}of t.values())n(),t.delete(e)}return this}async addListener(t,e){return await this.on(t,e)}async removeListener(t,e){return await this.off(t,e)}static buildClass(t){return class extends Zs{constructor(e,n=null){super(e,t,n)}}}static from(t,e,n){return null==n&&(n=null),new this(t,e,n)}}class Xs extends(function(){return Zs}()){}var tc=n(78),ec=n.n(tc);function nc(t){return nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nc(t)}function ic(){ic=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var o=e&&e.prototype instanceof m?e:m,r=Object.create(o.prototype),s=new P(i||[]);return a(r,"_invoke",{value:E(t,n,s)}),r}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var g="suspendedStart",f="suspendedYield",h="executing",_="completed",p={};function m(){}function L(){}function y(){}var A={};l(A,r,(function(){return this}));var b=Object.getPrototypeOf,I=b&&b(b(O([])));I&&I!==n&&i.call(I,r)&&(A=I);var w=y.prototype=m.prototype=Object.create(A);function C(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(a,o,r,s){var c=u(t[a],t,o);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==nc(d)&&i.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,r,s)}),(function(t){n("throw",t,r,s)})):e.resolve(d).then((function(t){l.value=t,r(l)}),(function(t){return n("throw",t,r,s)}))}s(c.arg)}var o;a(this,"_invoke",{value:function(t,i){function a(){return new e((function(e,a){n(t,i,e,a)}))}return o=o?o.then(a,a):a()}})}function E(e,n,i){var a=g;return function(o,r){if(a===h)throw Error("Generator is already running");if(a===_){if("throw"===o)throw r;return{value:t,done:!0}}for(i.method=o,i.arg=r;;){var s=i.delegate;if(s){var c=B(s,i);if(c){if(c===p)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(a===g)throw a=_,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);a=h;var l=u(e,n,i);if("normal"===l.type){if(a=i.done?_:f,l.arg===p)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(a=_,i.method="throw",i.arg=l.arg)}}}function B(e,n){var i=n.method,a=e.iterator[i];if(a===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,B(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),p;var o=u(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,p;var r=o.arg;return r?r.done?(n[e.resultName]=r.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function F(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function v(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(F,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[r];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(i.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(nc(e)+" is not iterable")}return L.prototype=y,a(w,"constructor",{value:y,configurable:!0}),a(y,"constructor",{value:L,configurable:!0}),L.displayName=l(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===L||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},C(x.prototype),l(x.prototype,s,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,i,a,o){void 0===o&&(o=Promise);var r=new x(d(t,n,i,a),o);return e.isGeneratorFunction(n)?r:r.next().then((function(t){return t.done?t.value:r.next()}))},C(w),l(w,c,"Generator"),l(w,r,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=O,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(v),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(i,a){return s.type="throw",s.arg=e,n.next=i,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o],s=r.completion;if("root"===r.tryLoc)return a("end");if(r.tryLoc<=this.prev){var c=i.call(r,"catchLoc"),l=i.call(r,"finallyLoc");if(c&&l){if(this.prev<r.catchLoc)return a(r.catchLoc,!0);if(this.prev<r.finallyLoc)return a(r.finallyLoc)}else if(c){if(this.prev<r.catchLoc)return a(r.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return a(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&i.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var r=o?o.completion:{};return r.type=t,r.arg=e,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),v(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var a=i.arg;v(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:O(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),p}},e}function ac(t,e,n,i,a,o,r){try{var s=t[o](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,a)}function oc(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var o=t.apply(e,n);function r(t){ac(o,i,a,r,s,"next",t)}function s(t){ac(o,i,a,r,s,"throw",t)}r(void 0)}))}}function rc(t){return sc.apply(this,arguments)}function sc(){return(sc=oc(ic().mark((function t(e){var n,i,a,o;return ic().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={signedMessageHash:e},t.next=5,Ki.fullProve(n,"../../../registration_js/zk-circuits/registration.wasm","../../../zk-circuits/registration_final.zkey");case 5:return i=t.sent,a=i.proof,o=i.publicSignals,t.abrupt("return",{proof:a,publicSignals:o});case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function cc(){return(cc=oc(ic().mark((function e(){var n,i,a,o,r,s,c,l,d,u,g,f,h,_;return ic().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.getElementById("universityId").value,i=document.getElementById("electionId").value,a=new t.providers.Web3Provider(window.ethereum),e.next=5,a.send("eth_requestAccounts",[]);case 5:return o=a.getSigner(),e.next=8,o.getAddress();case 8:return r=e.sent,s=Date.now(),c="I am registering to vote at ".concat(s),e.next=13,o.signMessage(c);case 13:return l=e.sent,d=t.utils.keccak256(l),e.next=17,rc(d);case 17:return u=e.sent,g=u.proof,f=u.publicSignals,console.log("Registration Proof:",g),console.log("Public signals (nullifier hash):",f[0]),h=[g.pi_a[0],g.pi_a[1],g.pi_b[0][0],g.pi_b[0][1],g.pi_b[1][0],g.pi_b[1][1],g.pi_c[0],g.pi_c[1]],_=new Xs("0x34690B1B9a3bfb38c785c36Fd08936878273343e",ec(),o),e.next=27,_.registerVoter(n,i,r,f[0],h);case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}document.getElementById("registerButton").addEventListener("click",(function(){return cc.apply(this,arguments)}))})()})();